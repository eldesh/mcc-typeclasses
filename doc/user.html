<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<meta name="GENERATOR" content="TtH 3.38">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>


<title> Münster Curry User's Guide</title>
 
<h1 align="center">Münster Curry <br />User's Guide <br /><font size="+0">Release 0.9.11</font> </h1>

<h3 align="center">Wolfgang Lux </h3>

<div class="p"><!----></div>

<div class="p"><!----></div>
   
<h1>Contents </h1><a href="#tth_sEc1"
>1&nbsp; Overview</a><br />
<a href="#tth_sEc2"
>2&nbsp; Installation</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc2.1"
>2.1&nbsp; Binary Distribution</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc2.2"
>2.2&nbsp; Source Distribution</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc2.2.1"
>2.2.1&nbsp; Porting to a New Architecture</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc2.2.2"
>2.2.2&nbsp; Building the Documentation</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc2.2.3"
>2.2.3&nbsp; Building universal libraries and programs on Mac OS X</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc2.3"
>2.3&nbsp; Installation on Microsoft Windows</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc2.3.1"
>2.3.1&nbsp; CygWin</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc2.3.2"
>2.3.2&nbsp; MinGW</a><br />
<a href="#tth_sEc3"
>3&nbsp; Using the Compiler</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.1"
>3.1&nbsp; Overall Options</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.2"
>3.2&nbsp; Compiling Curry Modules</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.3"
>3.3&nbsp; Compiling C Files</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.4"
>3.4&nbsp; Linking</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.5"
>3.5&nbsp; Environment</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.6"
>3.6&nbsp; Examples</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc3.7"
>3.7&nbsp; Running Programs</a><br />

<a href="#tth_sEc4"
>4&nbsp; Using the Debugger</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc4.1"
>4.1&nbsp; Trusted functions</a><br />
<a href="#tth_sEc5"
>5&nbsp; Building programs with <tt>cymake</tt></a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc5.1"
>5.1&nbsp; Options</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc5.2"
>5.2&nbsp; Environment</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc5.3"
>5.3&nbsp; Modules and the Filesystem</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc5.4"
>5.4&nbsp; Using Libraries</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc5.5"
>5.5&nbsp; Using <tt>make</tt></a><br />
<a href="#tth_sEc6"
>6&nbsp; Using the Interactive Environment</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc6.1"
>6.1&nbsp; Goals</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc6.2"
>6.2&nbsp; Commands</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc6.3"
>6.3&nbsp; Limitations</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc6.4"
>6.4&nbsp; Example Session</a><br />
<a href="#tth_sEc7"
>7&nbsp; Libraries</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.1"
>7.1&nbsp; Prelude</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2"
>7.2&nbsp; Haskell 98 Library</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.1"
>7.2.1&nbsp; Ratio</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.2"
>7.2.2&nbsp; Complex</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.3"
>7.2.3&nbsp; Numeric</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.4"
>7.2.4&nbsp; Ix</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.5"
>7.2.5&nbsp; Array</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.6"
>7.2.6&nbsp; List</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.7"
>7.2.7&nbsp; Maybe</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.8"
>7.2.8&nbsp; Char</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.9"
>7.2.9&nbsp; Monad</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.10"
>7.2.10&nbsp; IO</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.11"
>7.2.11&nbsp; Directory</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.12"
>7.2.12&nbsp; System</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.13"
>7.2.13&nbsp; Time</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.14"
>7.2.14&nbsp; Locale</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.15"
>7.2.15&nbsp; CPUTime</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.2.16"
>7.2.16&nbsp; Random</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3"
>7.3&nbsp; Foreign Function Interface</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.1"
>7.3.1&nbsp; Foreign</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.2"
>7.3.2&nbsp; Bits</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.3"
>7.3.3&nbsp; Int</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.4"
>7.3.4&nbsp; Word</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.5"
>7.3.5&nbsp; Ptr</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.6"
>7.3.6&nbsp; ForeignPtr</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.7"
>7.3.7&nbsp; StablePtr</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.8"
>7.3.8&nbsp; Storable</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.9"
>7.3.9&nbsp; MarshalAlloc</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.10"
>7.3.10&nbsp; MarshalArray</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.11"
>7.3.11&nbsp; MarshalError</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.12"
>7.3.12&nbsp; MarshalUtils</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.13"
>7.3.13&nbsp; CForeign</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.14"
>7.3.14&nbsp; CTypes</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.15"
>7.3.15&nbsp; CString</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.3.16"
>7.3.16&nbsp; CError</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.4"
>7.4&nbsp; Library Modules Compatible with PAKCS</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.4.1"
>7.4.1&nbsp; AllSolutions</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.4.2"
>7.4.2&nbsp; Combinatorial</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.4.3"
>7.4.3&nbsp; Float</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.4.4"
>7.4.4&nbsp; Integer</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.4.5"
>7.4.5&nbsp; Parser</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.4.6"
>7.4.6&nbsp; Ports</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.4.7"
>7.4.7&nbsp; Read</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.4.8"
>7.4.8&nbsp; Socket</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.4.9"
>7.4.9&nbsp; Unsafe</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.5"
>7.5&nbsp; Library Modules Specific to the M&#252;nster Curry Compiler</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.5.1"
>7.5.1&nbsp; FiniteMap</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.5.2"
>7.5.2&nbsp; IOExts</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.5.3"
>7.5.3&nbsp; IOVector</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.5.4"
>7.5.4&nbsp; Lexing</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.5.5"
>7.5.5&nbsp; NameSupply</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.5.6"
>7.5.6&nbsp; Set</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.5.7"
>7.5.7&nbsp; Success</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc7.5.8"
>7.5.8&nbsp; Trace</a><br />
<a href="#tth_sEc8"
>8&nbsp; Extensions and Limitations</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1"
>8.1&nbsp; Extensions</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.1"
>8.1.1&nbsp; Polymorphic Integer Literals and Negation</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.2"
>8.1.2&nbsp; Disequality Constraints</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.3"
>8.1.3&nbsp; Existentially Quantified Types</a><br />


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.4"
>8.1.4&nbsp; Partial Applications in Equality and Disequality Constraints</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.5"
>8.1.5&nbsp; Fixity Declarations</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.6"
>8.1.6&nbsp; Lazy Patterns</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.7"
>8.1.7&nbsp; Type Renamings</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.8"
>8.1.8&nbsp; Expression Type Signatures</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.9"
>8.1.9&nbsp; Constraint Guards in Case Expressions</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.10"
>8.1.10&nbsp; Constructor Operators</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.11"
>8.1.11&nbsp; No Automatic Eta-expansion of Function Definitions</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.12"
>8.1.12&nbsp; Generalized Function Left-Hand Sides</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.13"
>8.1.13&nbsp; Polymorphic Generalization of Let-Bound Variables</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.14"
>8.1.14&nbsp; Mutually Recursive Variable Bindings</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.15"
>8.1.15&nbsp; Extended Import/Export Specifications</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.1.16"
>8.1.16&nbsp; Foreign Function Interface</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.2"
>8.2&nbsp; Limitiations and Incompatibilities</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tth_sEc8.3"
>8.3&nbsp; Known Bugs</a><br />
<a href="#tth_sEc9"
>9&nbsp; Common Problems and Solutions</a><br />
<a href="#tth_sEc10"
>10&nbsp; Release History</a><br />



























<div class="p"><!----></div>
 <h2><a name="tth_sEc1">
1</a>&nbsp;&nbsp;Overview</h2>
The Münster Curry compiler is a mature native code compiler for the declarative multi-paradigm language <a href="http://www.informatik.uni-kiel.de/~mh/curry/">Curry</a>&nbsp;[<a href="#Hanus06:Report" name="CITEHanus06:Report">Han06</a>]. The language supported by the compiler is compatible with version 0.8.2 of the Curry report except for some minor differences with respect to the module system. Many syntax extensions including <tt>newtype</tt> declarations, infix data constructors, lazy patterns, and recursive pattern bindings are available for compatibility with Haskell&nbsp;[<a href="#PeytonJones03:Haskell98" name="CITEPeytonJones03:Haskell98">Pey03</a>].<a href="#tthFtNtAAB" name="tthFrefAAB"><sup>1</sup></a> Other supported extensions include existentially quantified data types, disequality constraints, and I/O exceptions. A distinctive feature of the Münster Curry compiler is the integration of a declarative debugger of wrong answers&nbsp;[<a href="#CL02:ENTCS76" name="CITECL02:ENTCS76">CL02</a>]. An interactive Curry environment and a make-like build tool for Curry programs are also part of the distribution. A graphical user interface is available separately for Mac OS X.

<div class="p"><!----></div>
The Münster Curry compiler is portable to many Unix operating systems with precompiled binaries being available for Linux (i386), Mac OS X, and eventually other Unix variants. It is possible to build and use the Münster Curry compiler on Windows systems using the CygWin environment. The only additional software needed for compiling and running Curry programs is the Gnu C compiler. Building and installing the Münster Curry compiler from its sources requires a Haskell 98 compiler, too. Building and installing the compiler from source and binary distributions can be achieved with the commands

<pre>
./configure
make install

</pre>
in most cases.

<div class="p"><!----></div>
Source and binary distributions as well as further information can be found at <br /><a href="http://danae.uni-muenster.de/~lux/curry"><tt>http://danae.uni-muenster.de/~lux/curry</tt></a>.

<div class="p"><!----></div>
 <h2><a name="tth_sEc2">
2</a>&nbsp;&nbsp;Installation</h2>

     <h3><a name="tth_sEc2.1">
2.1</a>&nbsp;&nbsp;Binary Distribution</h3><a name="sec:binary">
</a>
Precompiled binary distributions are available for Linux (i386), Mac OS X, and eventually other systems. After unpacking the archive, change into the directory corresponding to your platform and run the configure script in that directory. You can then use the scripts<a href="#tthFtNtAAC" name="tthFrefAAC"><sup>2</sup></a> <tt>cyc</tt>, <tt>cymake</tt>, and <tt>cyi</tt> from the <tt>bin</tt> directory (e.g., by setting up soft links from a directory which is included in <tt>$PATH</tt>) or install the compiler with <tt>make install</tt>. It is possible to uninstall the compiler with the command <tt>make uninstall</tt>. By default, the compiler binaries are installed in the directory <tt>/usr/local/bin</tt>, interface files, header files, and libraries in <tt>/usr/local/lib/curry-0.9.11</tt>, and manual pages in <tt>/usr/local/man/man1</tt>.

<div class="p"><!----></div>
The configure script is a standard Gnu configure script that understands the following options:

<dl compact="compact">
 <dt><b><tt>--prefix=</tt><em>prefix</em></b></dt>
	<dd> Use <em>prefix</em> instead of <tt>/usr/local</tt> as base directory for the installation. For instance, in order to install the compiler in the directories <tt>bin</tt> and <tt>lib/curry-0.9.11</tt> in your home directory, you can use the command <tt>configure --prefix=$HOME</tt>.</dd>
 <dt><b><tt>--bindir=</tt><em>bindir</em></b></dt>
	<dd> Install the compiler binaries in directory <em>bindir</em> instead of <tt>/usr/local/bin</tt>.</dd>
 <dt><b><tt>--libdir=</tt><em>libdir</em></b></dt>
	<dd> Install the library files in directory <em>libdir</em><tt>/curry-0.9.11</tt> instead of <tt>/usr/local/lib/curry-0.9.11</tt>.</dd>
 <dt><b><tt>--mandir=</tt><em>mandir</em></b></dt>
	<dd> Install the manual pages in directory <em>mandir</em><tt>/man1</tt> instead of <tt>/usr/local/man/man1</tt>.</dd>
</dl>

<div class="p"><!----></div>
     <h3><a name="tth_sEc2.2">
2.2</a>&nbsp;&nbsp;Source Distribution</h3><a name="sec:source">
</a>
The Münster Curry compiler is known to work under Linux (Intel i386, AMD x86-64, Power PC), NetBSD i386, FreeBSD, Solaris for Sparc, Mac OS X, and will probably run out of the box on most other Unix operating systems as well. 

<div class="p"><!----></div>
In order to rebuild the Münster Curry compiler from its sources, you need a Haskell 98 compiler and a modern make. It is recommended to use <tt>ghc</tt> for compiling Haskell sources, but <tt>hbc</tt> and <tt>nhc98</tt> are supported as well. The makefiles are known to work with Gnu make, BSD make, and Solaris' make command. They may work with other make commands, too.

<div class="p"><!----></div>
Compilation from the unpacked source directory is achieved with the commands

<pre>
./configure
make

</pre>
After successful compilation, you can use the scripts<a href="#tthFtNtAAD" name="tthFrefAAD"><sup>3</sup></a> <tt>cyc</tt>, <tt>cymake</tt>, and <tt>cyi</tt> from the build directory (e.g., by setting up soft links from a directory which is included in <tt>$PATH</tt>) or install the compiler with the command <tt>make install</tt>. An installed compiler can be uninstalled with the command <tt>make uninstall</tt>.

<div class="p"><!----></div>
The configure script automatically determines the required software. In particular, it will check for one of the supported Haskell compilers in the path, trying <tt>ghc</tt>, <tt>hbc</tt>, and <tt>nhc98</tt> in that order. It is also possible to select a particular compiler with the <tt>--with-hc</tt> option.

<div class="p"><!----></div>
The configure script understands the following options.

<dl compact="compact">
 <dt><b><tt>--prefix=</tt><em>prefix</em></b></dt>
	<dd> Use <em>prefix</em> instead of <tt>/usr/local</tt> as base directory for the installation. For instance, in order to install the compiler in the directories <tt>bin</tt> and <tt>lib/curry-0.9.11</tt> in your home directory, you can use the command <tt>configure --prefix=$HOME</tt>.</dd>
 <dt><b><tt>--bindir=</tt><em>bindir</em></b></dt>
	<dd> Install the compiler binaries in directory <em>bindir</em> instead of <tt>/usr/local/bin</tt>.</dd>
 <dt><b><tt>--libdir=</tt><em>libdir</em></b></dt>
	<dd> Install the library files in directory <em>libdir</em><tt>/curry-0.9.11</tt> instead of <tt>/usr/local/lib/curry-0.9.11</tt>.</dd>
 <dt><b><tt>--mandir=</tt><em>mandir</em></b></dt>
	<dd> Install the manual pages in directory <em>mandir</em><tt>/man1</tt> instead of <tt>/usr/local/man/man1</tt>.</dd>
 <dt><b><tt>--with-hc=</tt><em>hc</em></b></dt>
	<dd> Use the command <em>hc</em> for compiling Haskell sources. E.g., if you have <tt>ghc</tt> and <tt>hbc</tt> installed on your machine and prefer building the compiler with <tt>hbc</tt>, you can use <tt>configure --with-hc=hbc</tt>. <tt>configure</tt> will check that the compiler <em>hc</em> is a supported Haskell 98 compiler.</dd>
 <dt><b><tt>--disable-ghc-make</tt></b></dt>
	<dd> With this option, you can specify that ghc's <tt>--make</tt> option should not be used and Haskell source files are compiled individually. The advantage of this configuration is that it allows you to specify options for particular source files on the make command line. E.g., if you want to build a compiler for profiling and get profiling data for all top-level functions in file <tt>TypeCheck.lhs</tt>, you can use the command

<pre>
  make HCFLAGS='-prof -auto' TypeCheck_HCFLAGS=-auto-all

</pre>
This option has no effect when hbc or nhc98 are used.</dd>
 <dt><b><tt>--disable-stdlib</tt></b></dt>
	<dd> This option disables compilation of all library modules except for the prelude.</dd>
 <dt><b><tt>--disable-debug</tt></b></dt>
	<dd> This option disables compilation of the Curry libraries with debugging information. Note that the compiler still can be used for compiling modules with debugging information, but you will be unable to build programs from these modules due to missing definitions for the standard library. This option is useful in order to speed up compilation on a slow machine if you do not intend to use the debugger.</dd>
 <dt><b><tt>--disable-occurs-check</tt></b></dt>
	<dd> The semantics of Curry requires performing an occurs check in equality and disequality constraints in order to avoid constructing cyclic data terms. With this option, the occurs check can be disabled. This can improve performance on some examples, but may lead to worse performance and non-termination on others. Using this option is not recommended.</dd>
 <dt><b><tt>--enable-stability</tt></b></dt>
	<dd> This flag enables some experimental code that suspends threads performing a non-deterministic instantiation of variables while other deterministic computations can be run. This strategy is known as stability from AKL and Oz. For instance, given the definitions

<pre>
data Nat  = Z | S Nat
nat Z     = success
nat (S n) = nat n

</pre>
the expression <tt>let n free in nat n &amp; n =:= S Z</tt> is evaluated deterministically because the deterministic binding of <tt>n</tt> in the equality constraint will get precedence over the non-deterministic instantiation of <tt>n</tt> in <tt>nat</tt>.</dd>
 <dt><b><tt>--enable-copying</tt></b></dt>
	<dd> By default, the bindings of local variables in different solutions of a search goal are managed with an extended trailing scheme. This option enables an alternative implementation, where independent copies of the search goal are used for each branch of the goal's search tree. This allows for a slightly more efficient execution of deterministic code, but can slow down non-deterministic code considerably in some situations. See&nbsp;[<a href="#Lux04:Compare" name="CITELux04:Compare">Lux04</a>] for a comparison of both configurations.</dd>
 <dt><b><tt>--enable-trampoline</tt></b></dt>
	<dd> By default, the compiler uses some extensions of the Gnu C compiler in order to implement tail calls efficiently by inserting assembler jump instructions into the code. This trick works on many architectures, but is not fully portable. For instance, it does not work under Mac OS X and is also incompatible with building code for shared libraries on most systems.

<div class="p"><!----></div>
If the compiler is configured with <tt>--enable-trampoline</tt>, it uses a portable but slower implementation where a global loop (the so-called trampoline) is used for dispatching tail calls. If your Curry programs keep crashing with bus errors or segmentation faults try reconfiguring the compiler with this option. Note that <tt>--enable-trampoline</tt> is the default when using a C compiler other than Gnu C and also on Mac OS X.</dd>
 <dt><b><tt>--disable-pointer-tags</tt></b></dt>
	<dd> Normally, the runtime system encodes character values and integer values that fit into n<font face="symbol">-</font
>1 bits, where n is the number of bits in a machine word, in pointers rather than allocating a node in the heap for them. This improves efficiency mostly due to avoiding allocation, but makes pattern matching and character and integer operations slightly more complex. When the system is configured with <tt>--disable-pointer-tags</tt>, all characters and integer numbers are allocated in the heap. This option is useful only for measuring the performance gain of the default configuration and is not recommended otherwise.</dd>
 <dt><b><tt>--disable-mprotect</tt></b></dt>
	<dd> In order to detect errors in the two-space copying garbage collector early, the runtime system makes the inactive semi-space of the heap inaccessible using the <tt>mprotect</tt>(2) system call. This requires that <tt>mprotect</tt> is able to protect individual memory pages, which should be the case on most operating systems. The configure script checks only for the availability of the <tt>mprotect</tt> call, but does not check whether it actually works. On systems where <tt>mprotect</tt> exists, but is not able to protect individual pages, its use can be disabled by passing the <tt>--disable-mprotect</tt> option to <tt>configure</tt>.</dd>
 <dt><b><tt>--enable-cam2c</tt></b></dt>
	<dd> The source distribution includes a compiler from abstract machine code to C. This compiler is built by default only when the <tt>--enable-cam2c</tt> option is passed to <tt>configure</tt>. Note that this compiler is mainly intended for testing the C code generator of the Curry compiler and is not other integrated with the compiler.</dd>
 <dt><b><tt>--enable-mach</tt></b></dt>
	<dd> The source distribution also includes an interpreter for the abstract machine underlying the implementation of the Münster Curry compiler. This interpreter is built when the <tt>--enable-mach</tt> option is passed to <tt>configure</tt>. Note that the interpreter is poorly maintained and may be removed in a future release.</dd>
</dl>

<div class="p"><!----></div>
      <h4><a name="tth_sEc2.2.1">
2.2.1</a>&nbsp;&nbsp;Porting to a New Architecture</h4><a name="sec:source-porting">
</a>
The Münster Curry compiler was designed to be as portable as possible and should work on systems where an ANSI C compiler and a POSIX compatible environment are available. It has been tested on different 32-bit and 64-bit architectures, and should work on all 32-bit and 64-bit systems where the size of a C <tt>long</tt> is equal to that of a pointer.

<div class="p"><!----></div>
In order to generate efficient code, the Münster Curry compiler uses some Gnu C extensions which work on a lot of architectures, but are not strictly portable. In particular, the default code generation model is incompatible with position independent code on most architectures. On systems where position independent code is the default - e.g., Apple's Mac OS X and IBM's AIX - and eventually on other systems, the compiler may have to be configured with the <tt>--enable-trampoline</tt> option in order to produce working executables.<a href="#tthFtNtAAE" name="tthFrefAAE"><sup>4</sup></a>

<div class="p"><!----></div>
In order to test the compiler on an unsupported architecture, you can use the test suites in <a href="http://danae.uni-muenster.de/~lux/curry/examples.tar.gz"><tt>http://danae.uni-muenster.de/~lux/curry/examples.tar.gz</tt></a> and <a href="http://danae.uni-muenster.de/~lux/curry/more-examples.tar.gz"><tt>http://danae.uni-muenster.de/~lux/curry/more-examples.tar.gz</tt></a>. After unpacking the archives, execute <tt>make test CYC=</tt><em>path-to-cyc</em> for both of them. This should report <tt>All tests completed successfully</tt> at the end. In that case, you can ignore the error messages produced while running the tests. Otherwise, send a bug report to <a href="mailto:wlux@uni-muenster.de">wlux@uni-muenster.de</a>.

<div class="p"><!----></div>
      <h4><a name="tth_sEc2.2.2">
2.2.2</a>&nbsp;&nbsp;Building the Documentation</h4><a name="sec:source-documentation">
</a>
The internal documentation of the Münster Curry compiler, which describes the compiler and runtime system implementation, can be built from the build directory by invoking either <tt>make curry.dvi</tt> or <tt>make curry.pdf</tt> depending on the format you prefer. These targets require a working <span class="roman">L</span><sup><span class="roman">A</span></sup><span class="roman">T</span><sub><span class="roman">E</span></sub><span class="roman">X</span> installation (which must include <tt>pdflatex</tt> in order to build <tt>curry.pdf</tt>) and in addition <tt>noweb.sty</tt> from Norman Ramsey's noweb literate programming tool<a href="#tthFtNtAAF" name="tthFrefAAF"><sup>5</sup></a>.

<div class="p"><!----></div>
The source distribution includes pre-built <span class="roman">T</span><sub><span class="roman">E</span></sub><span class="roman">X</span> sources for the runtime system, which were created with noweb version 2.10c. These files may cause errors when used together with a <tt>noweb.sty</tt> from an earlier noweb release. In that case you have two options. Either upgrade noweb from a CTAN mirror or remove all <tt>.tex</tt> files except for <tt>runtime.tex</tt> from the runtime directory in the source tree. This is achieved best by changing into the runtime directory in your build(!) directory and invoking <tt>make maintainerclean</tt> there. Note that this will also remove the <tt>.h</tt> and <tt>.c</tt> files in the runtime directory and cause them to be rebuilt with your local noweb installation when the runtime system is built with <tt>make</tt> the next time.

<div class="p"><!----></div>
On Mac OS X, if you have <tt>TeXShop</tt><a href="#tthFtNtAAG" name="tthFrefAAG"><sup>6</sup></a> installed, you can use it in order to typeset the documentation by using <tt>make TeXShop</tt> instead of <tt>make curry.pdf</tt>. However, in contrast to the standard targets, the <tt>TeXShop</tt> target does not yet take care of invoking <tt>bibtex</tt> when necessary or typesetting the document once again if the cross references were updated.

<div class="p"><!----></div>
      <h4><a name="tth_sEc2.2.3">
2.2.3</a>&nbsp;&nbsp;Building universal libraries and programs on Mac OS X</h4><a name="sec:source-universal">
</a>
It is easily possible to build the Münster Curry compiler with universal libraries that can be used on both Intel and PowerPC based Macintosh computers by passing appropriate <tt>-arch</tt> options to the C compiler either during configuration or while building the compiler. For instance, the command

<pre>
  ./configure CFLAGS='-arch i386 -arch x86_64 -arch ppc -g -O2'

</pre>
will configure the Münster Curry compiler such that it can be used to link native executables on Intel based machines in 32-bit and 64-bit modes as well as on 32-bit PowerPC machines. It is also possible to build universal programs by specifying the appropriate <tt>-arch</tt> options during the link step (see Sect.&nbsp;<a href="#sec:overall">3.1</a>).

<div class="p"><!----></div>
     <h3><a name="tth_sEc2.3">
2.3</a>&nbsp;&nbsp;Installation on Microsoft Windows</h3><a name="sec:ins-windows">
</a>
The Münster Curry compiler can be built on Windows systems with CygWin as well as with MinGW.

<div class="p"><!----></div>
      <h4><a name="tth_sEc2.3.1">
2.3.1</a>&nbsp;&nbsp;CygWin</h4>
In order to build the Münster Curry compiler with CygWin, the development packages (make, gcc) and a working Haskell compiler are required. Currently, this appears to work only for the native Win32 binaries of ghc. The installation instructions below are derived from notes kindly provided by Diego Berrueta.

<div class="p"><!----></div>
Note: In the following, <tt>&lt;CYGWIN&gt;</tt> represents the directory where CygWin is installed.

<div class="p"><!----></div>

<ol type="1">
<li> Install the Win32 version of ghc in <tt>&lt;CYGWIN&gt;/usr/local/ghc</tt>.<br /><br /></li>

<li> Add <tt>/usr/local/ghc/bin</tt> to the path. Make sure that the executable is found by typing <tt>ghc -v</tt> in the CygWin console. This should print out a long list configuration and package information for ghc.<br /><br /></li>

<li> Unpack the sources of the Münster Curry compiler in some convenient place and change into the <tt>curry-0.9.11</tt> directory.<br /><br /></li>

<li> Configure, compile, and install the compiler:

<pre>
./configure
make
make install

</pre><br /><br /></li>

<li> Ready to test. Make sure that <tt>/usr/local/bin</tt> is in your <tt>PATH</tt>.<br /><br /></li>
</ol>

<div class="p"><!----></div>
      <h4><a name="tth_sEc2.3.2">
2.3.2</a>&nbsp;&nbsp;MinGW</h4>
In order to build the Münster Curry compiler with MinGW, a minimal development environment (gcc-core, binutils, mingw-runtime, and win32-api) is needed. In addition, the MSYS shell must be installed and a working Haskell compiler is required. The compiler can be built with the usual commands

<pre>
./configure
make
make install

</pre>
The last step may be omitted and the compiler can be used from its build directory, too. Note that at present, the networking related functions from modules <tt>IOExts</tt> and <tt>Socket</tt> do not work with MinGW.

<div class="p"><!----></div>
 <h2><a name="tth_sEc3">
3</a>&nbsp;&nbsp;Using the Compiler</h2><a name="sec:cyc">
</a>
The Curry compiler is invoked with the command <tt>cyc</tt>. Normally, it performs compilation, assembly, and linking. The "overall options" allow stopping this process at an intermediate stage. For example, the <tt>-c</tt> option says not to run the linker. The output then consists of object files output by the assembler.

<div class="p"><!----></div>
Other options control one stage of processing; for instance, the <tt>--debug</tt> option tells <tt>cyc</tt> to compile Curry modules such that they can be evaluated by the declarative debugger (see Sect.&nbsp;<a href="#sec:debugger">4</a>).

<div class="p"><!----></div>
The <tt>cyc</tt> program accepts options and file names as operands. Options and file names can be mixed on the command line. In general, the order of options is not relevant with the exception of additional libraries specified with <tt>-l</tt> options. On many systems, these should be specified last on the command line in order to ensure proper linking of programs.

<div class="p"><!----></div>
The order of file names does matter as it determines the order in which the files are compiled. In particular, it is essential to specify Curry source modules such that each module is compiled before any module that depends on it. <tt>cyc</tt> compiles and links exactly those files which are named on the command line and does not include imported modules automatically. In general, you should use <tt>cymake</tt> (see Sect.&nbsp;<a href="#sec:cymake">5</a>) in order to build programs composed of more than one source module.

<div class="p"><!----></div>
The source language of a file and the associated processing is determined by the file name extension. Argument names which end with <tt>.curry</tt> are taken to be Curry source, names ending in <tt>.lcurry</tt> are taken to be literate Curry source, names ending in <tt>.c</tt> are taken to be C code, names ending in <tt>.s</tt> are taken to be assembler programs, and <tt>.o</tt> are object files.

<div class="p"><!----></div>
By default, a program linked with <tt>cyc</tt> executes the <tt>main</tt> function in the main module of the program. The compiler assumes that the last Curry source file appearing on the command line defines the main module. A different main module can be specified explicitly with the <tt>-M</tt> option. It is possible to specify a different goal with the <tt>-e</tt> option. See Sect.&nbsp;<a href="#sec:goals">6.1</a> for a description of the syntax of goals. If the type of the goal is <tt>IO</tt>&nbsp;t, for some arbitrary type t, the program executes the corresponding I/O action. Otherwise, the goal is evaluated and its solutions are presented incrementally on the standard output.

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.1">
3.1</a>&nbsp;&nbsp;Overall Options</h3><a name="sec:overall">
</a>
The following options control the general processing of source files.

<dl compact="compact">
 <dt><b>-n</b></dt>
	<dd> Do not execute any command, but display each command that normally would be executed.</dd>
 <dt><b>-q</b></dt>
	<dd> This option has no effect.</dd>
 <dt><b>-v</b></dt>
	<dd> Display each command before it is executed by <tt>cyc</tt>.</dd>
 <dt><b>-C</b></dt>
	<dd> Stop processing after generating C code from the Curry source modules.</dd>
 <dt><b>-S</b></dt>
	<dd> Stop processing after generating assembler code from the Curry and C source files.</dd>
 <dt><b>-c</b></dt>
	<dd> Compile and assemble the source file but do not link.</dd>
 <dt><b>-o <em>file</em></b></dt>
	<dd> Place the output in a file named <em>file</em>. Since only one output file can be specified, it does not make sense to use <tt>-o</tt> when compiling more than one input file unless you are producing an executable file as output.

<div class="p"><!----></div>
If <tt>-o</tt> is not specified, the default is to put an executable file in <tt>a.out</tt>, the object file for <em>source.suffix</em> in <em>source</em><tt>.o</tt>, its assembler file in <em>source</em><tt>.s</tt>, and its C file in <em>source</em><tt>.c</tt>.</dd>
 <dt><b>-arch <em>arch</em></b></dt>
	<dd> Mac OS X: Compile for the specified target architecture <em>arch</em>. Multiple options work, and direct the compiler to produce "universal" binaries. Using this option on other systems is likely to produce a C compiler error.</dd>
</dl>

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.2">
3.2</a>&nbsp;&nbsp;Compiling Curry Modules</h3><a name="sec:compiling">
</a>
The names of Curry source files must end with <tt>.curry</tt> or <tt>.lcurry</tt>. The latter are taken to contain literate Curry source and are deliterated first. All Curry source files are compiled into C code. In addition, for every source file <em>file</em><tt>.curry</tt> and <em>file</em><tt>.lcurry</tt>, respectively, the compiler creates a file <em>file</em><tt>.icurry</tt> containing the module's interface. The compiler uses module interfaces when processing import declarations in a source module. In order for the compiler to find the interfaces of imported modules, the name of the source file should agree with its module name. Hierarchical module names of the form <tt>A.B.C</tt> are mapped onto the filesystem as in Java, i.e., the compiler expects to find the interface of this module in file <tt>C.icurry</tt> in directory <tt>A/B</tt> relative to the directory where the compiler was invoked or to one of the directories specifying the import search path (see also Sect.&nbsp;<a href="#sec:hierarchical">5.3</a>).

<div class="p"><!----></div>
The following options control the compilation of Curry source into C code.

<dl compact="compact">
 <dt><b>-g</b></dt>
	<dd> Deprecated synonym for <tt>--debug</tt>.</dd>
 <dt><b>--debug</b></dt>
	<dd> Prepare the compiled code for executing the program with the declarative debugger.

<div class="p"><!----></div>
Note that code compiled with this option is incompatible with code compiled without this option. This option must therefore be used consistently for compiling and linking all modules of a program.</dd>
 <dt><b>--trusted</b></dt>
	<dd> This flag has an effect only in conjunction with one of previous options. It tells that debugger that it can trust all functions from a module compiled with this flag. The debugger will not ask questions about such functions.</dd>
 <dt><b>-i<em>dir</em></b></dt>
	<dd> Add directory <em>dir</em> to the list of paths used to locate interface files. By default, the compiler searches for interface files in the current directory and in its standard library directory (usually <tt>/usr/local/lib/curry-0.9.11</tt>).

<div class="p"><!----></div>
The directory <em>dir</em> is also added to the list of paths used to locate header files, as if <tt>-I</tt><em>dir</em> was present on the command line.</dd>
 <dt><b>-P<em>dir</em></b></dt>
	<dd> Add directory <em>dir</em> to the list of paths used to locate interface files. By default, the compiler searches for interface files in the current directory and in its standard library directory (usually <tt>/usr/local/lib/curry-0.9.11</tt>) .

<div class="p"><!----></div>
The directory <em>dir</em> is also added to the lists of paths used to locate header and library
files, respectively, as if <tt>-I</tt><em>dir</em> and <tt>-L</tt><em>dir</em> were present on the command line.</dd>
 <dt><b>-Whaskell</b></dt>
	<dd></dd>
 <dt><b>-Wprolog</b></dt>
	<dd>  </dd>
 <dt><b>-Wgoedel</b></dt>
	<dd>  Warn whenever a definition does not obey the selected case mode (cf. Sect. C.1 of the Curry report&nbsp;[<a href="#Hanus06:Report" name="CITEHanus06:Report">Han06</a>]).</dd>
 <dt><b>-Wall</b></dt>
	<dd> Enable all warnings below.</dd>
 <dt><b>-Wunused</b></dt>
	<dd> Enable all unused warnings below.</dd>
 <dt><b>-Wunused-data</b></dt>
	<dd> Warn whenever a data constructor is not used.</dd>
 <dt><b>-Wunused-decl</b></dt>
	<dd> Warn whenever a function or pattern declaration is not used.</dd>
 <dt><b>-Wunused-var</b></dt>
	<dd> Warn whenever a function or pattern argument is not used.</dd>
 <dt><b>-Wshadow</b></dt>
	<dd> Warn whenever a local declaration shadows a declaration from an outer scope.</dd>
 <dt><b>-Woverlap</b></dt>
	<dd> Warn whenever a function's equations have overlapping left hand sides.</dd>
 <dt><b>-H<em>size</em></b></dt>
	<dd> Change the heap size used by the compiler to <em>size</em>. It is possible to use the abbreviations <em>size</em><tt>k</tt> and <em>size</em><tt>M</tt> to specify the heap size in kBytes and MBytes, respectively.

<div class="p"><!----></div>
Note that this option does not effect the heap size of the compiled executable. Use <tt>-h</tt><em>size</em> for this (see Sect.&nbsp;<a href="#sec:linking">3.4</a>).</dd>
</dl>

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.3">
3.3</a>&nbsp;&nbsp;Compiling C Files</h3><a name="sec:compiling-c">
</a>
The following list describes only the most common options understood by <tt>cyc</tt> when compiling C source either directly or as a result of previously compiling Curry source into C code. In fact, <tt>cyc</tt> passes on most of its options to the C compiler. For a detailed description of these options see the Gnu C man pages and documentation.

<dl compact="compact">
 <dt><b>-D<em>name</em></b></dt>
	<dd> Predefine <em>name</em> as a macro, with definition <tt>1</tt>.</dd>
 <dt><b>-D<em>name</em>=<em>defn</em></b></dt>
	<dd> Predefine <em>name</em> as a macro with definition <em>defn</em>.</dd>
 <dt><b>-U<em>name</em></b></dt>
	<dd> Cancel any previous definition of <em>name</em>, either built in or provided with a <tt>-D</tt> definition.</dd>
 <dt><b>-I<em>dir</em></b></dt>
	<dd> Add directory <em>dir</em> to the list of paths used to locate header files. The standard library directory (usually <tt>/usr/local/lib/curry-0.9.11</tt>) is always included in this list.</dd>
 <dt><b>-F<em>dir</em></b></dt>
	<dd> Mac OS X: Add the framework directory <em>dir</em> to the list of paths used to locate header files. Using this option on other systems is likely to produce a C compiler error.</dd>
 <dt><b>-O</b></dt>
	<dd> equivalent to <tt>-O1</tt></dd>
 <dt><b>-O<em>level</em></b></dt>
	<dd> Controls optimization of the compiled code. <tt>-O0</tt> disables all optimizations. Note that <tt>-O3</tt> and higher levels will fail to produce valid code for Curry modules on many architectures.</dd>
 <dt><b>--ccopt <em>opt</em></b></dt>
	<dd> Passes the option <em>opt</em> to the C compiler without interpretation. For instance, in order to include debugging symbols in the compiled C code, invoke the compiler with <tt>--ccopt -g</tt>.</dd>
 <dt><b>--ccopts <em>opts</em></b></dt>
	<dd> Passes each option from the comma separated list <em>opts</em> to the C compiler without further interpretation.</dd>
</dl>

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.4">
3.4</a>&nbsp;&nbsp;Linking</h3><a name="sec:linking">
</a>
The following options are relevant while linking a program. The compiler creates a tiny C code file in this phase, which contains the startup code initializing the Curry runtime system and starting the evaluation of the goal. This file is compiled like other C code during the link phase.

<dl compact="compact">
 <dt><b>-g</b></dt>
	<dd> Deprecated synonym for <tt>--debug</tt>.</dd>
 <dt><b>--debug</b></dt>
	<dd> Compile a program that invokes the declarative debugger. All Curry modules must have been compiled with the <tt>--debug</tt> option as well.</dd>
 <dt><b>-h<em>size</em></b></dt>
	<dd> Use <em>size</em> bytes for the heap of the Curry program. Note that actually twice as much memory is allocated for the heap because the runtime system uses a two-space copying collector. The abbreviations <em>size</em><tt>k</tt> and <em>size</em><tt>M</tt> can be used for specifying the size in kBytes and MBytes, respectively. The default is to use a 4&nbsp;MByte heap.</dd>
 <dt><b>-k<em>size</em></b></dt>
	<dd> Use <em>size</em> bytes for the stack of the Curry program. The abbreviations <em>size</em><tt>k</tt> and <em>size</em><tt>M</tt> can be used for specifying the size in kBytes and MBytes, respectively. The default is to use a 512&nbsp;kByte stack.</dd>
 <dt><b>-t<em>size</em></b></dt>
	<dd> Use <em>size</em> bytes for the trail stack of the Curry program. The abbreviations <em>size</em><tt>k</tt> and <em>size</em><tt>M</tt> can be used for specifying the size in kBytes and MBytes, respectively. The default is to use a 512&nbsp;kByte trail stack.</dd>
 <dt><b>-f</b></dt>
	<dd> Print all failures during execution of a non-deterministic goal. If given multiple times, print also failures inside encapsulated search.</dd>
 <dt><b>-p</b></dt>
	<dd> Print cumulated execution times and memory usage statistics at the end of the run. If specified more than once, also print memory statistics at each garbage collection.</dd>
 <dt><b>-e<em>goal</em></b></dt>
	<dd> Evaluate <em>goal</em> instead of <tt>main</tt>. See Sect.&nbsp;<a href="#sec:goals">6.1</a> for a description of the goal syntax. The <em>goal</em> is evaluated with respect to the modules specified with <tt>-M</tt> options and the Curry source files appearing on the command line. All
entities exported from the <tt>Prelude</tt> and the Curry source file that appears last on the command line or the last module specified with a <tt>-M</tt> option, if there are no source file arguments, are in scope with unqualified and qualified names. The exported entities of all other
modules are in scope with qualified names only.</dd>
 <dt><b>-T<em>goal</em></b></dt>
	<dd> Compute the type of <em>goal</em>. See Sect.&nbsp;<a href="#sec:goals">6.1</a> for a description of the goal syntax. The <em>goal</em>'s type is computed with respect to the modules specified with <tt>-M</tt> options and the Curry source files appearing on the command line. All
entities exported from the <tt>Prelude</tt> and the Curry source file that appears last on the command line or the last module specified with a <tt>-M</tt> option, if there are no source file arguments, are in scope with unqualified and qualified names. The exported entities of all other
modules are in scope with qualified names only.</dd>
 <dt><b>-M<em>module</em></b></dt>
	<dd> Brings all entities exported from <em>module</em> into scope with their qualified names for a goal specified with the <tt>-e</tt> and <tt>-T</tt> options. By default, only the entities exported from the <tt>Prelude</tt> and the Curry source files occurring on the command line are in scope. The entities exported from the <tt>Prelude</tt> and the last source file appearing on the command line or specified with the last <tt>-M</tt> option, if there are no source file arguments, are brought into scope with their unqualified names, too.

<div class="p"><!----></div>
  <em>Module</em> is either the name of a source file (ending in  <tt>.lcurry</tt> or <tt>.curry</tt>), the name of an interface file (ending in <tt>.icurry</tt>), or the name of a module whose interface can be located in the interface search path.</dd>
 <dt><b>-L<em>dir</em></b></dt>
	<dd> Add directory <em>dir</em> to the list of paths used to locate libraries specified with <tt>-l</tt> options. The standard library directory (in the standard configuration: <tt>/usr/local/lib/curry-0.9.11</tt>) is always included in this list.</dd>
 <dt><b>-l<em>lib</em></b></dt>
	<dd> Search the library named <em>lib</em> when linking.</dd>
 <dt><b>-framework <em>name</em></b></dt>
	<dd> Mac OS X: Link against framework <em>name</em>. Using this option on other systems is likely to produce a C compiler error.</dd>
 <dt><b>--ldopt <em>opt</em></b></dt>
	<dd> Passes the option <em>opt</em> to the C compiler without interpretation. In contrast to <tt>--ccopt</tt> (see Sect.&nbsp;<a href="#sec:compiling-c">3.3</a>), <em>opt</em> is used only during the link phase.</dd>
 <dt><b>--ldopts <em>opts</em></b></dt>
	<dd> Passes each option from the comma separated list <em>opts</em> to the C compiler without further interpretation. As with <tt>--ldopt</tt>, <em>opts</em> are used only during the link phase.</dd>
</dl>

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.5">
3.5</a>&nbsp;&nbsp;Environment</h3>

<dl compact="compact">
 <dt><b>CURRY_PATH</b></dt>
	<dd> The environment variable <tt>CURRY_PATH</tt> is used to locate the compiler executables. The default value is <tt>/usr/local/lib/curry-0.9.11</tt>.</dd>
 <dt><b>CURRY_IMPORT_PATH</b></dt>
	<dd></dd>
 <dt><b>CURRY_INCLUDE_PATH</b></dt>
	<dd>  </dd>
 <dt><b>CURRY_LIBRARY_PATH</b></dt>
	<dd>  
The environment variables <tt>CURRY_IMPORT_PATH</tt>, <tt>CURRY_INCLUDE_PATH</tt>, and <tt>CURRY_LIBRARY_PATH</tt> contain colon-separated lists of directories that are searched for imported interfaces, included header files, and library files, respectively. Their default value is <tt>$CURRY_PATH</tt>.</dd>
</dl>

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.6">
3.6</a>&nbsp;&nbsp;Examples</h3>

<pre>
cyc test.curry

</pre>
This command compiles and links the Curry module in <tt>test.curry</tt>. The executable is put in <tt>a.out</tt> and evaluates the <tt>main</tt> function in <tt>test.curry</tt>.

<pre>
cyc -h12M -O2 A.lcurry B.lcurry -o B

</pre>
This command compiles and links the Curry modules in <tt>A.lcurry</tt> and <tt>B.lcurry</tt> in that order. Both files are assumed to contain literate Curry source. The code is optimized by the C compiler using optimization level 2. The executable is put in file <tt>B</tt>. It evaluates the <tt>main</tt> function in <tt>B.lcurry</tt> and uses a larger default heap (12 MBytes).

<pre>
cyc -c nat.curry
cyc -e "add n Z =:= S Z where n free" nat.o -Mnat -o one

</pre>
The first of these commands compiles the Curry module in <tt>nat.curry</tt> and places the object file in <tt>nat.o</tt>. The second command then links the object file into a program which evaluates the goal <tt>add n Z =:= S Z where n free</tt> in the context of this module. Note that this context must be specified explicitly with a <tt>-M</tt> option because no Curry module was named on the second command line. The executable is placed in <tt>one</tt>.

<pre>
cyc -e "length Xs where Xs free"

</pre>
This command compiles and links a program that evaluates the goal <tt>length Xs where Xs free</tt>. The executable is placed in <tt>a.out</tt>.

<div class="p"><!----></div>
     <h3><a name="tth_sEc3.7">
3.7</a>&nbsp;&nbsp;Running Programs</h3><a name="sec:running">
</a>
The operation of a Curry program depends on the type of the goal being evaluated. If it is of type <tt>IO</tt>&nbsp;t, the I/O action described by the goal is executed. All command line arguments except for the runtime system options (see below) are available to the program and can be accessed with the function <tt>System.getArgs</tt>.

<div class="p"><!----></div>
If the goal's type is not <tt>IO</tt>&nbsp;t, the program computes and prints the solutions of the goal with a depth first search strategy. A solution comprises the normal form of the goal and the bindings and constraints for its free variables. When run on an interactive terminal, solutions are presented one by one giving the user a chance to stop the computation after each solution. Otherwise, all solutions of the goal are computed.

<div class="p"><!----></div>
This behavior can be changed by passing one of the options <tt>-i</tt> and <tt>-n</tt> to the program. If invoked with <tt>-i</tt>, the program computes the solutions incrementally as if it were run on an interactive terminal. If invoked with <tt>-n</tt>, the goal's solutions are computed all at once.

<div class="p"><!----></div>
All Curry programs run with fixed size heap, stack, and trail. Their sizes can be specified at link time (see Sect.&nbsp;<a href="#sec:linking">3.4</a>), but can be changed at run-time by passing options to the Curry runtime system. Such options must be enclosed with <tt>+RTS</tt> and <tt>-RTS</tt> arguments on the command line. The <tt>-RTS</tt> switch may be omitted if it is the last argument on the command line.

<div class="p"><!----></div>
The Curry runtime system understands the following options:

<dl compact="compact">
 <dt><b>-b <em>mode</em></b></dt>
	<dd> Use buffer mode <em>mode</em> for the standard input and output of the program where the following <em>mode</em>s are recognized <br />
    
<table>
<tr><td><tt>n</tt> </td><td>Unbuffered </td></tr>
<tr><td><tt>l</tt> </td><td>Line buffered </td></tr>
<tr><td><tt>f</tt>[<em>n</em>] </td><td>Fully buffered </td></tr></table>
 <br />
    The optional number <em>n</em> allows specifying the buffer size when using fully buffered mode.</dd>
 <dt><b>-h <em>n</em></b></dt>
	<dd> Use <em>n</em> bytes for the heap in this run of the program. Note that actually twice as much memory is allocated for the heap because the runtime system uses a two-space copying collector. The abbreviations <em>n</em><tt>k</tt> and <em>n</em><tt>M</tt> can be used for specifying the size in kBytes and MBytes, respectively.</dd>
 <dt><b>-k <em>n</em></b></dt>
	<dd> Use <em>n</em> bytes for the stack in this run of the program. The abbreviations <em>n</em><tt>k</tt> and <em>n</em><tt>M</tt> can be used for specifying the size in kBytes and MBytes, respectively.</dd>
 <dt><b>-t <em>n</em></b></dt>
	<dd> Use <em>n</em> bytes for the trail stack in this run of the program. The abbreviations <em>n</em><tt>k</tt> and <em>n</em><tt>M</tt> can be used for specifying the size in kBytes and MBytes, respectively.</dd>
 <dt><b>-f</b></dt>
	<dd> Print all failures during execution of a non-deterministic goal. If given multiple times, print also failures inside encapsulated search.</dd>
 <dt><b>-p</b></dt>
	<dd> Print cumulated execution times and memory usage statistics at the end of the run. If specified more than once, also print memory statistics at each garbage collection.</dd>
 <dt><b>-d</b></dt>
	<dd> Turn on the low-level tracer of the abstract machine. In general you do not want to see its output, but it may give hints to why a program does not compute an expected solution or runs into a deadlock. Beware that tracing can slow down program execution considerably and the output may be excessively large.</dd>
</dl>

<div class="p"><!----></div>

<b>Example&nbsp;&nbsp;</b>

<pre>
prog -x +RTS -k512k -h8M -t0 -RTS foo

</pre>
executes <tt>prog</tt> with an 8 MByte heap, a 512 kByte stack, and no trail stack. The arguments <tt>-x</tt> and <tt>foo</tt> are passed to the Curry program and are available from Curry code via <tt>System.getArgs</tt>. Note that running a program without a trail stack, as in this example, requires that the code is completely deterministic and does not use encapsulated search.

<div class="p"><!----></div>
 <h2><a name="tth_sEc4">
4</a>&nbsp;&nbsp;Using the Debugger</h2><a name="sec:debugger">
</a>
The Münster Curry compiler includes a declarative debugger of wrong answers. This debugger can be used for finding the source of a wrong answer in the program. The idea of a declarative debugger is to compute a representation of the program's computation, the so-called computation tree. In the Curry debugger, each node of the computation tree corresponds to a basic fact <em>f t<sub>1</sub> ... t<sub>n</sub> = t</em> where f is the name of a function and t and all t<sub>i</sub> are data terms. Data terms can include the special value <font face="symbol">^</font
> denoting an unevaluated expression. The value <font face="symbol">^</font
> is represented by an underscore (<tt>_</tt>) in the output of the debugger.

<div class="p"><!----></div>
The debugger will ask questions about the correctness of these basic facts in order to find (an instance of) a program rule which computes a value that does not match the intended semantics of the program.

<div class="p"><!----></div>
In order to debug a program, all of its modules have to be recompiled with the <tt>--debug</tt> command line flag. 
<div class="p"><!----></div>
The debugger is capable of handling programs which use encapsulated search. Note that wrong answers whose cause is actually a missing answer in a search goal cannot be detected. The debugger cannot yet handle programs involving I/O.

<div class="p"><!----></div>
     <h3><a name="tth_sEc4.1">
4.1</a>&nbsp;&nbsp;Trusted functions</h3><a name="sec:trusted">
</a>
When debugging larger programs, it is very inconvenient to answer questions about lot of functions which are supposed to be correct. In order to narrow down the region of the program that is explored in the debugger, the compiler allows annotating whole modules as well as individual functions as trusted. The debugger assumes that basic facts for trusted function are always correct and will not ask any questions for them. Note that the prelude and the standard libraries are always trusted.

<div class="p"><!----></div>
A whole module can be trusted by invoking with the compiler with the <tt>--trusted</tt> option in addition to <tt>--debug</tt>.  Individual functions can be trusted by means of trust annotations in the source code.

<div class="p"><!----></div>
Lexically, trust annotations appear as nested comments using <tt>{-#</tt> and <tt>#-}</tt> as delimiters<a href="#tthFtNtAAH" name="tthFrefAAH"><sup>7</sup></a>. Syntactically, trust annotations are declarations that can appear where a function declaration is allowed. To this end, the Curry grammar is extended as follows (cf. appendix C.3 in&nbsp;[<a href="#Hanus06:Report" name="CITEHanus06:Report">Han06</a>]).

<br clear="all" /><table border="0" cellspacing="0" cellpadding="0" width="100%">
<table border="0" cellspacing="0" cellpadding="0">
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 <i>FunctionDeclaration</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>Signature</i>  | <i>TrustAnnot</i>  | <i>Equat</i> </td></tr></table><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 <i>TrustAnnot</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table><tr><td nowrap="nowrap" align="right" colspan="1">{<font face="symbol">-</font
><tt>#</tt> <span class="roman">(</span><tt>TRUST</tt>  | <tt>SUSPECT</tt><span class="roman">)</span> <span class="roman">(</span><i>FunctionNames</i>  | _<span class="roman">)</span> <tt>#</tt><font face="symbol">-</font
>}</td></tr></table><td width="50%"></td></tr></table></table>




<div class="p"><!----></div>
An explicit trust annotation <tt>{-# TRUST</tt> f<sub>1</sub>, ..., f<sub>n</sub> <tt>#-}</tt> declares f<sub>1</sub>,...,f<sub>n</sub> as trusted functions. The annotation <tt>{-# TRUST _ #-}</tt> declares all functions in its declaration group, which are not listed in an explicit trust annotation, as trusted functions. Local functions are trusted automatically when their enclosing function is trusted. Thus, adding an annotation <tt>{-# TRUST _ #-}</tt> at the top-level of a module is equivalent to compiling the module with <tt>--trusted</tt>.

<div class="p"><!----></div>
<tt>{-# SUSPECT</tt> ... <tt>#-}</tt> annotations have the opposite effect as <tt>TRUST</tt>  annotations, i.e., they declare functions as untrusted. This is useful in order to narrow down the set of functions where a bug is suspected when a module is compiled with <tt>--trusted</tt>. In some sense, adding a <tt>SUSPECT</tt> annotation to an otherwise trusted module is the equivalent of setting a breakpoint in a conventional debugger for an imperative language.

<div class="p"><!----></div>
 <h2><a name="tth_sEc5">
5</a>&nbsp;&nbsp;Building programs with <tt>cymake</tt></h2><a name="sec:cymake">
</a>
<tt>cymake</tt> is a make like tool for compiling Curry programs. Dependencies are automatically extracted from the source files; there is no need to construct or maintain a Makefile.

<div class="p"><!----></div>
<tt>cymake</tt> accepts options and file names on the command line in an arbitrary order. The file arguments determine what to compile. If <em>file</em> is the name of an executable (i.e.&nbsp;it has no extension), <em>file</em><tt>.lcurry</tt> or <em>file</em><tt>.curry</tt> is assumed to contain the main module of the program. All modules it depends on are compiled (if necessary) and linked to an executable. If <em>file</em> is the name of a source module (i.e.&nbsp;it ends in <tt>.lcurry</tt> or <tt>.curry</tt>) or an object module (i.e.&nbsp;it ends in <tt>.o</tt>) then the object file for that module is generated. Archive files and shared libraries (i.e.&nbsp;files ending with <tt>.a</tt>, <tt>.so</tt>, <tt>.dylib</tt>, or <tt>.dll</tt>) are not targets, but passed as additional arguments to the linker.

<div class="p"><!----></div>
<tt>cymake</tt> allows several programs to reside in the same directory. Modules can be shared between several programs. Directories to search for modules can be specified with the <tt>-i</tt> flag, in the same way as for <tt>cyc</tt>. In addition, directories which are searched for interfaces of library modules can be specified with the <tt>-P</tt> flag.

<div class="p"><!----></div>
<tt>cymake</tt> correctly handles the fact that the Curry compiler generates two files, an object file and an interface file, for each module compiled.

<div class="p"><!----></div>
     <h3><a name="tth_sEc5.1">
5.1</a>&nbsp;&nbsp;Options</h3>
<tt>cymake</tt> understands the following options:

<dl compact="compact">
 <dt><b>-n</b></dt>
	<dd> No execution mode. Print commands but do not execute them.</dd>
 <dt><b>-q</b></dt>
	<dd> Quiet mode. Do not print commands before executing them.</dd>
 <dt><b>-M</b></dt>
	<dd> Output a Makefile compatible dependency list on the standard output.</dd>
 <dt><b>--find</b></dt>
	<dd> For each command line target t, <tt>cymake</tt> will print a line of the form t<tt>: </tt>f, where f is the name of the source or interface file corresponding to t. If t is a module name, <tt>cymake</tt> will look for the source or interface file first in the current directory and then along the search path. If no file is found, f is empty.</dd>
 <dt><b>-a</b></dt>
	<dd> Always link the executable, even if it is not out of date with respect to its object files. This is useful if only the goal to be evaluated by the program is changed.</dd>
 <dt><b>-e <em>goal</em></b></dt>
	<dd> Evaluate <em>goal</em> instead of function <tt>main</tt>. This option cannot be used when compiling more than one module. See Sect.&nbsp;<a href="#sec:goals">6.1</a> for a description of the syntax of goals.</dd>
 <dt><b>-T<em>goal</em></b></dt>
	<dd> Compute the type of <em>goal</em>. This option cannot be used when compiling more than one module. See Sect.&nbsp;<a href="#sec:goals">6.1</a> for a description of the goal syntax.</dd>
 <dt><b>--debug</b></dt>
	<dd> Compile the program for use with the debugger. As object files compiled with <tt>--debug</tt> cannot be linked with object files compiled without <tt>--debug</tt>, <tt>cymake</tt> uses the suffix <tt>.d.o</tt> instead of <tt>.o</tt> for object files when this option is specified.</dd>
 <dt><b>-i<em>dir</em></b></dt>
	<dd> Add directory <em>dir</em> to the list of paths used to locate imported modules. By default, the compiler searches only the current directory for source files. Note that the current directory is always searched first.

<div class="p"><!----></div>
  The directory <em>dir</em> is also added to the list of paths used to locate C header files, as
if <tt>-I</tt><em>dir</em> was present on the command line.</dd>
 <dt><b>-P<em>dir</em></b></dt>
	<dd> Add directory <em>dir</em> to the list of paths used to locate interface files for library modules. By default, the compiler searches for interface files in its standard library directory (usually <tt>/usr/local/lib/curry-0.9.11</tt>).

<div class="p"><!----></div>
  The directory <em>dir</em> is also added to the lists of paths used to locate C header files and
libraries, respectively, as if <tt>-I</tt><em>dir</em> and <tt>-L</tt><em>dir</em> were present on the command line.

<div class="p"><!----></div>
  The compiler scans the directories specified with <tt>-P</tt> before the installation directory; thus, it is possible to hide the interfaces of the standard library by using this option.</dd>
 <dt><b>-o <em>file</em></b></dt>
	<dd> Puts the executable file in <em>file</em>. This option cannot be used when compiling more than one module. This option is ignored if compiling to an object file.</dd>
 <dt><b>--clean</b></dt>
	<dd> Remove all compiled files for a program. If specified in conjunction with <tt>--debug</tt> only the object files for the debugger, i.e. with suffix <tt>.d.o</tt>, are removed.</dd>
</dl>
Most other flags are assumed to be compiler options and are passed to <tt>cyc</tt> when compiling and linking modules.

<div class="p"><!----></div>
     <h3><a name="tth_sEc5.2">
5.2</a>&nbsp;&nbsp;Environment</h3>

<dl compact="compact">
 <dt><b>CURRY_PATH</b></dt>
	<dd> The environment variable <tt>CURRY_PATH</tt> is used to locate the auxiliary executables used by <tt>cymake</tt>.  The default value is <tt>/usr/local/lib/curry-0.9.11</tt>.</dd>
 <dt><b>CURRY_IMPORT_PATH</b></dt>
	<dd></dd>
 <dt><b>CURRY_INCLUDE_PATH</b></dt>
	<dd>  </dd>
 <dt><b>CURRY_LIBRARY_PATH</b></dt>
	<dd>  The environment variables <tt>CURRY_IMPORT_PATH</tt>, <tt>CURRY_INCLUDE_PATH</tt>, and <tt>CURRY_LIBRARY_PATH</tt> contain colon-separated lists of directories that are searched for imported interfaces, included header files, and library files, respectively. Their default value is <tt>$CURRY_PATH</tt>.</dd>
</dl>

<div class="p"><!----></div>
     <h3><a name="tth_sEc5.3">
5.3</a>&nbsp;&nbsp;Modules and the Filesystem</h3><a name="sec:hierarchical">
</a>
Starting with release 0.9.6, the Münster Curry compiler maps hierarchical module names onto the filesystem as in Java. This is of particular importance in conjunction with <tt>cymake</tt> which tries to find sources for imported modules. For instance, the source for an imported module <tt>Lib.Data.Set</tt> is expected in one of the files <tt>Lib/Data/Set.lcurry</tt> and <tt>Lib/Data/Set.curry</tt>. This path is relative to the directory where <tt>cymake</tt> is invoked or one of the directories specified with the <tt>-i</tt> option and does not depend on the path of the source file or target being compiled. This makes it possible to import modules of one subproject into sources of another subproject. The compiler uses the same procedure for locating interface files of imported modules. Therefore, you should always compile the sources of hierarchical modules from the base directory of the project.

<div class="p"><!----></div>
For instance, given the following directory layout

<center>
<img src="hierdir.png" alt="Hierarchical directory">
</center>
and the following association between files and modules

<center><tt>
  
<table>
<tr><td><span class="roman">File</span> </td><td><span class="roman">Module</span> </td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="roman">File</span> </td><td><span class="roman">Module</span> </td></tr>
<tr><td>main.curry </td><td>main </td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SubProj/Sub.curry </td><td>Sub </td></tr>
<tr><td>Lib/Data.curry </td><td>Lib.Data </td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SubProj/Lib/Mod1.curry </td><td>Sub.Mod1 </td></tr>
<tr><td>Lib/Funs.curry </td><td>Lib.Funs </td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SubProj/Lib/Mod2.curry </td><td>Sub.Mod2
  </td></tr></table>

</tt></center>
it is possible to rebuild the program and all of its imported modules using the single command <tt>cymake -iSub main</tt>.

<div class="p"><!----></div>
     <h3><a name="tth_sEc5.4">
5.4</a>&nbsp;&nbsp;Using Libraries</h3>
The <tt>-i</tt> and <tt>-P</tt> options of <tt>cymake</tt> allow searching for imported Curry modules and library interfaces in various directories besides the current directory and the standard library directory. Imported source files, which are found in the current directory and along the paths specified with <tt>-i</tt> options, are updated as necessary and the compiled object files are automatically included when linking the executable program.

<div class="p"><!----></div>
Interfaces found along the paths specified with <tt>-P</tt> options are used for determining whether a source module is out of date, but they cause no object files to be linked to the program. As <tt>cymake</tt> does not provide means to specify additional object files to be linked with a program, the object files corresponding to these interfaces must be placed in a library, which must be specified when invoking <tt>cymake</tt>.

<div class="p"><!----></div>
As an example, consider the following directory hierarchy

<center>
<img src="sampledir.png" alt="Sample directory">
</center>
where the files in directory <tt>modules</tt> are part of the program and the files in directory <tt>library</tt> constitute an independent library.

<div class="p"><!----></div>
Assuming that the files <tt>L1.curry</tt> and <tt>L2.curry</tt> define the modules <tt>L1</tt> and <tt>L2</tt>, respectively, it is possible to bring the library up to date with the command

<pre>
(cd library; cymake L[12].curry; ar rc libL12.a L[12].o; ranlib libL12.a)

</pre>

<div class="p"><!----></div>
In order to bring the program <tt>prog</tt> up to date when the files <tt>M1.curry</tt> and <tt>M2.curry</tt> define the modules <tt>M1</tt> and <tt>M2</tt>, respectively, the following command can be used:

<pre>
cymake -imodules -Plibrary prog -lL12

</pre>
Note that this command will not recompile the files <tt>L1.curry</tt> and <tt>L2.curry</tt> if they are newer than the corresponding object files in directory <tt>library</tt>. Nevertheless, the interface files <tt>L1.icurry</tt> and <tt>L2.icurry</tt> can cause a recompilation of <tt>prog.curry</tt>, <tt>M1.curry</tt>, and <tt>M2.curry</tt>, respectively, if these modules are out of date with respect to the interfaces.

<div class="p"><!----></div>
     <h3><a name="tth_sEc5.5">
5.5</a>&nbsp;&nbsp;Using <tt>make</tt></h3>
When <tt>cymake</tt> is invoked with the <tt>-M</tt> option, it generates <tt>make</tt> style dependencies which can be included in a  <tt>Makefile</tt>. The generated dependencies assume that the Makefile contains definitions similar to

<pre>
.SUFFIXES=.curry .lcurry .icurry .o
.curry.o:
        cyc -c $&lt; -o $@
.lcurry.o:
        cyc -c $&lt; -o $@
.o.icurry:
        @test -f "$@" || \
        (echo "$@ does not exist"; \
         echo "Remove $&lt; and run make again"; exit 1)

</pre>
in order to compile Curry modules. The <tt>.o.icurry</tt> rule is essential for a correct operation of <tt>make</tt> with respect to the generated dependencies.

<div class="p"><!----></div>
 <h2><a name="tth_sEc6">
6</a>&nbsp;&nbsp;Using the Interactive Environment</h2><a name="sec:cyi">
</a>
<tt>cyi</tt> is an interactive environment that allows evaluating and debugging Curry goals with respect to a Curry module loaded into the interpreter. At startup, <tt>cyi</tt> reads and interprets commands from the file <tt>.cyirc</tt> in the current directory if it exists, or from <tt>.cyirc</tt> in your home directory otherwise, and then loads either the first module specified on the command line or the Curry prelude.

<div class="p"><!----></div>
     <h3><a name="tth_sEc6.1">
6.1</a>&nbsp;&nbsp;Goals</h3><a name="sec:goals">
</a>
A goal is a Curry expression optionally followed by a where-clause, which can be used for providing local definitions for the goal (see appendix C.3 in&nbsp;[<a href="#Hanus06:Report" name="CITEHanus06:Report">Han06</a>] for the context free syntax of Curry).

<br clear="all" /><table border="0" cellspacing="0" cellpadding="0" width="100%">
<table border="0" cellspacing="0" cellpadding="0">
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<em>Goal</em> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table><tr><td nowrap="nowrap" align="right" colspan="1"><em><span class="roman">Expr</span></em> <span class="roman">[</span><tt>where</tt> <em><span class="roman">LocalDefs</span></em><span class="roman">]</span></td></tr></table></td><td width="50%"></td></tr></table></table>




<div class="p"><!----></div>
All entities exported from the <tt>Prelude</tt> and the module specified in the last <tt>:load</tt>
command are in scope with unqualified and qualified names unless they are shadowed by one of the declarations from the where-clause. Entities from modules that are imported directly or indirectly from the module specified in the last <tt>:load</tt> command are also in scope, but only with qualified names.

<div class="p"><!----></div>
All free variables of the goal must be declared either in the where-clause or by using a let expression as goal. The bindings of the free variables are displayed together with the normal form of the goal after successful evaluation unless the goal is of type <tt>IO</tt>&nbsp;t.

     <h3><a name="tth_sEc6.2">
6.2</a>&nbsp;&nbsp;Commands</h3>
At the prompt of the interactive environment, the following commands can be entered:

<dl compact="compact">
 <dt><b><em>goal</em></b></dt>
	<dd> Evaluate <em>goal</em> in the context of the current module.</dd>
 <dt><b>:<tt>^</tt>[<em>goal</em>]</b></dt>
	<dd> Evaluate <em>goal</em> in the context of the current module. If <em>goal</em> is omitted, the previous goal is evaluated again.</dd>
 <dt><b>:debug [<em>goal</em>]</b></dt>
	<dd> Invoke the debugger for <em>goal</em>. It may take some time to recompile the source modules with debugging information. If <em>goal</em> is omitted, the debugger is invoked for the previous goal.</dd>
 <dt><b>:type [<em>goal</em>]</b></dt>
	<dd> Print the type of <em>goal</em> instead of evaluating it. If <em>goal</em> is omitted, the type of the previous goal is shown.</dd>
 <dt><b>:load <em>module</em></b></dt>
	<dd> Set the current evaluation context to <em>module</em>. This command will compile <em>module</em> and all modules it depends on if necessary. <em>Module</em> can be specified either by the name of its source file (ending in <tt>.lcurry</tt> or <tt>.curry</tt>) or a plain module name. In the latter case, <tt>cyi</tt> will look for a source or interface file for <em>module</em> in the current directory and the current search path as determined by the <tt>-i</tt> and <tt>-P</tt> options set with the <tt>:set</tt> command and the environment variable <tt>CURRY_IMPORT_PATH</tt>.

<div class="p"><!----></div>
  <tt>cyi</tt> displays the name of the current module in its prompt.</dd>
 <dt><b>:load</b></dt>
	<dd> Reset the current evaluation context to the Curry prelude.</dd>
 <dt><b>:reload</b></dt>
	<dd> Repeat the last load command.</dd>
 <dt><b>:freshen</b></dt>
	<dd> Recompile the current module and all imported source files.</dd>
 <dt><b>:clean</b></dt>
	<dd> Remove all compiled files for the current module and all imported source files.</dd>
 <dt><b>:interface <em>module</em></b></dt>
	<dd> Display the interface of <em>module</em>. If the environment variable <tt>PAGER</tt> is set, the interface file is displayed with this command. Otherwise the interface is simply written to the standard output.</dd>
 <dt><b>:interface</b></dt>
	<dd> Display the interface of the current module.</dd>
 <dt><b>:edit <em>file</em></b></dt>
	<dd> Invoke the editor for <em>file</em>. The default editor is <tt>/usr/bin/vi</tt>, but this can be changed by setting one of the environment variables <tt>VISUAL</tt> and <tt>EDITOR</tt> to your preferred editor before starting <tt>cyi</tt>.</dd>
 <dt><b>:edit</b></dt>
	<dd> Edit the source file of the current module.</dd>
 <dt><b>:set <em>option</em> ... </b></dt>
	<dd> Add <em>option</em>s to the list of compiler options.</dd>
 <dt><b>:unset <em>word</em> ... </b></dt>
	<dd> Remove <em>word</em>s from the list of compiler options.</dd>
 <dt><b>:cd <em>dir</em></b></dt>
	<dd> Change the current directory to <em>dir</em>.</dd>
 <dt><b>:cd</b></dt>
	<dd> Print the current directory.</dd>
 <dt><b>:!<em>command</em></b></dt>
	<dd> Execute the shell command <em>command</em>.</dd>
 <dt><b>:version</b></dt>
	<dd> Display the compiler's version.</dd>
 <dt><b>:help</b></dt>
	<dd> Show the list of supported commands.</dd>
 <dt><b>:quit</b></dt>
	<dd> Quit <tt>cyi</tt>.</dd>
</dl>
All commands, except for <tt>:cd</tt> and <tt>:clean</tt>, may be abbreviated to their first letter.

<div class="p"><!----></div>
     <h3><a name="tth_sEc6.3">
6.3</a>&nbsp;&nbsp;Limitations</h3>
<tt>cyi</tt> is implemented as a shell script which invokes <tt>cymake</tt> and <tt>cyc</tt> for compiling modules and goals. Commands are read from the standard input using the shell's builtin <tt>read</tt> command. Some shells, e.g. <tt>/bin/sh</tt> on Solaris, cannot read raw input but apply backslash processing to the input. When <tt>cyi</tt> is executed by such a shell, all backslash characters on the command line must be escaped by another backslash character; i.e., you have to enter <tt>\\x -&gt; x</tt> in a goal instead of <tt>\x -&gt; x</tt> and <tt>ord '\\n'</tt> instead of <tt>ord '\n'</tt>. In order to remind you of this limitation, <tt>cyi</tt> displays the following warning at startup when it is appropriate.

<pre>
Warning: Backslashes on the command line must be escaped
  For instance, use \\x -&#62; x for a lambda abstraction
  and '\\n' for the linefeed character.

</pre>

<div class="p"><!----></div>
On most systems you should not see the above warning and can enter your goals as expected because the configure scripts of the Münster Curry compiler will look for a shell that supports raw reads. If this is not the case, you may want to install a modern shell, e.g., Gnu bash, on your system and reinstall the compiler. Be careful to remove the file <tt>config.cache</tt> if it exists in your build directory before running <tt>configure</tt> again.

<div class="p"><!----></div>
Command line editing and history require support from the <tt>read</tt> command of the shell, which executes the <tt>cyi</tt> script. This is available only for Gnu Bash and Korn shells except for the public domain version. Command line editing also works for the Z shell, but without history.

<div class="p"><!----></div>
     <h3><a name="tth_sEc6.4">
6.4</a>&nbsp;&nbsp;Example Session</h3>
Figs.&nbsp;<a href="#fig:sample-session1">1</a> and <a href="#fig:sample-session2">2</a> on the following pages show a typescript of an example session with <tt>cyi</tt>. User input is typeset in a <i>slanted</i> typeface. The file <tt>nat.curry</tt> contains the following definitions.

<pre>
data Nat = Z | S Nat

nat Z     = success
nat (S n) = nat n

add Z     n = Z
add (S m) n = S (add m n)

sub m n | add d n =:= m = d where d free

</pre>
Note that <tt>add</tt> deliberately contains an error, which is corrected during the session.

<div class="p"><!----></div>
<a name="tth_fIg1">
</a> <pre>
lux@localhost:~ % cyi
    _____ __ __
   / ___/ |  / _               Muenster Curry Compiler
  / /     | / | |              Version 0.9.11, Copyright (c) 1998-2007
 / /___  / /  | |
 \____/ /_/   |_|              Type :h for help

Prelude&#62; <i>length [1,2,3,4]</i>
4
Prelude&#62; <i>length Xs where Xs free</i>
{Xs = []} 0
More solutions? [Y(es)/n(o)/a(ll)] 
{Xs = [_a]} 1
More solutions? [Y(es)/n(o)/a(ll)] 
{Xs = [_a, _b]} 2
More solutions? [Y(es)/n(o)/a(ll)] <i>n</i>
Prelude&#62; <i>:l nat</i>
/usr/local/bin/cyc -c nat.curry -o nat.o
nat&#62; <i>let N free in nat N</i>
{N = Z}
More solutions? [Y(es)/n(o)/a(ll)] 
{N = S Z}
More solutions? [Y(es)/n(o)/a(ll)] <i>n</i>
nat&#62; <i>sub (S (S Z)) X where X free</i>
S (S Z)
More solutions? [Y(es)/n(o)/a(ll)] <i>n</i>
</pre>


<center>Figure 1: Sample session</center>
<a name="fig:sample-session1">
</a>

<div class="p"><!----></div>

<div class="p"><!----></div>
<a name="tth_fIg2">
</a> <pre>
nat&#62; <i>:d</i>
Preparing nat.curry for debugging; this may take some time...
/usr/local/bin/cyc --debug -c nat.curry -o nat.d.o

Entering debugger...

Considering the following basic fact:
1. nat.sub (S (S Z)) _a  -&#62; (S (S Z))
Is this valid? [y(es)/n(o)/a(bort)] <i>n</i>

Considering the following basic fact:
1. nat.add (S (S Z)) _a  -&#62; (S (S Z))
Is this valid? [y(es)/n(o)/a(bort)] <i>n</i>

Considering the following basic fact:
1. nat.add (S Z) _a  -&#62; (S Z)
Is this valid? [y(es)/n(o)/a(bort)] <i>n</i>

Considering the following basic fact:
1. nat.add Z _a  -&#62; Z
Is this valid? [y(es)/n(o)/a(bort)] <i>n</i>

 ** Function nat.add is incorrect **
 Wrong instance: nat.add Z _a  -&#62; Z

Buggy node found
Debugger exiting
nat&#62; <i>:e nat.curry</i>
nat&#62; <i>:r</i>
/usr/local/bin/cyc -c nat.curry -o nat.o
nat&#62; <i>:^</i>
{X = S (S Z)} Z
More solutions? [Y(es)/n(o)/a(ll)] <i>a</i>
{X = S Z} S Z | {X = Z} S (S Z)
</pre>

<center>Figure 2: Sample session(cont'd)</center>
<a name="fig:sample-session2">
</a>

<div class="p"><!----></div>
 <h2><a name="tth_sEc7">
7</a>&nbsp;&nbsp;Libraries</h2><a name="sec:library">
</a>
In addition to the standard prelude, the Münster Curry compiler is distributed with a subset of the Haskell 98 and Haskell 98 foreign function interface libraries (see&nbsp;[<a href="#PeytonJones03:Haskell98" name="CITEPeytonJones03:Haskell98">Pey03</a>] and [<a href="#Chakravarty03:FFI" name="CITEChakravarty03:FFI">Cha03</a>], respectively), a few modules compatible with PAKCS, and some other library modules, which are specific to the Münster Curry compiler.

<div class="p"><!----></div>
     <h3><a name="tth_sEc7.1">
7.1</a>&nbsp;&nbsp;Prelude</h3><a name="sec:lib-Prelude">
</a>
The <tt>Prelude</tt> implements the data types and functions of appendix B of the Curry report&nbsp;[<a href="#Hanus06:Report" name="CITEHanus06:Report">Han06</a>]. In addition, the following extensions are implemented in the <tt>Prelude</tt> of the Münster Curry compiler.

<ul>
<li> Additional operators <tt>quot</tt> and <tt>rem</tt> for integer division.

<pre>
quot :: Int -&#62; Int -&#62; Int
rem  :: Int -&#62; Int -&#62; Int

</pre>
The semantics of <tt>div</tt>, <tt>mod</tt>, <tt>quot</tt>, and <tt>rem</tt> follows the Haskell 98 report in that <tt>div</tt> and <tt>mod</tt> truncate the quotient toward negative infinity and <tt>quot</tt> and <tt>rem</tt> truncate the quotient toward zero. Fig.&nbsp;<a href="#fig:int-division">3</a> gives an example.

<div class="p"><!----></div>
<a name="tth_fIg3">
</a>   
<center>    
<table border="1">
<tr><td align="center">x </td><td align="center">y </td><td align="center">x `div` y </td><td align="center">x `mod` y </td><td align="center">x `quot` y </td><td align="center">x `rem` y </td></tr>
<tr><td align="center">7 </td><td align="center">3 </td><td align="center">2 </td><td align="center">1 </td><td align="center">2 </td><td align="center">1 </td></tr>
<tr><td align="center">7 </td><td align="center">-3 </td><td align="center">-3 </td><td align="center">-2 </td><td align="center">-2 </td><td align="center">1 </td></tr>
<tr><td align="center">-7 </td><td align="center">3 </td><td align="center">-3 </td><td align="center">2 </td><td align="center">-2 </td><td align="center">-1 </td></tr>
<tr><td align="center">-7 </td><td align="center">-3 </td><td align="center">2 </td><td align="center">-1 </td><td align="center">2 </td><td align="center">-1 </td></tr></table>

    
<center>Figure 3: Integer division operators</center>
    <a name="fig:int-division">
</a>
  </center>

<div class="p"><!----></div>
<br /><br /></li>

<li> Arithmetic operations for floating-point numbers:

<pre>
(+.) :: Float -&#62; Float -&#62; Float
(-.) :: Float -&#62; Float -&#62; Float
(*.) :: Float -&#62; Float -&#62; Float
(/.) :: Float -&#62; Float -&#62; Float
negateFloat :: Float -&#62; Float

</pre>
Note: Unary negation for floating-point numbers can be achieved with either the (prefix) operator <tt>-</tt> or with <tt>-.</tt>, but the latter is deprecated. Conversion between floating-point and integer numbers is achieved with the functions

<pre>
floatFromInt  :: Int -&#62; Float
truncateFloat :: Float -&#62; Int
roundFloat    :: Float -&#62; Int

</pre><br /><br /></li>

<li> Disequality constraints

<pre>
(=/=) :: a -&#62; a -&#62; Success

</pre>
See also Sect.&nbsp;<a href="#sec:ext-disequal">8.1.2</a><br /><br /></li>

<li> The <tt>undefined</tt> function:

<pre>
undefined = failed

</pre><br /><br /></li>

<li> The function

<pre>
ensureGround :: a -&#62; a

</pre>
returns its argument and ensures (lazily) that the normal form of the result is a ground term.<br /><br /></li>

<li> The type

<pre>
type ShowS = String -&#62; String

</pre>
and the functions

<pre>
shows :: a -&#62; ShowS
showChar :: Char -&#62; ShowS
showString :: String -&#62; ShowS
showList :: [a] -&#62; ShowS
showParen :: Bool -&#62; ShowS -&#62; ShowS

</pre>
from the Haskell prelude are defined. Note that <tt>showList</tt> is a polymorphic function and therefore will show strings in list notation, not in string notation.<br /><br /></li>

<li> Additional I/O functions:

<pre>
getContents :: IO String

</pre>
returns the whole standard input as a (lazy) string. The actions <tt>getChar</tt> and <tt>getLine</tt> raise an end-of-file exception after this I/O action has been executed.

<pre>
interact :: (String -&#62; String) -&#62; IO ()
interact f = getContents &#62;&#62;= putStr . f

</pre><br /><br /></li>

<li> I/O exceptions

<pre>
type IOError = String
ioError :: IOError -&#62; IO a
catch :: IO a -&#62; (IOError -&#62; IO a) -&#62; IO a

</pre>
<tt>ioError</tt>&nbsp;<em>ioe</em> raises an I/O exception with error message <em>ioe</em>. <tt>catch</tt>&nbsp;<em>io</em>&nbsp;f executes the I/O action <em>io</em>. If no I/O exception is raised during the evaluation of <em>io</em>, <tt>catch</tt>&nbsp;<em>io</em>&nbsp;f is equivalent to <em>io</em>. Otherwise, the function f is applied to the error message of the exception and its result is returned from <tt>catch</tt>&nbsp;<em>io</em>&nbsp;f.

<div class="p"><!----></div>
Note: The type <tt>IOError</tt> will become an abstract type in future releases for compatibility with Haskell.<br /><br /></li>
</ul>

<div class="p"><!----></div>
     <h3><a name="tth_sEc7.2">
7.2</a>&nbsp;&nbsp;Haskell 98 Library</h3>
The Haskell 98 Library is partially implemented. The following sections describe only the differences with respect to part II of the Haskell 98 Language Report&nbsp;[<a href="#PeytonJones03:Haskell98" name="CITEPeytonJones03:Haskell98">Pey03</a>].

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.1">
7.2.1</a>&nbsp;&nbsp;Ratio</h4>
Not implemented.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.2">
7.2.2</a>&nbsp;&nbsp;Complex</h4>
Not implemented.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.3">
7.2.3</a>&nbsp;&nbsp;Numeric</h4><a name="sec:lib-Numeric">
</a>
All functions except <tt>fromRat</tt> and <tt>floatToDigits</tt> are implemented. However, due to the lack of type classes, they are restricted to the types <tt>Int</tt> and <tt>Float</tt>, respectively.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.4">
7.2.4</a>&nbsp;&nbsp;Ix</h4>
The methods of class <tt>Ix</tt> are available, but only for (pairs of) <tt>Int</tt>.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.5">
7.2.5</a>&nbsp;&nbsp;Array</h4><a name="sec:lib-Array">
</a>
All functions of this module are implemented. However, indices are restricted to type <tt>Int</tt>. As the index type is fixed, the type <tt>Array</tt> has only one argument, viz. the type of the elements, instead of two. Instead of making <tt>Array</tt> an instance of the <tt>Functor</tt> class and implementing the method <tt>fmap</tt>, the module exports the equivalent function

<pre>
amap :: (a-&#62;b) -&#62; Array a -&#62; Array b

</pre>

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.6">
7.2.6</a>&nbsp;&nbsp;List</h4>
This module defines all functions except for the <tt>generic</tt>... variants. The latter are generalization of the prelude functions <tt>take</tt>, <tt>drop</tt>, etc. to arbitrary index types which are instances of the <tt>Integral</tt> class. As only <tt>Int</tt> is available in the Münster Curry compiler, there seems no point in implementing these functions.

<div class="p"><!----></div>
This module also defines all functions that are re-exported from the Haskell prelude but absent from the Curry prelude, in particular the functions <tt>init</tt>, <tt>last</tt>, <tt>scanl</tt>, <tt>scanl1</tt>, <tt>scanr</tt>, <tt>scanr1</tt>, <tt>cycle</tt>, <tt>sum</tt>, <tt>product</tt>, <tt>maximum</tt>, and <tt>minimum</tt>. Due to the lack of type classes, the functions <tt>sum</tt> and <tt>product</tt> are available only for lists with elements of type <tt>Int</tt>.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.7">
7.2.7</a>&nbsp;&nbsp;Maybe</h4>
Fully implemented.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.8">
7.2.8</a>&nbsp;&nbsp;Char</h4>
All functions except <tt>readLitChar</tt>, <tt>showLitChar</tt>, and <tt>lexLitChar</tt> are implemented. There is no support for Unicode or other character sets at present. Reasonable results should be expected only for characters in the ASCII character range, i.e. between <tt>'\NUL'</tt> and <tt>'\DEL'</tt>.

<div class="p"><!----></div>
This module also exports the non-standard functions

<pre>
minChar :: Char
maxChar :: Char

</pre>
which return the smallest and largest character values. These functions are provided as a temporary workaround until the Münster Curry compiler supports type classes.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.9">
7.2.9</a>&nbsp;&nbsp;Monad</h4><a name="sec:lib-Monad">
</a>
All functions except <tt>guard</tt> and <tt>msum</tt> are implemented, but are available only for <tt>IO</tt>. Note that <tt>guard</tt> and <tt>msum</tt> require an instance of <tt>MonadPlus</tt> and <tt>IO</tt> is not an instance of this class in Haskell. This module also defines the functions <tt>sequence</tt>, <tt>sequence_</tt>, <tt>mapM</tt>, and <tt>mapM_</tt> that are re-exported from the Haskell prelude, but defined as <tt>sequenceIO</tt>, <tt>sequenceIO_</tt>, <tt>mapIO</tt>, and <tt>mapIO_</tt> in the Curry prelude.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.10">
7.2.10</a>&nbsp;&nbsp;IO</h4><a name="sec:lib-IO">
</a>
All functions except for <tt>hWaitForInput</tt>, <tt>hReady</tt>, and the <tt>IOError</tt> related functions are implemented. Note that <tt>IOError</tt> is currently equal to <tt>String</tt>. This will change in future releases.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.11">
7.2.11</a>&nbsp;&nbsp;Directory</h4><a name="sec:lib-Directory">
</a>
Implemented except for the type <tt>Permissions</tt> and the related functions <tt>getPermissions</tt> and <tt>setPermissions</tt>. Note that a compatible definition of <tt>Permissions</tt> requires records.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.12">
7.2.12</a>&nbsp;&nbsp;System</h4>
Fully implemented.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.13">
7.2.13</a>&nbsp;&nbsp;Time</h4><a name="sec:lib-Time">
</a>
Only the type <tt>ClockTime</tt> and the function <tt>getClockTime</tt> are implemented at present.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.14">
7.2.14</a>&nbsp;&nbsp;Locale</h4>
Not implemented.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.15">
7.2.15</a>&nbsp;&nbsp;CPUTime</h4>
Not implemented.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.2.16">
7.2.16</a>&nbsp;&nbsp;Random</h4><a name="sec:lib-Random">
</a>
All functions and methods of this module have been implemented, except for the <tt>Read</tt> and <tt>Show</tt> instances of <tt>StdGen</tt>. In addition, due to the lack of type classes only one instance of <tt>RandomGen</tt> and <tt>Random</tt>, namely those for <tt>StdGen</tt> and <tt>Int</tt>, respectively, are available.

<div class="p"><!----></div>
     <h3><a name="tth_sEc7.3">
7.3</a>&nbsp;&nbsp;Foreign Function Interface</h3><a name="sec:lib-ffi">
</a>
A subset of the libraries from the Haskell 98 Foreign Function Interface addendum&nbsp;[<a href="#Chakravarty03:FFI" name="CITEChakravarty03:FFI">Cha03</a>] have been implemented as far as they do not make use of type classes. In the following, only the differences with respect to the addendum are described; for a detailed documentation of the functions and their semantics see Sections&nbsp;5 and&nbsp;6 of&nbsp;[<a href="#Chakravarty03:FFI" name="CITEChakravarty03:FFI">Cha03</a>].

<div class="p"><!----></div>
Note that in the current implementation only arguments and results of types <tt>Bool</tt>, <tt>Char</tt>, <tt>Int</tt>, <tt>Float</tt>, <tt>Ptr</tt>, <tt>FunPtr</tt>, and <tt>StablePtr</tt> can be marshaled. In particular, values of type <tt>Bool</tt> and <tt>Char</tt> are marshaled to <tt>int</tt>, values of type <tt>Int</tt> are marshaled to <tt>long</tt>, values of type <tt>Float</tt> are marshaled to <tt>double</tt> and the pointer types are marshaled to <tt>void *</tt>.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.1">
7.3.1</a>&nbsp;&nbsp;Foreign</h4>
This module exports the function <tt>unsafePerformIO</tt> and all entities from the modules <tt>Bits</tt>, <tt>Ptr</tt>, <tt>ForeignPtr</tt>, <tt>StablePtr</tt>, <tt>MarshalAlloc</tt>, <tt>MarshalError</tt>, and <tt>MarshalUtils</tt>.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.2">
7.3.2</a>&nbsp;&nbsp;Bits</h4>
All member functions of the class <tt>Bits</tt> have been implemented as functions for type <tt>Int</tt>.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.3">
7.3.3</a>&nbsp;&nbsp;Int</h4>
Not yet implemented.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.4">
7.3.4</a>&nbsp;&nbsp;Word</h4>
Not yet implemented.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.5">
7.3.5</a>&nbsp;&nbsp;Ptr</h4>
All types and functions are implemented except for <tt>freeHaskellFunPtr</tt>. This function is not useful without support for callbacks from foreign code into Curry, which is not implemented at present.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.6">
7.3.6</a>&nbsp;&nbsp;ForeignPtr</h4>
All types and functions are implemented except for <tt>mallocForeignPtr</tt>, <tt>mallocForeignPtrArray</tt>, and <tt>mallocForeignPtrArray0</tt>, which require type classes.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.7">
7.3.7</a>&nbsp;&nbsp;StablePtr</h4>
Fully implemented.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.8">
7.3.8</a>&nbsp;&nbsp;Storable</h4>
Not implemented because it does not make sense without type classes. The module <tt>CTypes</tt> offers replacements for the <tt>peek</tt> and <tt>poke</tt> member functions.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.9">
7.3.9</a>&nbsp;&nbsp;MarshalAlloc</h4>
All functions except for <tt>malloc</tt>, <tt>alloc</tt>, and <tt>realloc</tt> are implemented.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.10">
7.3.10</a>&nbsp;&nbsp;MarshalArray</h4>
Not implemented due to lack of type classes.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.11">
7.3.11</a>&nbsp;&nbsp;MarshalError</h4>
Only the result value checks <tt>throwIf</tt>, <tt>throwIf_</tt>, <tt>throwIfNeg</tt>, <tt>throwIfNeg_</tt>, and <tt>throwIfNull</tt> as well as function <tt>void</tt> are implemented. The I/O error related functions have not been implemented because they assume a different error representation.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.12">
7.3.12</a>&nbsp;&nbsp;MarshalUtils</h4>
All functions except for <tt>new</tt> and <tt>with</tt> are implemented. The functions <tt>toBool</tt> and <tt>fromBool</tt> are restricted to <tt>Int</tt> arguments and results, respectively.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.13">
7.3.13</a>&nbsp;&nbsp;CForeign</h4>
This module exports all entities from the modules <tt>CTypes</tt>, <tt>CString</tt>, and <tt>CError</tt>.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.14">
7.3.14</a>&nbsp;&nbsp;CTypes</h4>
This module is considerably different from the Haskell FFI specification in order to work around the lack of type classes. In particular, the types <tt>CChar</tt>, <tt>CInt</tt> etc. are defined as type synonyms. For each type Ct, this module defines functions <tt>alignmentt :: Int</tt>, <tt>sizeOft :: Int</tt>, <tt>peekt :: Ptr Ct -&#62; IO Ct</tt>, and <tt>poket :: Ptr Ct -&#62; Ct -&#62; IO ()</tt>, that return the alignment constraints for values of type <tt>Ct</tt>, the size of values of type <tt>Ct</tt>, read from a memory location with type <tt>Ct</tt>, and write to a memory location with type <tt>Ct</tt>, respectively.

<div class="p"><!----></div>
These functions are also defined for the types <tt>Ptr</tt>, <tt>FunPtr</tt>, and <tt>StablePtr</tt>.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.15">
7.3.15</a>&nbsp;&nbsp;CString</h4>
Only the types <tt>CString</tt>, <tt>CStringLen</tt> and the functions <tt>peekCString</tt>, <tt>peekCStringLen</tt>, <tt>newCString</tt>, <tt>newCStringLen</tt>, <tt>withCString</tt>, and <tt>withCStringLen</tt> are implemented. Note that the Münster Curry compiler does not support Unicode characters at present and therefore all of these functions are restricted to 8-bit characters.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.3.16">
7.3.16</a>&nbsp;&nbsp;CError</h4>

All functions are implemented, but <tt>throwErrnoIfMinus1</tt>, <tt>throwErrnoIfMinus1_</tt>, <tt>throwErrnoIfMinus1Retry</tt>, and <tt>throwErrnoIfMinus1Retry_</tt> are restricted to <tt>IO</tt> actions returning an <tt>Int</tt> result.

<div class="p"><!----></div>
     <h3><a name="tth_sEc7.4">
7.4</a>&nbsp;&nbsp;Library Modules Compatible with PAKCS</h3>

      <h4><a name="tth_sEc7.4.1">
7.4.1</a>&nbsp;&nbsp;AllSolutions</h4><a name="sec:lib-AllSolutions">
</a>
This module provides a collection of functions for obtaining lists of solutions of constraints and expressions. The implementation is based on the I/O action <tt>getSearchTree</tt> proposed in&nbsp;[<a href="#BrasselHanusHuch04:Encapsulating" name="CITEBrasselHanusHuch04:Encapsulating">BBH04</a>]. In contrast to the <tt>try</tt> primitive, this function is able to encapsulate <em>all</em> non-determinism of a computation. Note that the returned search tree is computed lazily. Therefore, <tt>getSearchTree</tt> can be applied safely to expressions that have an infinite number of normal forms.

<pre>
module AllSolutions where

-- data type representing solutions of a goal
--  Fail   no solution
--  Val x  solution x (which is a normal form)
--  Or ts  disjunction of solutions
data SearchTree a = Fail | Val a | Or [SearchTree a]

-- (allValuesD t) returns all solutions of search tree t with a
-- depth-first left-to-right strategy
allValuesD :: SearchTree a -&#62; [a]

-- (allValuesB t) returns all solutions of search tree t with a
-- breadth-first strategy
allValuesB :: SearchTree a -&#62; [a]

-- (getSearchTree x) returns a search tree for x's evaluation, which
-- encapsulates all non-determinism
getSearchTree :: a -&#62; IO (SearchTree a)

-- (getOneSolution g) returns one solution of goal g with an
-- incomplete depth-first left-to-right strategy
getOneSolution :: (a -&#62; Success) -&#62; IO (Maybe a)

-- (getAllSolutions g) returns all solutions of goal g with an
-- incomplete depth-first left-to-right strategy
getAllSolutions :: (a -&#62; Success) -&#62; IO [a]

-- (getOneValue x) returns one normal form of x with an incomplete
-- depth-first left-to-right strategy
getOneValue :: a -&#62; IO (Maybe a)

-- (getAllValues x) returns all normal forms of x with an incomplete
-- depth-first left-to-right strategy
getAllValues :: a -&#62; IO [a]

-- (getAllFailures x g) returns all normal forms of x for which g x has
-- no solution
getAllFailures :: a -&#62; (a -&#62; Success) -&#62; IO [a]

</pre>

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.4.2">
7.4.2</a>&nbsp;&nbsp;Combinatorial</h4><a name="sec:lib-Combinatorial">
</a>
The <tt>Combinatorial</tt> module provides some common non-deterministic operations.

<pre>
module Combinatorial where

-- (permute xs) non-deterministically computes any permutation of xs
permute :: [a] -&#62; [a]

-- (subset xs) non-deterministically computes any sublist of xs
subset :: [a] -&#62; [a]

-- (sizedSubset n xs) non-deterministically computes any sublist of xs
-- with n elements
sizedSubset :: Int -&#62; [a] -&#62; [a]

-- (splitSet xs) non-deterministically splits xs into sublists ys,zs 
-- such that ys and zs have the same elements as xs
splitSet :: [a] -&#62; ([a], [a])

-- (partition xs) non-deterministically computes any partition of xs
partition :: [a] -&#62; [[a]]

</pre>
Note that all functions except <tt>permute</tt> interpret their input lists as multi-sets and there is no guarantee about the order of elements in the result list. For instance, if one of the results of <tt>partition [1,2,3,4]</tt> is the list <tt>[[1],[2,3],[4]]</tt>, no permutation of that list, i.e., neither <tt>[[1],[3,2],[4]]</tt> nor <tt>[[1],[4],[2,3]]</tt>, are returned as well.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.4.3">
7.4.3</a>&nbsp;&nbsp;Float</h4><a name="sec:lib-Float">
</a>
This module contains a lot of useful functions on floating-point numbers.

<pre>
module Float where
infixl 8 ^, ^^, **
infixl 7 *., /.
infixl 6 +., -.

-- (+.), (-.), (*.), (/.) re-exported for PAKCS compatibility
(+.) :: Float -&#62; Float -&#62; Float
(-.) :: Float -&#62; Float -&#62; Float
(*.) :: Float -&#62; Float -&#62; Float
(/.) :: Float -&#62; Float -&#62; Float

-- (&lt;.), (&#62;.), (&lt;=.), (&#62;=.) ordering relations restricted to Floats
(&lt;.) :: Float -&#62; Float -&#62; Bool
(&#62;.) :: Float -&#62; Float -&#62; Bool
(&lt;=.) :: Float -&#62; Float -&#62; Bool
(&#62;=.) :: Float -&#62; Float -&#62; Bool

-- pi = 3.14159265358979323846
pi :: Float

-- Convert an integer to a floating-point number
i2f :: Int -&#62; Float

-- Convert a floating-point number to an integer rounding towards 0
truncate :: Float -&#62; Int

-- Convert a floating-point number to the nearest integer number
round :: Float -&#62; Int

-- (x^n) computes the nth power of x, n must be non-negative
(^) :: Float -&#62; Int -&#62; Float

-- (x^^n) computes the nth power of x, n may be negative
(^^) :: Float -&#62; Int -&#62; Float

-- (x^^y) raises x to power y
(**) :: Float -&#62; Float -&#62; Float

-- (sqrt x) returns the square root of x
sqrt :: Float -&#62; Float

-- (log x) returns the natural logarithm of x
log :: Float -&#62; Float

-- (log10 x) returns the logarithm in base 10 of x
log10 :: Float -&#62; Float

-- (exp x) returns e**x
exp :: Float -&#62; Float

-- trigonometric functions
sin :: Float -&#62; Float
cos :: Float -&#62; Float
tan :: Float -&#62; Float

-- inverse trigonometric functions
asin :: Float -&#62; Float
acos :: Float -&#62; Float
atan :: Float -&#62; Float

-- (atan2 y x) computes the principal value of atan (y/.x) using the
-- signs of both arguments in order to determine the quadrant the result
-- is in; this function is useful for converting rectangular coordinates
-- into polar coordinates
atan2 :: Float -&#62; Float -&#62; Float

-- hyperbolic functions
sinh :: Float -&#62; Float
cosh :: Float -&#62; Float
tanh :: Float -&#62; Float

</pre>
The constant <tt>pi</tt>, and the functions <tt>(^)</tt>, <tt>(^^)</tt>, <tt>(**)</tt>, <tt>log10</tt>, <tt>asin</tt>, <tt>acos</tt>, <tt>atan</tt>, <tt>sinh</tt>, <tt>cosh</tt>, and <tt>tanh</tt> are available only for the Münster Curry compiler.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.4.4">
7.4.4</a>&nbsp;&nbsp;Integer</h4><a name="sec:lib-Integer">
</a>
This module contains useful functions on integer numbers. Note that in contrast to PAKCS,  the Münster Curry compiler supports only fixed width integer numbers. The smallest and largest integer values can be determined with the functions <tt>minInt</tt> and <tt>maxInt</tt>, respectively. Note that these functions are not available in PAKCS and are provided only as a temporary workaround until the Münster Curry compiler supports type classes.

<pre>
module Integer where

-- (minInt) returns the smallest representable integer number 
minInt :: Int

-- (maxInt) returns the largest representable integer number
maxInt :: Int

-- (pow m n) returns the m raised to the power of n
pow :: Int -&#62; Int -&#62; Int

-- (ilog n) returns the floor of the logarithm in base 10 of n
ilog :: Int -&#62; Int

-- (isqrt n) returns the floor of the square root of n
isqrt :: Int -&#62; Int

-- (factorial n) returns the factorial of n
factorial :: Int -&#62; Int

-- (binomial m n) returns m*(m-1)*...*(m-n+1)/n*(n-1)*...*1
-- Fails if n &lt;= 0 or m &#62;= n
binomial :: Int -&#62; Int -&#62; Int

-- (abs n) returns the absolute value of n
abs :: Int -&#62; Int

-- (max3 m n o) returns the maximum of m, n, and o
max3 :: a -&#62; a -&#62; a -&#62; a

-- (min3 m n o) returns the maximum of m, n, and o
min3 :: a -&#62; a -&#62; a -&#62; a

-- (maxlist l) returns the maximum value from list l
maxlist :: [a] -&#62; a

-- (minlist l) returns the minimum value from list l
minlist :: [a] -&#62; a

-- (bitTrunc m n) returns the m least significant bits of n
bitTrunc :: Int -&#62; Int -&#62; Int

-- (bitAnd m n) returns the bitwise and of m and n
bitAnd :: Int -&#62; Int -&#62; Int

-- (bitOr m n) returns the bitwise or of m and n
bitOr :: Int -&#62; Int -&#62; Int

-- (bitXor m n) returns the bitwise exclusive of m and n
bitXor :: Int -&#62; Int -&#62; Int

-- (bitNot n) returns the bitwise complement of n
bitNot :: Int -&#62; Int

-- (even n) returns whether n is even
even :: Int -&#62; Bool

-- (odd n) returns whether n is odd
odd :: Int -&#62; Bool

</pre>

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.4.5">
7.4.5</a>&nbsp;&nbsp;Parser</h4><a name="sec:lib-Parser">
</a>
This module implements functional logic parsing combinators&nbsp;[<a href="#CL99:Parsing" name="CITECL99:Parsing">CL99</a>]. The implementation has been optimized to avoid a quadratic time complexity problem with respect to the length of the input stream, which is present in the original version.

<pre>
module Parser where
infixr 4 &lt;*&#62;
infixr 2 &lt;|&#62;, &lt;||&#62;
infixr 3 &#62;&#62;&#62;

-- Raw parser type
type Parser a = [a] -&#62; [a]

-- Parsers with attributes (a.k.a representations)
type ParserRep a b = a -&#62; Parser b

-- Basic parsers
empty :: Parser a
terminal :: a -&#62; Parser a
satisfy :: (a -&#62; Success) -&#62; ParserRep a a

-- Concatention
(&lt;*&#62;) :: Parser a -&#62; Parser a -&#62; Parser a

-- Alternatation
(&lt;|&#62;) :: Parser a -&#62; Parser a -&#62; Parser a
(&lt;||&#62;) :: ParserRep a b -&#62; ParserRep a b -&#62; ParserRep a b

-- (p &#62;&#62;&#62; x) attaches attribute x to parser p
(&#62;&#62;&#62;) :: Parser a -&#62; b -&#62; ParserRep b a

-- Parsers for p* and p+, respectively
star :: ParserRep a b -&#62; ParserRep [a] b
some :: ParserRep a b -&#62; ParserRep [a] b

-- (parse p xs) non-deterministically succeeds for any valid parse of xs
parse :: Parser a -&#62; [a] -&#62; Success

-- (parseRep p xs) non-deterministically returns any representation
-- of xs computed by parser p
parseRep :: ParserRep a b -&#62; [b] -&#62; a

-- (parseOne p xs) deterministically returns only one representation
-- of xs computed by parser p
parseOne :: ParserRep a b -&#62; [b] -&#62; a

</pre>

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.4.6">
7.4.6</a>&nbsp;&nbsp;Ports</h4><a name="sec:lib-Ports">
</a>
The Münster Curry compiler implements a subset of PAKCS' distributed Curry functionality&nbsp;[<a href="#Hanus99:Ports" name="CITEHanus99:Ports">Han99</a>]. In particular, this module supports internal ports (created with <tt>openPort</tt>) and stream ports, which allow connecting with a subprocess (<tt>openProcessPort</tt>) and a TCP socket (<tt>openSocketConnectPort</tt>), respectively. This functionality is sufficient in order to implement graphical interfaces with PAKCS' <tt>Tk</tt> module, and also for connecting to Web servers and to implement simple Web browsers.

<div class="p"><!----></div>
Distributed ports with arbitrary argument types (<tt>openNamedPort</tt> and <tt>connectPort</tt>) are not supported because their implementation requires type information that is not available in the runtime system of the Münster Curry compiler.

<div class="p"><!----></div>
The function <tt>closePort</tt> is an addition for the Münster Curry compiler, which allows closing a port explicitly. If a port is closed, the message stream will become finite, and a program that sends a message to a closed port fails.

<pre>
module Ports where
data Port a

-- (openPort p ms) creates an internal port p with message stream ms
openPort :: Port a -&#62; [a] -&#62; Success

-- (closePort p) closes port p
closePort :: Port a -&#62; Success

-- (send m p) sends message m to port p
send :: a -&#62; Port a -&#62; Success

-- doSend m p = doSolve (send m p)
doSend :: a -&#62; Port a -&#62; IO ()

-- Stream Port messages
-- SP_Put s: send s followed by a newline to the port
-- SP_GetLine s: instantiates s with the next line read from the port
-- SP_GetChar c: instantiates c with the next character from the port
-- SP_EOF b: instantiates b with True at the end of the input stream
-- SP_Close: closes the port
data SP_Msg
  = SP_Put String
  | SP_GetLine String
  | SP_GetChar Char
  | SP_EOF Bool
  | SP_Close

-- (openProcessPort cmd) runs the shell command cmd as a new subprocess
-- and returns a stream port connected to the input and output channels
-- of that process
openProcessPort :: String -&#62; IO (Port SP_Msg)

-- (openSocketConnectPort p h) returns a stream port connected to the
-- TCP socket with port number p at host h
openSocketConnectPort :: Int -&#62; String -&#62; IO (Port SP_Msg)

-- (choiceSPEP p ms) returns either a line read from the stream port p
-- or the message list ms provided that it is instantiated to a
-- non-variable term
choiceSPEP :: Port SP_Msg -&#62; [a] -&#62; Either String [a]

-- (newObject f s p) applies the function f to an initial state s and
-- the messages received on the port p
-- NB newObject constrains p to a fresh (local) port, so this argument
--    should be a free variable
newObject :: (a -&#62; [b] -&#62; Success) -&#62; a -&#62; Port b -&#62; Success

</pre>
The function <tt>choiceSPEP</tt> is supposed to perform a fair merge between the lines available on the stream port and the message stream. The current implementation, however, always returns the message list unless it is a variable. This may change in a future release of the Münster Curry compiler.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.4.7">
7.4.7</a>&nbsp;&nbsp;Read</h4><a name="sec:lib-Read">
</a>
The module <tt>Read</tt> implements conversions from strings to integer and floating-point numbers. Since its implementation is based on the <tt>Numeric</tt> module, there are some subtle differences with the PAKCS implementation. In particular, all functions fail if the argument string does not represent a valid number. On the other hand, the Münster Curry compiler's <tt>readInt</tt> function recognizes parenthesized numbers and allows spaces between the minus sign and the number. In addition, <tt>readHex</tt> is case insensitive, i.e., <tt>readHex " AbCd "</tt> returns the number 43981. The function <tt>readFloat</tt> is an extension of the Münster Curry compiler.

<pre>
module Read where

readFloat :: String -&#62; Float
readNat   :: String -&#62; Int
readInt   :: String -&#62; Int
readHex   :: String -&#62; Int

</pre>

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.4.8">
7.4.8</a>&nbsp;&nbsp;Socket</h4><a name="sec:lib-Socket">
</a>
The module <tt>Socket</tt> provides an interface to the Unix socket system calls and is compatible with PAKCS. Note that only TCP sockets are supported at present and that there is no support for IPv6.

<pre>
module Socket where

-- Abstract socket type
data Socket

-- Creates a new INET socket. Use socketBind, socketListen, and
-- socketAccept for establishing a server for this socket.
socketINET :: IO Socket

-- Binds a socket to a port number. If the port number is a free
-- variable, the system picks a port number and binds the variable
-- to it.
socketBind :: Socket -&#62; Int -&#62; IO ()

-- Defines the maximum backlog queue of a port.
socketListen :: Socket -&#62; Int -&#62; IO ()

-- Creates a server side socket bound to a port number. If the port
-- number is a free variable, the system picks a port number and binds
-- the variable to it. The implementation currently sets a queue limit
-- of 10 connections.
listenOn :: Int -&#62; IO Socket

-- Returns a connection of a client to a socket. The connection is
-- returned as a pair consisting of a string identifying the client
-- (the format of this string is implementation-dependent) and a handle
-- to a stream communication with the client. The handle is both
-- readable and writable.
socketAccept :: Socket -&#62; IO (String, IO.Handle)

-- Waits until a connection of a client to a socket is available. If
-- no connection is available within the time limit, it returns Nothing,
-- otherwise the connection is returned as a pair consisting of a string
-- identifying the client (the format of this string is
-- implementation-dependent) and a handle to a stream communication with
-- the client.
--
-- Example call: (waitForSocketAccept socket timeout)
-- Parameters:
--   socket - a socket
--   timeout - milliseconds to wait for input (&lt; 0 : no time out)
waitForSocketAccept :: Socket -&#62; Int -&#62; IO (Maybe (String, IO.Handle))

-- Creates a new connection to a Unix socket.
-- Example call: (connectToSocket host port)
-- Parameters:
--   host - the host name of the connection
--   port - the port number of the connection
-- Returns:
--   the handle of the stream (connected to the port port@host)
--   which is both readable and writable
connectToSocket :: String -&#62; Int -&#62; IO IO.Handle

</pre>

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.4.9">
7.4.9</a>&nbsp;&nbsp;Unsafe</h4><a name="sec:lib-Unsafe">
</a>
Do not use this module unless you have really good reasons for doing so and can prove your program to be safe. 

<pre>
module Unsafe where
isVar              :: a -&#62; Bool
spawnConstraint    :: Success -&#62; a -&#62; a
trace              :: String -&#62; a -&#62; a
unsafeInterleaveIO :: IO a -&#62; IO a
unsafePerformIO    :: IO a -&#62; a

</pre>

<div class="p"><!----></div>
     <h3><a name="tth_sEc7.5">
7.5</a>&nbsp;&nbsp;Library Modules Specific to the Münster Curry Compiler</h3>

      <h4><a name="tth_sEc7.5.1">
7.5.1</a>&nbsp;&nbsp;FiniteMap</h4><a name="sec:lib-FiniteMap">
</a>
This module provides an implementation of finite maps based on 2-3 trees.

<pre>
module FiniteMap where

infix 4 `eqFM`, `neqFM`

-- abstract type
data FM a b

-- eqFM, neqFM compare the contents of the maps, not their structure
-- as (==) and (/=) do
eqFM  :: FM a b -&#62; FM a b -&#62; Bool
neqFM :: FM a b -&#62; FM a b -&#62; Bool

-- check for the empty map
nullFM :: FM a b -&#62; Bool

-- the empty map
zeroFM :: FM a b

-- unitFM constructs a map with a single association
unitFM :: a -&#62; b -&#62; FM a b

-- adding and removing elements
addToFM      :: a -&#62; b -&#62; FM a b -&#62; FM a b
deleteFromFM :: a -&#62; FM a b -&#62; FM a b

-- lookupFM x returns the value associated with x, or Nothing
-- if there is no such value
lookupFM :: a -&#62; FM a b -&#62; Maybe b

-- conversion between association lists and finite maps
fromListFM :: [(a, b)] -&#62; FM a b
toListFM   :: FM a b -&#62; [(a, b)]

-- mapFM f fm applies f to values in the map
mapFM :: (a -&#62; b) -&#62; FM c a -&#62; FM c b

showFM :: FM a b -&#62; [Char]
showsFM :: FM a b -&#62; ShowS

</pre>

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.5.2">
7.5.2</a>&nbsp;&nbsp;IOExts</h4><a name="sec:lib-IOExts">
</a>
The module <tt>IOExts</tt> implements a few useful functions for compatibility with Hugs and ghc. The <tt>fixIO</tt> function implements a fix-point operator in the <tt>IO</tt> monad as proposed in&nbsp;[<a href="#EL00:Recursive" name="CITEEL00:Recursive">EL00</a>]. The functions <tt>openFd</tt>, <tt>openProcess</tt>, <tt>pClose</tt>, and <tt>connectTcpSocket</tt> are only available for the Münster Curry compiler.

<pre>
module IOExts where

-- monadic fix-point operator
fixIO :: (a -&#62; IO a) -&#62; IO a

-- functions from Unsafe/Trace re-exported for compatibility
-- with Hugs and ghc
unsafePerformIO    :: IO a -&#62; a
unsafeInterleaveIO :: IO a -&#62; IO a
trace :: String -&#62; a -&#62; a

-- mutable references
data IORef a
newIORef    :: a -&#62; IO (IORef a)
readIORef   :: IORef a -&#62; IO a
writeIORef  :: IORef a -&#62; a -&#62; IO ()
modifyIORef :: IORef a -&#62; (a -&#62; a) -&#62; IO ()

-- mutable arrays
data IOArray a
newIOArray    :: (Int,Int) -&#62; a -&#62; IO (IOArray a)
boundsIOArray :: IOArray a -&#62; (Int,Int)
readIOArray   :: IOArray a -&#62; Int -&#62; IO a
writeIOArray  :: IOArray a -&#62; Int -&#62; a -&#62; IO ()
freezeIOArray :: IOArray a -&#62; IO (Array.Array a)
thawIOArray   :: Array.Array a -&#62; IO (IOArray a)
unsafeFreezeIOArray :: IOArray a -&#62; IO (Array.Array a)
unsafeThawIOArray   :: Array.Array a -&#62; IO (IOArray a)

-- open a file handle for a Unix file descriptor
openFd :: Int -&#62; IO.IOMode -&#62; IO IO.Handle

-- check whether a file handle is connected to a terminal
hIsTerminalDevice :: IO.Handle -&#62; IO Bool

-- run a subprocess
openProcess :: String -&#62; IO.IOMode -&#62; IO IO.Handle
pClose :: IO.Handle -&#62; IO Int

-- connect to a TCP socket
connectTcpSocket :: String -&#62; Int -&#62; IO.IOMode -&#62; IO IO.Handle

-- invoke the garbage collector
performGC :: IO ()

</pre>
The I/O action <tt>openProcess</tt>&nbsp;<em>cmd</em>&nbsp;<em>mode</em> returns a handle that is connected to the standard input and/or output channels of a new subprocess executing the shell command <em>cmd</em>. Note that handles created with <tt>openProcess</tt> use block buffering by default. In order to run an interactive subprocess, you will probably want to change this to line buffering or no buffering at all using <tt>IO.hSetBuffering</tt>.

<div class="p"><!----></div>
The I/O action <tt>pClose</tt> closes a process handle that was opened with <tt>openProcess</tt> and returns the associated process' termination status. The result will be a non-negative number if the process did terminate regularly. In this case, the number is equal to the exit code of the child process. If the child was terminated due to a signal, the result of <tt>pClose</tt> will be the negative signal number. It is an error to apply <tt>pClose</tt> to a handle that was not opened with <tt>openProcess</tt>. However, it is possible to apply <tt>hClose</tt> to a handle opened with <tt>openProcess</tt>. In that case, the calling process is not blocked until the child process is terminated. In addition, it is possible to apply <tt>pClose</tt> and <tt>hClose</tt> more than once to the same handle. All calls to <tt>pClose</tt> will return the same result.

<div class="p"><!----></div>
The I/O action  <tt>connectTcpSocket</tt>&nbsp;h&nbsp;p&nbsp;<em>mode</em> returns a handle that is connected to the TCP socket with port number p at host h. For instance, you can use this function to open a connection to the web server running at <tt>danae.uni-muenster.de</tt>.

<pre>
connectTcpSocket "danae.uni-muenster.de" 80 ReadWriteMode

</pre>
The host h can be specified either as a hostname, which must be resolvable to an internet address on the current machine, or as an IP address in dotted decimal notation, e.g., <tt>127.0.0.1</tt>. At present, <tt>connectTcpSocket</tt> supports only IPv4 addresses. Note that handles created with <tt>connectTcpSocket</tt> use block buffering by default. If this is not appropriate for your application, change the buffering mode with <tt>IO.hSetBuffering</tt>.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.5.3">
7.5.3</a>&nbsp;&nbsp;IOVector</h4>
The implementations of arrays (Sect.&nbsp;<a href="#sec:lib-Array">7.2.5</a>) and mutable arrays (Sect.&nbsp;<a href="#sec:lib-IOExts">7.5.2</a>) are actually based on mutable vectors that use zero-based indexing.

<pre>
module IOVector where
data IOVector a
newIOVector    :: Int -&#62; a -&#62; IO (IOVector a)
copyIOVector   :: IOVector a -&#62; IO (IOVector a)
readIOVector   :: IOVector a -&#62; Int -&#62; IO a
writeIOVector  :: IOVector a -&#62; Int -&#62; a -&#62; IO ()
lengthIOVector :: IOVector a -&#62; Int

</pre>

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.5.4">
7.5.4</a>&nbsp;&nbsp;Lexing</h4><a name="sec:lib-Lexing">
</a>
This module implements lazy lexing combinators based on&nbsp;[<a href="#Chakravarty99:Lexing" name="CITEChakravarty99:Lexing">Cha99</a>].

<pre>
module Lexing where
infixl 4 `star`, `plus`, `quest`
infixl 3 +&#62;
infixl 2 &#62;|&lt;, &#62;||&lt;

type Position = (String, Int, Int)
type LexerState a = (String, Position, a)

type Regexp s t = Lexer s t -&#62; Lexer s t
data Lexer s t
type OneToken s t = (Maybe t, Lexer s t, LexerState s)

type Action t = String -&#62; Position -&#62; Maybe t
type Meta s t = Position -&#62; s -&#62; (Position, s, Maybe (Lexer s t))

-- Regular expressions
epsilon :: Regexp s t
char :: Char -&#62; Regexp s t
(+&#62;) :: Regexp s t -&#62; Regexp s t -&#62; Regexp s t
(&#62;|&lt;) :: Regexp s t -&#62; Regexp s t -&#62; Regexp s t
star :: Regexp s t -&#62; Regexp s t -&#62; Regexp s t
plus :: Regexp s t -&#62; Regexp s t -&#62; Regexp s t
quest :: Regexp s t -&#62; Regexp s t -&#62; Regexp s t

alt :: String -&#62; Regexp s t
string :: String -&#62; Regexp s t
ident :: Regexp s t

-- Lexer actions
lexaction :: Regexp s t -&#62; Action t -&#62; Lexer s t
(&#62;||&lt;) :: Lexer s t -&#62; Lexer s t -&#62; Lexer s t

-- Meta actions
lexmeta :: Regexp s t -&#62; Meta s t -&#62; Lexer s t
ctrlLexer :: Lexer s t

-- Lexing
execLexer :: Lexer s t -&#62; LexerState s -&#62; [t]
lexOne :: Lexer s t -&#62; LexerState s -&#62; OneToken s t

</pre>

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.5.5">
7.5.5</a>&nbsp;&nbsp;NameSupply</h4><a name="sec:lib-NameSupply">
</a>
This module implements unique name supplies based on&nbsp;[<a href="#AugustssonRittriSynek94:Unique" name="CITEAugustssonRittriSynek94:Unique">ARS94</a>]. Note that all functions of this module are referentially transparent, i.e., they will return the same names when applied to the same arguments. For instance,

<pre>
  do
    ns &lt;- initialNameSupply
    print (getName ns,getName ns)

</pre>
will print the pair <tt>(0,0)</tt> and not <tt>(0,1)</tt>.

<pre>
module NameSupply

data NameSupply

-- (initialNameSupply) returns a new name supply
initialNameSupply :: IO NameSupply

-- (splitNameSupply ns) returns two name supplies, whose generated
-- names will be distinct.
splitNameSupply :: NameSupply -&#62; (NameSupply, NameSupply)

-- (listNameSupply ns) returns an infinite list of name supplies, whose
-- generated names will be distinct.
listNameSupply :: NameSupply -&#62; [NameSupply]

type Name = Int

-- (getName ns) returns the unique name of name supply ns.
getName :: NameSupply -&#62; Name

-- (listName ns) returns an infinite list of unique names.
listName :: NameSupply -&#62; [Name]

</pre>

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.5.6">
7.5.6</a>&nbsp;&nbsp;Set</h4><a name="sec:lib-Set">
</a>
This module implements functions on sets. The implementation is based on finite maps (see Sect.&nbsp;<a href="#sec:lib-FiniteMap">7.5.1</a>).

<pre>
module Set where

infixl 8 `addToSet`,`deleteFromSet`
infixl 7 `unionSet`,`intersectionSet`
infixl 6 `diffSet`,`symDiffSet`
infix  4 `eqSet`,`neqSet`,`elemSet`,`notElemSet`,`subsetSet`

-- abstract type
data Set a

-- eqSet, neqSet compare the contents of the sets, not their structure
-- as (==) and (/=) do
eqSet  :: Set a -&#62; Set a -&#62; Bool
neqSet :: Set a -&#62; Set a -&#62; Bool

-- check for the empty set
nullSet :: Set a -&#62; Bool

-- the empty set
zeroSet :: Set a

-- unitSet returns a singleton set
unitSet :: a -&#62; Set a

-- adding and removing elements
addToSet      :: a -&#62; Set a -&#62; Set a
deleteFromSet :: a -&#62; Set a -&#62; Set a

-- elemSet, notElemSet check set membership
elemSet    :: a -&#62; Set a -&#62; Bool
notElemSet :: a -&#62; Set a -&#62; Bool

-- subsetSet xs ys checks whether xs is a subset of or equal to ys
subsetSet :: Set a -&#62; Set a -&#62; Bool

-- common set operations
unionSet        :: Set a -&#62; Set a -&#62; Set a
unionSets       :: [Set a] -&#62; Set a
intersectionSet :: Set a -&#62; Set a -&#62; Set a
diffSet         :: Set a -&#62; Set a -&#62; Set a
symDiffSet      :: Set a -&#62; Set a -&#62; Set a

-- conversion between sets and lists
fromListSet :: [a] -&#62; Set a
toListSet   :: Set a -&#62; [a]

-- mapSet f xs applies f to every element of xs
mapSet :: (a -&#62; b) -&#62; Set a -&#62; Set b

-- domainFM fm returns the set of all keys of the finite map fm
domainFM :: FiniteMap.FM a b -&#62; Set a

showSet :: Set a -&#62; [Char]
showsSet :: Set a -&#62; ShowS

</pre>

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.5.7">
7.5.7</a>&nbsp;&nbsp;Success</h4><a name="sec:lib-Success">
</a>
This module implements some frequently used functions for constraints.

<pre>
module Success(Success, success, (&amp;), (&amp;&#62;),
               module Success) where
infix  0 ==&#62;, &lt;==

-- Computes the concurrent conjunction of a list of constraints
andC :: [Success] -&#62; Success

-- Computes the sequential conjunction of a list of constraints
andS :: [Success] -&#62; Success

-- Is a given predicate satisfied by all elements in a list?
allC :: (a -&#62; Success) -&#62; [a] -&#62; Success

-- (c ==&#62; x) evaluates x if the constraint c is satisfied
(==&#62;) :: Success -&#62; a -&#62; a

-- (x &lt;== c) is equivalent to (c ==&#62; x)
(&lt;==) :: a -&#62; Success -&#62; a

-- (choose xs) non-deterministically chooses one element
-- from the list xs
choose :: [a] -&#62; a

-- (ground e) ensures that e is a ground data term; the argument is
-- evaluated lazily as with Prelude.id
ground :: a -&#62; a

</pre>
Note that <tt>ground</tt> is just an alias for <tt>Prelude.ensureGround</tt>. This definition is present only for backward compatibility and will be removed in a future release.

<div class="p"><!----></div>
      <h4><a name="tth_sEc7.5.8">
7.5.8</a>&nbsp;&nbsp;Trace</h4>
This module exports the impure function <tt>trace</tt>, which is sometimes useful for debugging, although understanding the output that it produces can sometimes be a major challenge unless you are familiar with the intimate details of how programs are executed. 

<div class="p"><!----></div>
Beware that <tt>trace</tt> may change the order of evaluation in your program and, in particular, will suspend the running thread if the first argument is not a ground term.

<pre>
module Trace where
trace :: String -&#62; a -&#62; a

</pre>

<div class="p"><!----></div>
 <h2><a name="tth_sEc8">
8</a>&nbsp;&nbsp;Extensions and Limitations</h2><a name="sec:diffs">
</a>

     <h3><a name="tth_sEc8.1">
8.1</a>&nbsp;&nbsp;Extensions</h3>

      <h4><a name="tth_sEc8.1.1">
8.1.1</a>&nbsp;&nbsp;Polymorphic Integer Literals and Negation</h4><a name="sec:ext-polyliterals">
</a>
The Münster Curry compiler allows integer literals - i.e., numbers which neither contain a decimal point nor an exponent - to be used as floating-point numbers. The type of an integer literal is determined by the context where it occurs and defaults to <tt>Int</tt> if it is not constrained by the code of the module being compiled.

<div class="p"><!----></div>
For instance, the following expressions are accepted by the compiler and have type <tt>Float</tt>.

<pre>
1::Float
17 +. 25
3.1415 /. 2

</pre>

<div class="p"><!----></div>
This ad-hoc polymorphism can also be used in patterns.

<pre>
foo :: [Float] -&#62; Success
foo (0 : 1 : _) = success

bar 0 = Zero
bar 0.5 = Half
bar 1 = One

</pre>
The type of <tt>foo</tt> would be <tt>[Int] -&gt; Success</tt> if the type signature were omitted unless <tt>foo</tt> is applied to a list whose elements are of type <tt>Float</tt>, e.g. <tt>foo [0.0,1.0]</tt>, in the same module. Note that the ad-hoc polymorphism of literals does not extend to functions. Thus, if the type signature for <tt>foo</tt> were omitted, <tt>foo</tt> could be applied either to lists of integers or to lists of floating-point numbers, but not to both.

<div class="p"><!----></div>
The prefix operator <tt>-</tt> can be used for negating integer as well as floating-point numbers in patterns and expressions. Floating-point numbers can also be negated with the operator <tt>-.</tt>, but this is deprecated.

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.2">
8.1.2</a>&nbsp;&nbsp;Disequality Constraints</h4><a name="sec:ext-disequal">
</a>
The Münster Curry compiler supports disequality constraints similar to <i>TOY</i><a href="#tthFtNtAAI" name="tthFrefAAI"><sup>8</sup></a>. The constraint e<sub>1</sub>&nbsp;<tt>=/=</tt>&nbsp;e<sub>2</sub> is satisfied when e<sub>1</sub> and e<sub>2</sub> reduce to different - not necessarily finite - data terms. Disequality constraints for the free variables of a solved goal are printed together with their bindings at the end of evaluation.

<div class="p"><!----></div>
Disequality constraints are never instantiated by the runtime system, which can lead to problems with finite domains. For instance, <tt>x =/= False</tt> is not replaced by <tt>x =:= True</tt>. The runtime system therefore does not notice that the constraint <tt>x =/= False &amp; x =/= True</tt>, where <tt>x</tt> is unbound, cannot be satisfied. This incompleteness can even lead to wrong results. For instance, given the definition

<pre>
f x | y =/= False &amp; y =/= True = x where y free

</pre>
the goal <tt>f "Wrong"</tt> will return the string <tt>"Wrong</tt>", even though <tt>f</tt>'s guard can never be satisfied<a href="#tthFtNtAAJ" name="tthFrefAAJ"><sup>9</sup></a>.

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.3">
8.1.3</a>&nbsp;&nbsp;Existentially Quantified Types</h4><a name="sec:ext-exist">
</a>
The Münster Curry compiler supports existentially quantified data types as proposed by Läufer and Odersky&nbsp;[<a href="#LO94:TOPLAS" name="CITELO94:TOPLAS">LO94</a>]. The syntax of data constructor declarations has been changed to:

<br clear="all" /><table border="0" cellspacing="0" cellpadding="0" width="100%">
<table border="0" cellspacing="0" cellpadding="0">
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<em><span class="roman">ConstrDeclaration</span></em> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
[<tt>forall</tt> <em><span class="roman">TypeVarID</span><sub><span class="roman">1</span></sub></em> ... <em><span class="roman">TypeVarID</span><sub><span class="roman">m</span></sub></em> <tt>.</tt>] </td></tr></table><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
</td></tr></table></td><td nowrap="nowrap" align="left">
<table><tr><td nowrap="nowrap" align="right" colspan="1"><em><span class="roman">DataConstrID</span></em> <em><span class="roman">SimpleTypeExpr</span><sub><span class="roman">1</span></sub></em> ... <em><span class="roman">SimpleTypeExpr</span><sub><span class="roman">n</span></sub></em></td></tr></table><td width="50%"></td></tr></table></table>



where <em>TypeVarID<sub>1</sub></em>, ..., <em>TypeVarID<sub>m</sub></em> are the names of the existentially quantified type variables that can be used in the argument types of the data constructor.<a href="#tthFtNtABA" name="tthFrefABA"><sup>10</sup></a>

<div class="p"><!----></div>
For instance, the declaration

<pre>
data Key a = forall b . Key b (b -&#62; a)

</pre>
introduces a polymorphic type <tt>Key</tt> with the single constructor <tt>Key</tt>. Since the type variable <tt>b</tt> is existentially quantified, it is possible to combine keys for different types in a list:

<pre>
keys = [Key "123" length, Key 2 (+ 1), Key '\ETX' ord]

</pre>

<div class="p"><!----></div>
Existentially quantified types can be used in expressions and patterns just like other data constructors. However, within the scope of a pattern, existentially quantified type variables can be unified only with themselves. Thus, the definition

<pre>
keySum (Key x f) (Key y g) = f x + g y

</pre>
is valid, whereas

<pre>
invalidKeySum (Key x f) (Key y g) = f y + g x

</pre>
is rejected because <tt>f</tt>'s argument type cannot be unified with the type of <tt>y</tt> (and similarly for <tt>g</tt> and <tt>x</tt>). In addition, the compiler reports an error if an existentially quantified type variable escapes the scope in which it is visible as, for instance, in the following definition.

<pre>
badEscape (Key x f) = x

</pre>
Here, the existentially quantified type of the variable <tt>x</tt> would appear in the result of the function <tt>badEscape</tt>.

<div class="p"><!----></div>

<b>Limitations&nbsp;&nbsp;</b> 
The <tt>invalidKeySum</tt> example above indicates that there is a typing issue with the polymorphic operators <tt>(=:=)</tt>, <tt>(=/=)</tt>, and <tt>(==)</tt>. For instance, given the - otherwise useless - data type definition

<pre>
data T = forall a. C a

</pre>
an expression like <tt>C 1 =:= C 'a'</tt> is accepted by the compiler because both arguments have the same type. As a consequence, the implementation must perform runtime type checking when one of the polymorphic operators is applied to an existentially quantified type. Because enough type information is available in the Münster Curry implementation only for non-variable terms, equality and disequality constraints are blocked until the arguments are sufficiently instantiated when applied to existentially quantified data types. Therefore, the expression

<pre>
let x,f free in Key x f =:= Key "abc" length

</pre>
suspends instead of binding the variables <tt>x</tt> and <tt>f</tt>. Note that this restriction does not apply when a variable is unified with a data term with an existentially quantified type, e.g.,

<pre>
let x free in x =:= Key 'a' ord

</pre>

<div class="p"><!----></div>
A similar issue applies to the polymorphic function <tt>compare</tt>. However, since there is no apparent order between terms of different types, this operation simply fails when it is applied to arguments with existentially quantified types. This happens even if the arguments of the constructors happen to have compatible types at runtime as, for instance, in the expression <tt>C 1 `compare`  C 2</tt>. This restriction may be lifted in a future version of the compiler.

<div class="p"><!----></div>

<b>Local Universal Quantification&nbsp;&nbsp;</b>
Local universal quantification of types is not yet supported but planned for a future release.

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.4">
8.1.4</a>&nbsp;&nbsp;Partial Applications in Equality and Disequality Constraints</h4><a name="sec:ext-partial">
</a>
It is possible to use partial applications in equality and disequality constraints; they are handled similar to data constructors. For instance,

<pre>
let x free in x =:= id (const (2 * 2))

</pre>
succeeds and binds <tt>x</tt> to <tt>const 4</tt>. In the current implementation, equality and disequality constraints between two partial applications are restricted to ground terms. Thus,

<pre>
let x free in const x =:= id (const (2 * 2))

</pre>
does not bind <tt>x</tt> to 4, but suspends. This is necessary because equality of partial applications cannot be checked without runtime type checking and the current runtime system provides enough type information only for ground terms, but not for variables. This restriction may be lifted in a future release.

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.5">
8.1.5</a>&nbsp;&nbsp;Fixity Declarations</h4><a name="sec:ext-fixity">
</a>
The Münster Curry compiler accepts fixity declarations within local binding groups. Thus, it is possible to assign fixities to operators defined in such groups. In particular, this allows defining operators with associated fixities for a goal in the interactive top-level (see Sect.&nbsp;<a href="#sec:goals">6.1</a> for the syntax of goals). You can freely mix fixity and value declarations in a group. This is also true for fixity and block declarations at the module level.

<div class="p"><!----></div>
For instance, you can enter the following goal at the interactive prompt:

<pre>
length xs &lt;== xs =:= [1] where xs free; infix 0 &lt;==; x &lt;== c | c = x

</pre>
Note that the operator <tt>&lt;==</tt> is also defined in library module <tt>Success</tt> (Sect.&nbsp;<a href="#sec:lib-Success">7.5.7</a>).

<div class="p"><!----></div>
For compatibility with Haskell, the precedence level in fixity declarations may be omitted, in which case it defaults to 9. Thus, the declarations <tt>infixr 9 .</tt> and <tt>infixr .</tt> are equivalent.

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.6">
8.1.6</a>&nbsp;&nbsp;Lazy Patterns</h4><a name="sec:ext-lazy-pattern">
</a>
The Münster Curry compiler extends pattern syntax further by supporting lazy pattern matching as in Haskell. Lazy patterns are useful for delaying pattern matching of the arguments of a function until those arguments are actually needed. A pattern is turned into a lazy pattern by prefixing it with the character <tt>~</tt>.

<br clear="all" /><table border="0" cellspacing="0" cellpadding="0" width="100%">
<table border="0" cellspacing="0" cellpadding="0">
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 <i>SimplePattern</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
... </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<font face="symbol">|</font
> </td></tr></table></td><td nowrap="nowrap" align="left">
<table><tr><td nowrap="nowrap" align="right" colspan="1">&#126; <i>SimplePattern</i></td></tr></table></td><td width="50%"></td></tr></table></table>




<div class="p"><!----></div>
For instance, consider the two functions

<pre>
f b (x,y) = if b then x * y else 0
g b ~(x,y) = if b then x * y else 0

</pre>
The goal <tt>f False undefined</tt> fails, whereas <tt>g False undefined</tt> evaluates to <tt>0</tt>. Lazy pattern matching can be implemented with the help of a local pattern declaration as well, e.g.,

<pre>
h b xy = if b then x * y else 0 where (x,y) = xy

</pre>
This definition is completely equivalent to <tt>g</tt>. However, lazy patterns are more convenient, especially because they can be nested as shown in the following example.

<pre>
triple ~(a : ~(b : ~(c : _))) = (a,b,c)

</pre>
Note the spaces between the colons and the tildes in the definition. When the function <tt>triple</tt> is used, its argument list is evaluated only when the caller uses the elements of the triple and only as far as necessary. For instance, if only the first element is used, only the first node of the list is evaluated. In pure Curry, one has to use three local declarations in order to write an equivalent function.

<pre>
triple' list = (a,b,c)
  where (a,rest_a) = list
        (b,rest_b) = rest_a
        (c,_) = rest_b

</pre>

<div class="p"><!----></div>
<em>Note that lazy patterns are handled like variables when computing the definitional tree of a function.</em> Thus, one has to be careful not to define functions with overlapping rules. For instance, if <tt>triple</tt> were extended by another equation

<pre>
triple [] = (undefined,undefined,undefined)

</pre>
the evaluation of triple would become non-deterministic. 

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.7">
8.1.7</a>&nbsp;&nbsp;Type Renamings</h4><a name="sec:ext-newtype">
</a>
The Münster Curry compiler supports type renamings with <tt>newtype</tt> declarations as in Haskell.

<br clear="all" /><table border="0" cellspacing="0" cellpadding="0" width="100%">
<table border="0" cellspacing="0" cellpadding="0">
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 <i>BlockDeclaration</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
... </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<font face="symbol">|</font
> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>NewtypeDeclaration</i> </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 <i>NewtypeDeclaration</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<tt>newtype</tt> <i>TypeConstrID</i> <i>TypeVarID</i><sub><span class="roman">1</span></sub> ... <i>TypeVarID</i><sub><span class="roman">n</span></sub> <tt> = </tt> </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
</td></tr></table></td><td nowrap="nowrap" align="left">
<table><tr><td nowrap="nowrap" align="right" colspan="1"><i>DataConstrID</i> <i>SimpleTypeExpr</i></td></tr></table></td><td width="50%"></td></tr></table></table>



I.e., a  type renaming declaration is similar to an algebraic data type declaration with a single unary constructor. However, with respect to the dynamic semantics, a type introduced with a <tt>newtype</tt> declaration is more similar to a type synonym in that the constructor is effectively compiled away. In contrast to a type synonym, a renaming type is not equivalent to the renamed type and cannot be used interchangeably with it. This makes it possible to introduce abstract types without the additional cost of introducing data constructor applications. For instance, a simple stack type can be defined as follows:

<pre>
module Stack(Stack(), empty, push, pop, top, isEmpty) where
newtype Stack a = Stack [a]
empty = Stack []
push x (Stack xs) = Stack (x:xs)
pop (Stack (_:xs)) = Stack xs
top (Stack (x:_)) = x
isEmpty (Stack xs) = null xs

</pre>
In contrast to the definition <tt>type Stack' a = [a]</tt>, it is not possible to apply arbitrary list functions to a stack. E.g., the expression <tt>head stk</tt> is rejected by the compiler if <tt>stk</tt> is of type <tt>Stack </tt>t (for some arbitrary type t), whereas it were accepted for type <tt>Stack' </tt>t. Furthermore, the <tt>Stack</tt> type is exported as an abstract type, i.e., clients in another module cannot create stacks except by using the exported functions <tt>empty</tt> and <tt>push</tt>. Compared to the definition

<pre>
data Stack'' = Stack'' [a]

</pre>
we have that Stack&nbsp;&nbsp;<font face="symbol">^</font
> =  <font face="symbol">^</font
>, whereas Stack"&nbsp;&nbsp;<font face="symbol">^</font
> <font face="symbol">¹</font
> <font face="symbol">^</font
>. The use of a newtype is also slightly more efficient than an algebraic data type with respect to memory usage and execution time.

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.8">
8.1.8</a>&nbsp;&nbsp;Expression Type Signatures</h4><a name="sec:ext-type-sigs">
</a>
Another extension supported by the Münster Curry compiler are expression type signatures:

<br clear="all" /><table border="0" cellspacing="0" cellpadding="0" width="100%">
<table border="0" cellspacing="0" cellpadding="0">
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 <i>Expr</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>Expr</i><font face="symbol">¢</font
> <tt>:</tt><tt>:</tt> <i>TypeExpr</i> </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<font face="symbol">|</font
> </td></tr></table></td><td nowrap="nowrap" align="left">
<table><tr><td nowrap="nowrap" align="right" colspan="1"><i>Expr</i><font face="symbol">¢</font
></td></tr></table></td><td width="50%"></td></tr></table></table>



where the definition of <span class="roman"><i>Expr'</i></span> is the same as for <span class="roman"><i>Expr</i></span> in the Curry report. In addition, the definition of conditional expressions is changed into

<br clear="all" /><table border="0" cellspacing="0" cellpadding="0" width="100%">
<table border="0" cellspacing="0" cellpadding="0">
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>CondExprs</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table><tr><td nowrap="nowrap" align="right" colspan="1"><font face="symbol">|</font
> <i>Expr</i><font face="symbol">¢</font
> <tt> = </tt> <i>Expr</i> <span class="roman">[</span><i>CondExprs</i><span class="roman">]</span></td></tr></table></td><td width="50%"></td></tr></table></table>



Therefore, in order to use an expression type signature in the guard of a conditional expression, it has to be enclosed in parentheses as in the following example:

<pre>
rId b x | (b :: Bool) = x

</pre>
This restriction was made for compatibility with Haskell.

<div class="p"><!----></div>
Until the Münster Curry compiler supports type classes, expression type signatures are mostly useful in order to specify the type of numeric literals (see Sect.&nbsp;<a href="#sec:ext-polyliterals">8.1.1</a>). They may be helpful for locating type errors, too.

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.9">
8.1.9</a>&nbsp;&nbsp;Constraint Guards in Case Expressions</h4><a name="sec:ext-case">
</a>
Besides boolean guard expressions, the Münster Curry compiler also allows constraint guards in case expressions. Similar to function rules, only a single constraint guard is allowed for each alternative. A guarded alternative p <span class="roman"><tt>|</tt></span> c <span class="roman"><tt>-&#62;</tt></span> e, where c is a constraint, is considered syntactic sugar for the alternative p <span class="roman"><tt>-&#62;</tt></span> c <span class="roman"><tt>&amp;&#62;</tt></span> e. This means that the case expression does not fall through to the next alternative if the constraint fails. Instead, the whole case expression fails in this case. Thus, the case expression

<pre>
case (1,3) of
  (x,y) | (x &lt; 0) =:= True -&#62; (0,y)
  xy -&#62; xy

</pre>
fails, in contrast to

<pre>
case (1,3) of
  (x,y) | (x &lt; 0) -&#62; (0,y)
  xy -&#62; xy

</pre>
which evaluates to the pair <tt>(1,3)</tt>.

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.10">
8.1.10</a>&nbsp;&nbsp;Constructor Operators</h4><a name="sec:ext-infix">
</a>
The Münster Curry compiler allows defining and using infix constructor operators other than the predefined constructor <tt>(:)</tt>. For instance, you can define an algebraic data type <tt>Assoc</tt>, which represents an association between two values, as follows:

<pre>
data Assoc a b = a := b

</pre>
Such constructors can be used in patterns in the expected way. For instance, the following function exchanges the roles of both arguments.

<pre>
flipAssoc (x := y) = y := x

</pre>
At any time, it is possible to enclose a constructor operator in parentheses in order to use it in prefix form and to enclose a constructor identifier in backquotes in order to use it in infix position. Fixity declarations apply to constructors occurring in a pattern as well.

<div class="p"><!----></div>
In order to accommodate constructor operators, the following rules of the Curry syntax are changed.

<br clear="all" /><table border="0" cellspacing="0" cellpadding="0" width="100%">
<table border="0" cellspacing="0" cellpadding="0">
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 <i>ConstrDeclaration</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>DataConstrID</i> <i>SimpleTypeExpr</i><sub>1</sub> ... <i>SimpleTypeExpr</i><sub><i>n</i></sub> </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<font face="symbol">|</font
> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>TypeAppl</i> <i>InfixConID</i> <i>TypeAppl</i> </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 <i>Pattern</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>QDataConstrID</i> <i>Pattern</i><sub>1</sub> ... <i>Pattern</i><sub><i>n</i></sub> <span class="roman">[</span><i>QInfixConID</i> <i>Pattern</i><span class="roman">]</span> </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<font face="symbol">|</font
> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>SimplePattern</i> <span class="roman">[</span><i>QInfixConID</i> <i>Pattern</i><span class="roman">]</span> </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 <i>QInfixConID</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<span class="roman">[</span><i>ModuleID</i> <tt>.</tt><span class="roman">]</span> <i>InfixConID</i> </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<font face="symbol">|</font
> </td></tr></table></td><td nowrap="nowrap" align="left">
<table><tr><td nowrap="nowrap" align="right" colspan="1"><tt>:</tt></td></tr></table></td><td width="50%"></td></tr></table></table>



The Münster Curry compiler does not impose any restrictions on the names of constructor operators - i.e., <i>InfixConID</i> = <i>InfixOpID</i> - but it is recommended to use only names starting with a colon for infix constructors. This convention is compatible with Haskell.

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.11">
8.1.11</a>&nbsp;&nbsp;No Automatic Eta-expansion of Function Definitions</h4><a name="sec:ext-eta">
</a>
Similar to PAKCS version 1.8 and <i>TOY</i>, the arity of a function is determined by the number of arguments in its declaration rather than by its type as the Curry report implies. For instance, the declaration <tt>sum = foldr (+) 0</tt> defines <tt>sum</tt> as a nullary function even though it has type <tt>[Int] -&#62; Int</tt>.

<div class="p"><!----></div>
Note that <font face="symbol">h</font
>-expansion can change the semantics of a program. Consider the two programs

<center><tt>
  
<table>
<tr><td>zero 0 = success </td><td>zero 0 = success </td></tr>
<tr><td>one 1 = success </td><td>one 1 = success </td></tr>
<tr><td>fcoin = zero </td><td>fcoin x = zero x </td></tr>
<tr><td>fcoin = one </td><td>fcoin x = one x </td></tr>
<tr><td>goal f | f x &amp; f y = x + y </td><td>goal f | f x &amp; f y = x + y </td></tr>
<tr><td>&nbsp;&nbsp;&nbsp; where x,y free </td><td>&nbsp;&nbsp;&nbsp; where x,y free </td></tr></table>

</tt></center>
For the left program, <tt>goal fcoin</tt> has just two solutions, namely <tt>0</tt> and <tt>2</tt>, whereas for the right program, which is the <font face="symbol">h</font
>-expanded version of the left program, <tt>goal fcoin</tt> has three different solutions, namely <tt>0</tt>, <tt>1</tt>, and <tt>2</tt>.

<div class="p"><!----></div>
Nevertheless, the compiler performs <font face="symbol">h</font
>-expansion as an optimization when it can prove that the semantics of the program remains unaffected. In particular, function definitions with only a single equation and whose right hand side is a non-expansive expression (cf.&nbsp;Sect.&nbsp;<a href="#sec:poly-let">8.1.13</a>) are always <font face="symbol">h</font
>-expanded.

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.12">
8.1.12</a>&nbsp;&nbsp;Generalized Function Left-Hand Sides</h4><a name="sec:ext-curried-lhs">
</a>
Similar to Haskell, the Münster Curry compiler allows using a curried style for the left-hand side of a function rule. This is very convenient for defining higher-order operator symbols. For instance, the curried syntax can be used in the definition of the function composition operator <tt>(.)</tt>.

<pre>
(f . g) x = f (g x)

</pre>
The definition of <span class="roman"><i>FunLHS</i></span> in the Curry syntax is changed as follows.

<br clear="all" /><table border="0" width="100%"><tr><td>
<table align="center" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
 </td><td nowrap="nowrap" align="center">
<table>
<tr><td align="right"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
<i>FunLHS</i> </td></tr></table></td><td align="center"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
:: = </td></tr></table></td><td><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
<i>FunctionName</i>  | <i>FunLHS</i><sub>1</sub> </td></tr></table></td></tr>
<tr><td align="right"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
<i>FunLHS</i><sub>1</sub>  </td></tr></table></td><td align="center"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
:: = </td></tr></table></td><td><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
<i>FunctionName</i> <i>SimplePattern</i><sub>1</sub> ... <i>SimplePattern</i><sub><i>n</i></sub> </td></tr></table></td><td align="right"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
(n <font face="symbol">³</font
> 1) </td></tr></table></td></tr>
<tr><td align="right"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
</td></tr></table></td><td align="center"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
<font face="symbol">|</font
> </td></tr></table></td><td><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
<i>SimplePattern</i> <i>InfixOpID</i> <i>SimplePattern</i> </td></tr></table></td></tr>
<tr><td align="right"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
</td></tr></table></td><td align="center"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
<font face="symbol">|</font
> </td></tr></table></td><td><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
<tt>(</tt> <i>FunLHS</i><sub>1</sub> <tt>)</tt> <i>SimplePattern</i><sub>1</sub> ... <i>SimplePattern</i><sub><i>n</i></sub> </td></tr></table></td><td align="right"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
(n <font face="symbol">³</font
> 1) </td></tr></table></td></tr></table>
</td><td nowrap="nowrap" align="center">
</td></tr></table>
</td></tr></table>



<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.13">
8.1.13</a>&nbsp;&nbsp;Polymorphic Generalization of Let-Bound Variables</h4><a name="sec:poly-let">
</a>
The compiler implements a variant of ML's value restriction that allows polymorphic generalization of let-bound variables if the bound expression is a non-expansive expression. The class of non-expansive expressions is defined inductively as the set of expressions built from

<ul>
<li> literals,<br /><br /></li>

<li> local variables,<br /><br /></li>

<li> applications of a constructor with arity n to at most n non-expansive argument expressions,<br /><br /></li>

<li> applications of a function or <font face="symbol">l</font
>-expression with arity n to at most n<font face="symbol">-</font
>1 non-expansive argument expressions, and<br /><br /></li>

<li> let-expressions which comprise only function declarations and variable declarations of the form x=e where e is a non-expansive expression and whose body is also a non-expansive expression.<br /><br /></li>
</ul>

<div class="p"><!----></div>
With this extension, the compiler accepts all of the following definitions

<pre>
f1 = (1:nil, 'a':nil) where nil = []
f2 = [z (), z False] where z = const 0
f3 = last (last ["Curry"])
  where last = \xs -&#62; let y,ys free in (xs =:= ys++[y]) &amp;&#62; y

</pre>
where the types <font face="symbol">"</font
><font face="symbol">a</font
>. [<font face="symbol">a</font
>], <font face="symbol">"</font
><font face="symbol">a</font
>. <font face="symbol">a</font
><font face="symbol">®</font
>[Int], and <font face="symbol">"</font
><font face="symbol">a</font
>. [<font face="symbol">a</font
>]<font face="symbol">®</font
><font face="symbol">a</font
> are inferred for the local variables <tt>nil</tt>, <tt>z</tt>, and <tt>last</tt>, respectively. On the other hand, the definition

<pre>
f4 = (1:nil, 'a':nil) where nil = id []

</pre>
is still rejected because <tt>id []</tt> is an expansive expression and therefore <tt>nil</tt>'s type is not generalized.

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.14">
8.1.14</a>&nbsp;&nbsp;Mutually Recursive Variable Bindings</h4>
The compiler allows mutually recursive variable bindings; for instance,

<pre>
let { xs = 0:ys; ys = 1:xs } in xs

</pre>
returns an infinite list of alternating 0's and 1's. Each right hand side expression is evaluated only once. Therefore, given the definition

<pre>
coin = 0
coin = 1

</pre>
the expression

<pre>
let xs = coin : xs in xs

</pre>
returns either an infinite list of 0's or an infinite list of 1's.

<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.15">
8.1.15</a>&nbsp;&nbsp;Extended Import/Export Specifications</h4>
As in Haskell it is possible to import or export only some of the constructors of a data type by specifying the list of visible constructors explicitly. For instance, the import declaration <tt>import Prelude(Bool(True))</tt> brings the constructor <tt>True</tt> into scope but not <tt>False</tt>.

<div class="p"><!----></div>
The syntax is as follows

<br clear="all" /><table border="0" cellspacing="0" cellpadding="0" width="100%">
<table border="0" cellspacing="0" cellpadding="0">
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 <i>Export</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
... </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<font face="symbol">|</font
> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>QTypeConstrID</i> <span class="roman">(</span><i>DataConstrID</i><sub>1</sub> <tt>,</tt> ... <tt>,</tt> <i>DataConstrID</i><sub><i>n</i></sub><span class="roman">)</span>  </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 <i>Import</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
... </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<font face="symbol">|</font
> </td></tr></table></td><td nowrap="nowrap" align="left">
<table><tr><td nowrap="nowrap" align="right" colspan="1"><i>TypeConstrID</i> <span class="roman">(</span><i>DataConstrID</i><sub>1</sub> <tt>,</tt> ... <tt>,</tt> <i>DataConstrID</i><sub><i>n</i></sub><span class="roman">)</span> </td></tr></table></td><td width="50%"></td></tr></table></table>




<div class="p"><!----></div>
      <h4><a name="tth_sEc8.1.16">
8.1.16</a>&nbsp;&nbsp;Foreign Function Interface</h4><a name="sec:ext-ffi">
</a>
The Münster Curry compiler supports a subset of the Haskell foreign function interface&nbsp;[<a href="#Chakravarty03:FFI" name="CITEChakravarty03:FFI">Cha03</a>]. The current implementation allows only importing foreign functions and supports the calling conventions <tt>primitive</tt>, <tt>ccall</tt>, and <tt>rawcall</tt>. The calling convention <tt>primitive</tt> is a non-portable addition of the Münster Curry compiler and must be used only for C functions that use the calling conventions of the compiler's runtime system. Argument types of functions using the <tt>ccall</tt> calling convention are restricted to the types <tt>Bool</tt>, <tt>Char</tt>, <tt>Int</tt>, <tt>Float</tt>, <tt>Ptr</tt>&nbsp;t, <tt>FunPtr</tt>&nbsp;t, and <tt>StablePtr</tt>&nbsp;t in this release where t is an arbitrary type. In addition to these, types of the form <tt>IO</tt>&nbsp;t can be used as result types, where t must be either <tt>()</tt> or a valid argument type. The non-standard calling convention <tt>rawcall</tt> is similar to <tt>ccall</tt> except that no marshaling takes place. Thus all arguments of the foreign function must have type <tt>Node *</tt> and its result type must be either <tt>Node *</tt> or <tt>void</tt>.

<div class="p"><!----></div>
The syntax of foreign function declarations is<a href="#tthFtNtABB" name="tthFrefABB"><sup>11</sup></a>

<br clear="all" /><table border="0" cellspacing="0" cellpadding="0" width="100%">
<table border="0" cellspacing="0" cellpadding="0">
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>ForeignDecl</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<tt>foreign</tt> </td><td nowrap="nowrap" align="center">
<table>
<tr><td><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
<tt>import</tt> <i>CallConv</i> <span class="roman">[</span><i>Safety</i><span class="roman">]</span> <span class="roman">[</span><i>ImpEnt</i><span class="roman">]</span> </td></tr></table></td></tr>
<tr><td><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="center">
<i>FunctionName</i> <tt>:</tt><tt>:</tt> <i>TypeExpr</i> </td></tr></table></td></tr></table>
</td><td nowrap="nowrap" align="center">
 </td></tr></table><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>CallConv</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<tt>primitive</tt>  | <tt>ccall</tt>  | <tt>rawcall</tt> </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>Safety</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table><tr><td nowrap="nowrap" align="right" colspan="1"><tt>safe</tt>  | <tt>unsafe</tt></td></tr></table></td><td width="50%"></td></tr></table></table>



At present, the safety level is ignored and present only for compatibility with the Haskell Foreign Function Interface addendum. The syntax of import entity specifications depends on the calling convention being used. For functions using the <tt>primitive</tt> calling convention the string is used as the name of the foreign function. Name mangling is applied to this name and therefore, there are no restrictions on valid names. For functions using the <tt>ccall</tt> calling convention, this string must comply with the following grammar.

<br clear="all" /><table border="0" cellspacing="0" cellpadding="0" width="100%">
<table border="0" cellspacing="0" cellpadding="0">
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
<i>ImpEnt</i> </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
:: = </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
" &nbsp;&nbsp;[<tt>static</tt>] &nbsp;&nbsp;[<i>chname</i>] &nbsp;&nbsp;[<tt>&amp;</tt>] &nbsp;&nbsp;[<i>cident</i>] &nbsp;&nbsp;" </td></tr></table></td><td width="50%"></td></tr>
 <tr><td width="50%"></td><td nowrap="nowrap" align="right" colspan="1"><table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 </td></tr></table></td><td nowrap="nowrap" align="left">
<table border="0" cellspacing="0" cellpadding="0"><tr><td nowrap="nowrap" align="left">
 | </td></tr></table></td><td nowrap="nowrap" align="left">
<table><tr><td nowrap="nowrap" align="right" colspan="1">" &nbsp;&nbsp;[<tt>dynamic</tt>] &nbsp;&nbsp;"</td></tr></table></td><td width="50%"></td></tr></table></table>



The optional <span class="roman"><i>chname</i></span>, which must end with the suffix <tt>.h</tt> in order to distinguish it from a <em>cident</em>, allows including a C header file into the compiled code. Besides providing a prototype for the foreign function, this makes it possible to provide foreign function declarations for C macros.

<div class="p"><!----></div>
The optional <span class="roman"><i>cident</i></span> is the name of the foreign C function and must conform to the rules for valid C identifiers. If this name is omitted, the compiler assumes that the name of the foreign function is equal to that of the Curry function, which must be a valid C identifier in that case.

<div class="p"><!----></div>
The optional <tt>&amp;</tt> modifier imports the address of the entity denoted by <span class="roman"><i>cident</i></span> or the Curry name of the declaration if <span class="roman"><i>cident</i></span> is omitted. The type of foreign address imports is restricted to <tt>Ptr</tt>&nbsp;t and <tt>FunPtr</tt>&nbsp;t, where t is an arbitrary type.

<div class="p"><!----></div>
The import entity specification <tt>dynamic</tt> defines a wrapper that allows calling a foreign function value with type <tt>FunPtr</tt>&nbsp;t. The type of a dynamic wrapper must have the form FunPtr&nbsp;t <font face="symbol">®</font
> t where t is a valid foreign function type.

<div class="p"><!----></div>
Arguments of type <tt>Bool</tt>, <tt>Char</tt>, and <tt>Int</tt> are converted to <tt>int</tt>, arguments of type <tt>Float</tt> are converted to <tt>double</tt>, and arguments of type <tt>Ptr</tt>&nbsp;t, <tt>FunPtr</tt>&nbsp;t, and <tt>StablePtr</tt>&nbsp;t are converted to <tt>void *</tt>. An inverse conversion is applied to function results. If a function is declared with result type <tt>IO ()</tt>, the function's result (if any) is ignored and the Curry function always returns the constant <tt>()</tt>.

<div class="p"><!----></div>
The following declarations import the <tt>sin</tt> function from the standard C library, the global <tt>errno</tt> variable, and provide a wrapper for calling C function pointers of functions that take a <tt>long</tt> value and return a boolean result.

<pre>
foreign import ccall "math.h" sin :: Float -&#62; Float
foreign import ccall "errno.h &amp;" errno :: Ptr Int
foreign import ccall "dynamic"
        callC :: FunPtr (Int -&#62; Bool) -&#62; Int -&#62; Bool

</pre>

<div class="p"><!----></div>
     <h3><a name="tth_sEc8.2">
8.2</a>&nbsp;&nbsp;Limitiations and Incompatibilities</h3><a name="sec:limitations">
</a>

<ul>
<li> The identifiers <tt>newtype</tt> and <tt>foreign</tt> and the operator symbol <tt>~</tt> are keywords and cannot be used as variable, function or (type) constructor names.<br /><br /></li>

<li> The range of <tt>Int</tt> is limited to <font face="symbol">-</font
>2<sup>31</sup> <font face="symbol">¼</font
>2<sup>31</sup><font face="symbol">-</font
>1 on 32-bit machines and <font face="symbol">-</font
>2<sup>63</sup> <font face="symbol">¼</font
>2<sup>63</sup><font face="symbol">-</font
>1 on 64-bit machines. Overflow is not detected.<br /><br /></li>

<li> The operators <tt>div</tt> and <tt>mod</tt> truncate the quotient toward negative infinity, i.e., <tt>(-7) `div` 3</tt> yields <tt>-3</tt> and <tt>(-7) `mod` 3</tt> yields <tt>2</tt>. This semantics is compatible with the Haskell 98 report, but not with older releases of the Münster Curry compiler nor with PAKCS. Use <tt>quot</tt> and <tt>rem</tt> for division that truncates toward zero. Note that the semantics of <tt>div</tt> and <tt>mod</tt> for negative numbers is not specified in the Curry report.<br /><br /></li>

<li> A type, data constructor, or top-level function with the same name as an imported entity of the same kind can only be accessed using its qualified name. E.g., the compiler will report an error for the module

<pre>
module Main where
length = foldr (const (1 +)) 0
main = print (length [])

</pre>
to the effect that the identifier <tt>length</tt> in the body of <tt>main</tt> is ambiguous. In order to compile the module, either the <tt>length</tt> function from the prelude must be hidden by adding the import declaration

<pre>
import Prelude hiding(length)

</pre>
or <tt>length</tt> must be qualified, i.e.,

<pre>
main = print (Main.length [])

</pre>
This incompatibility, which is consistent with the Haskell 98 module system, is present because it allows better detection of unintentional name conflicts between different modules, which usually are an indication of code duplication.<br /><br /></li>

<li> A hiding clause in an import declaration effects the qualified name in addition to the unqualified name. Thus, a hiding specification makes the identifier inaccessible if not brought into scope with another import declaration. This behavior differs from the Curry report, but is consistent with the (revised) Haskell 98 language definition&nbsp;[<a href="#PeytonJones03:Haskell98" name="CITEPeytonJones03:Haskell98">Pey03</a>] and was chosen in order to effectively control the qualified name space inside a module. Note that the qualified names are relevant for deciding which data constructors of a type are exported.<br /><br /></li>

<li> Pattern matching in list comprehensions is always performed rigidly. For instance, the evaluation of <tt>[x | True &lt;- [x]]</tt> suspends when <tt>x</tt> is an unbound variable. When following the report strictly, this expression should evaluate non-deterministically to <tt>[True]</tt> and <tt>[False]</tt>. However, note that <tt>[x | 0 &lt;- [x]]</tt> does suspend even according to the Curry report.<br /><br /></li>

<li> There is a conflict between sharing of non-local variables and encapsulated search. For instance, for the program

<pre>
coin = 0
coin = 1
main = findall (\x -&#62; x =:= c) ++ findall (\x -&#62; x =:= c)
  where c = coin

</pre>
<tt>main</tt> can evaluate either to the list <tt>[0,1,0,1]</tt> - i.e., sharing of the variable <tt>c</tt> is lost - or non-deterministically to the lists <tt>[0,0]</tt> and <tt>[1,1]</tt> - i.e., encapsulation is lost. The former choice is called <em>strong encapsulation</em> in&nbsp;[<a href="#BrasselHanusHuch04:Encapsulating" name="CITEBrasselHanusHuch04:Encapsulating">BBH04</a>], the latter <em>weak encapsulation</em>. The Münster Curry compiler's <tt>try</tt> implementation uses weak encapsulation, i.e., it preserves sharing of non-local variables, because the results of an expression depend on the order of evaluation when using strong encapsulation. For instance, depending on whether <tt>(+)</tt> evaluates its arguments from left to right or from right to left, the expression

<pre>
let c = coin in c + foldr (+) 0 (findall (\x -&#62; x =:= c))

</pre>
will either have results <tt>0</tt> and <tt>2</tt>, or <tt>1</tt> and <tt>2</tt> with strong encapsulation, whereas it has results <tt>0</tt> and <tt>2</tt> regardless of evaluation order with weak encapsulation.

<div class="p"><!----></div>
The downside of weak encapsulation is that some non-determinism cannot be encapsulated. In particular, you cannot define a function <tt>allValues :: a -&#62; [a]</tt> that returns all normal forms to which the argument expression can be reduced. You also have to be careful with partial applications as search goals. E.g., in <tt>findall (=:= coin)</tt>, the non-deterministic function <tt>coin</tt> is evaluated outside of the encapsulated search because this expression is equivalent to <tt>let c = coin in findall (\x -&#62; x =:= c)</tt>. In order to encapsulate the non-deterministic function <tt>coin</tt> use <tt>findall (\x -&#62; x =:= coin)</tt> instead. The general rule of thumb is that for the Münster Curry compiler the result of an expression is the same as would be with an eager evaluation strategy modulo those subexpressions that were not evaluated at all.

<div class="p"><!----></div>
Because strong encapsulation is nevertheless useful, the Münster Curry compiler also offers an alternative interface to encapsulated search based on the I/O action <tt>getSearchTree</tt> in module <tt>AllSolutions</tt> (see Sect.&nbsp;<a href="#sec:lib-AllSolutions">7.4.1</a>).<br /><br /></li>
</ul>

<div class="p"><!----></div>
     <h3><a name="tth_sEc8.3">
8.3</a>&nbsp;&nbsp;Known Bugs</h3>

<ul>
<li> When the compiler is built with hbc or nhc98, an out of range error is reported for numeric character escape sequences with character codes greater than 255.<br /><br /></li>

<li> The implementation of disequality constraints is incomplete. For instance, the goal <tt>x =/= Just undefined</tt> fails even though it has a solution for <tt>x</tt>=<tt>Nothing</tt>, as can be observed with the goal <tt>x =:= Nothing &amp; x =/= Just undefined</tt>. This problem is expected to be removed in a future release.<br /><br /></li>

<li> The compiler fails or enters an infinite loop for programs which contain certain kinds of cyclic variable definitions, e.g.,

<pre>
bug   = x where x = x
cycle = x where { x = y; y = x }

</pre><br /><br /></li>

<li> The <tt>send</tt> constraint in the <tt>Ports</tt> library (Sect.&nbsp;<a href="#sec:lib-Ports">7.4.6</a>) may loose messages because of unintended sharing. For instance, <tt>foldr (&amp;) success (replicate 5 (send "Hello" p))</tt> sends the string <tt>"Hello"</tt> only once to the port and not five times.<br /><br /></li>

<li> Equality and disequality constraints may lead to segmentation faults when applied to cyclic data structures, e.g. in the goal <tt>xs =:= repeat 'x' where repeat x = let xs = x:xs in xs</tt>. Note that the prelude's definition of <tt>repeat</tt> does not create cyclic data structures.<br /><br /></li>

<li> It is not possible to debug programs that involve cyclic data structures.<br /><br /></li>

<li> The basic facts shown by the debugger can be way too complex to understand and there is no provision to omit inner terms of deeply nested data terms.<br /><br /></li>

<li> The debugger has insane memory demands for some non-trivial programs and goals.<br /><br /></li>

<li> The compiler may generate invalid interfaces if type constructors are used that start with a lower case letter, which is followed by a - possibly empty - sequence of digits.<br /><br /></li>

<li> It is not possible to define dynamic foreign function wrappers for functions taking <tt>int</tt> arguments and returning <tt>int</tt> results. This is not much of a problem on 32-bit architectures where <tt>int</tt> and <tt>long</tt> are equivalent, but matters on 64-bit machines. As a workaround, you have to define additional wrappers that promote the <tt>long</tt> arguments to <tt>int</tt> and vice versa for the result. This issue will be addressed in a future release that has support for type classes.<br /><br /></li>
</ul>

<div class="p"><!----></div>
 <h2><a name="tth_sEc9">
9</a>&nbsp;&nbsp;Common Problems and Solutions</h2>

<ul>
<li> <i>When compiling and linking my program with <tt>cyc</tt> or <tt>cymake</tt>, the compiler reports an error "<tt>line 1.1: main is undefined</tt>".</i> <br />
This error means that the compiler was unable to determine the main function of your program.  In general, this error is reported when your program's main module does not define and export a function <tt>main</tt>. However, this error is also reported when you link a program with <tt>cyc</tt> from object files and did not specify the main module with the <tt>-M</tt> option (see Sect.&nbsp;<a href="#sec:linking">3.4</a>).<br /><br /></li>

<li> <i>The compiler complains about my function ... being already defined.</i> <br />
Curry requires all rules of a function to be adjacent.<br /><br /></li>

<li> <i>The compiler complains about an "unexpected token qualified operator `<tt>m..</tt>'" in the expression <tt>[m..n]</tt>.</i> <br />
The problem here is that the parser tokenizes the expression into the four tokens "[", "m..", "n", and "]", but not into "[", "m", "..", "n", and "]" as you might expect. This is due to the fact that Curry  - in contrast to Haskell - does not require module names to start with a capital letter, but we want to allow qualified uses of the dot operator (e.g., <tt>Prelude..</tt>).<a href="#tthFtNtABC" name="tthFrefABC"><sup>12</sup></a> In order to avoid this error, always use spaces before and after the <tt>..</tt> token. See also the thread "Slight change of the Curry syntax" in the Curry mailing list.<br /><br /></li>

<li> <i>My program fails with a stack or trail overflow or complains that there is not enough free memory after a garbage collection.</i> <br />
First, make sure that your program did not enter an infinite loop.

<div class="p"><!----></div>
If this is not the case, you can rerun the program with larger stack, trail, and heap sizes by passing the options <tt>-k</tt><span class="roman"><i>size</i></span>, <tt>-t</tt><span class="roman"><i>size</i></span>, and <tt>-h</tt><span class="roman"><i>size</i></span>, respectively, to the runtime system (see Sect.&nbsp;<a href="#sec:running">3.7</a>)

<div class="p"><!----></div>
For instance, to run your program <tt>heavyrecursion</tt> with a 2 MByte stack, use the command

<pre>
heavyrecursion +RTS -k2M -RTS

</pre>
You can omit <tt>-RTS</tt> if there are no program options or arguments following.

<div class="p"><!----></div>
You can also change the default sizes when linking the program by passing the options <tt>-h</tt><span class="roman"><i>size</i></span>, <tt>-k</tt><span class="roman"><i>size</i></span>, and <tt>-t</tt><span class="roman"><i>size</i></span> to the compiler (see Sect.&nbsp;<a href="#sec:linking">3.4</a>)

<div class="p"><!----></div>
In order to see the default sizes used by a program, invoke it with <tt>+RTS -v</tt><br /><br /></li>

<li> <i>When I enter the goal <tt>foldr (+) 0 [1..50000]</tt>, the interpreter complains about a stack overflow.</i> <br />
Use the <tt>:set</tt> command for changing the default sizes for the program with the compiler options <tt>-h</tt><span class="roman"><i>size</i></span>, <tt>-k</tt><span class="roman"><i>size</i></span>, and <tt>-t</tt><span class="roman"><i>size</i></span>, respectively.

<div class="p"><!----></div>
Incidentally, <tt>foldr (+) 0 [1..32000]</tt> works in the default configuration.<br /><br /></li>

<li> <i>The interpreter complains about an undefined entity X in my goal.</i> <br />
In contrast to most other logic and functional logic languages all free variables of a goal have to be declared explicitly in the Münster Curry implementation. Thus, in order to see the solutions of the unary predicate <tt>nat</tt> enter

<pre>
nat X where X free

</pre>
or use a let expression as goal.

<pre>
let X free in nat X

</pre><br /><br /></li>

<li> <i>My program fails with <tt>ERROR: Cannot duplicate the world</tt>.</i> <br />
This happens when your program performs a non-deterministic computation in an I/O context. Make sure that all non-determinism is encapsulated in a program with type <tt>IO</tt>&nbsp;t (see also the next item). Recall that the evaluation of a function can be non-deterministic for two reasons. Either it is called with an argument that is not sufficiently instantiated or the function's definition has overlapping patterns.<a href="#tthFtNtABD" name="tthFrefABD"><sup>13</sup></a> The latter happens regularly when converting Haskell functions to Curry, since in Haskell functions are matched from top to bottom and only the first match is used, whereas in Curry all matching equations are considered. For instance, in Haskell you could define <tt>null</tt> by

<pre>
null [] = True
null _  = False

</pre>
This definition would be non-deterministic in Curry. Either replace the default pattern <tt>_</tt> by explicit cases for the remaining alternatives, i.e.,

<pre>
null []    = True
null (_:_) = False

</pre>
or use a <tt>case</tt> expression:

<pre>
null xs =
  case xs of
    [] -&#62; True
    _  -&#62; False

</pre>
Note that in the latter case, <tt>null</tt> becomes a rigid function.<br /><br /></li>

<li> <i>My program is non-deterministic even though I use <tt>findall</tt> to encapsulate non-deterministic expressions.</i> <br />
In the Münster Curry compiler's implementation of encapsulated search, only computations which are local to the search goal are encapsulated. Non-determinism which occurs in arguments passed to a search goal cannot be encapsulated. See the last item in Sect.&nbsp;<a href="#sec:limitations">8.2</a> for a longer explanation of this issue.<br /><br /></li>

<li> <i>All my programs fail immediately with a bus error or segmentation fault.</i> <br />
Reconfigure the compiler with <tt>--enable-trampoline</tt> (see Sect.&nbsp;<a href="#sec:source">2.2</a>).<br /><br /></li>
</ul>

<div class="p"><!----></div>
 <h2><a name="tth_sEc10">
10</a>&nbsp;&nbsp;Release History</h2><a name="sec:release-notes">
</a>

<h3>Release 0.9.11 (June 10, 2007)</h3>

<div class="p"><!----></div>
<b>Build Environment&nbsp;&nbsp;</b>
  
<ul>
<li> On Microsoft Windows, the compiler can now also be built with MinGW.<br /><br /></li>

<li> Versioned installation will allow multiple versions of the Münster Curry compiler to coexist on a single machine in the future.<br /><br /></li>

<li> New make target <tt>TeXShop</tt> for typesetting the documentation on Mac OS X with <tt>TeXShop.app</tt> (cf.&nbsp;Sect.&nbsp;<a href="#sec:source-documentation">2.2.2</a>).<br /><br /></li>

<li> It is now possible to build universal libraries on Mac OS X (cf.&nbsp;Sect.&nbsp;<a href="#sec:source-universal">2.2.3</a>).<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Compiler&nbsp;&nbsp;</b>
  
<ul>
<li> Function definitions are no longer <font face="symbol">h</font
>-expanded automatically (cf.&nbsp;Sect.&nbsp;<a href="#sec:ext-eta">8.1.11</a>).<br /><br /></li>

<li> Let-bound variables can have a polymorphic type in some cases (cf.&nbsp;Sect.&nbsp;<a href="#sec:poly-let">8.1.13</a>).<br /><br /></li>

<li> The precedence level in a fixity declaration is now optional and defaults to 9 if omitted (cf.&nbsp;Sect.&nbsp;<a href="#sec:ext-fixity">8.1.5</a>).<br /><br /></li>

<li> Only the exported entities of the main module and the Prelude are visible with unqualified names in a goal. On the other hand, the entities of all other modules imported directly or indirectly from the main module can now be accessed with qualified names.<br /><br /></li>

<li> Code generation is now based on a register-based abstract machine code model, which yields more efficient code.<br /><br /></li>

<li> The compiler omits redundant module qualifiers from type expressions in error messages.<br /><br /></li>

<li> Limited support for compiling mutually recursive modules.<br /><br /></li>

<li> Compiler options <tt>--ccopts</tt> and <tt>--ldopts</tt> allow passing multiple comma separated options to the C compiler (cf.&nbsp;Sects.&nbsp;<a href="#sec:compiling-c">3.3</a> and&nbsp;<a href="#sec:linking">3.4</a>).<br /><br /></li>

<li> Compiler accepts options <tt>-F</tt> and <tt>-framework</tt> and passes them on to the C compiler.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Debugger&nbsp;&nbsp;</b>
  
<ul>
<li> Debugging of goals involving <tt>IO</tt> computations now works.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Interactive Environment&nbsp;&nbsp;</b>
  
<ul>
<li> The interpreter's <tt>:load</tt> command takes changes of the search path with the <tt>:set</tt> command into account.<br /><br /></li>

<li> The interpreter allows <tt>:load</tt>ing standard library interfaces so that, e.g., <tt>:l Array</tt> no longer fails with an error message <tt>missing source file for Array</tt>.<br /><br /></li>

<li> The interpreter no longer recompiles source modules each time a goal is evaluated.<br /><br /></li>

<li> Only the exported entities of the main module and the Prelude are visible with unqualified names in a goal. On the other hand, the entities of all other modules imported directly or indirectly from the current module can now be accessed with qualified names (cf.&nbsp;Sect.&nbsp;<a href="#sec:goals">6.1</a>).<br /><br /></li>

<li> New command <tt>:interface</tt> that displays the interface of the current or a specified module.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Curry Library and Runtime System&nbsp;&nbsp;</b>
  
<ul>
<li> Improved trampoline implementation (used by default on Mac OS X), which reduces execution times by 5 to 10% on a PowerPC, and up to 30% on x86.<br /><br /></li>

<li> Expressions like <tt>chr (-1)</tt> and <tt>const 0 &lt;= id</tt> now fail only the current solution instead of aborting the program with an error message.<br /><br /></li>

<li> When a program fails due to a pattern match failure, the error message now includes the function where the failure was detected.<br /><br /></li>

<li> Pattern matching (and other) failures are reported in non-IO goals if the goal was compiled with the <tt>-f</tt> option (cf.&nbsp;Sect.&nbsp;<a href="#sec:linking">3.4</a>) or if the program is invoked with the <tt>-f</tt> runtime system option (cf.&nbsp;Sect.&nbsp;<a href="#sec:running">3.7</a>).<br /><br /></li>

<li> The runtime system now uses tagged characters (similar to tagged integers) by default. This avoids allocation for characters with codes above 255 (decimal).<br /><br /></li>

<li> Avoid many name conflicts when interfacing with foreign C code.<br /><br /></li>

<li> Many portability fixes to allow compilation on Windows with MinGW.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Foreign Function Interface&nbsp;&nbsp;</b>
  
<ul>
<li> New non-standard calling convention <tt>rawcall</tt> (cf.&nbsp;Sect.&nbsp;<a href="#sec:ext-ffi">8.1.16</a>).<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Noteworthy Bug Fixes&nbsp;&nbsp;</b>
  
<ul>
<li> The compiler no longer fails with an internal error in function <tt>constrKind</tt> when importing a module whose interface contains types T<sub>1</sub> and T<sub>2</sub> whose names differ only by their module qualifiers.<br /><br /></li>

<li> The compiler no longer fails with a non-exhaustive match when reporting case mode warnings for a program with explicit type signatures.<br /><br /></li>

<li> Setting the initial buffering mode for the standard input and output channels with the <tt>-b</tt> runtime system option (cf.&nbsp;Sect.&nbsp;<a href="#sec:running">3.7</a>) now works.<br /><br /></li>

<li> The compiler no longer infers too general types for some functions in mutually recursive binding groups involving pattern declarations.<br /><br /></li>

<li> The parser no longer rejects patterns of the form (<em>op</em>)&nbsp;t<sub>1</sub>... t<sub>n</sub> when <em>op</em> is a qualified operator, e.g., <tt>(Assoc.:=) x y</tt>.<br /><br /></li>
</ul>

<div class="p"><!----></div>

<h3>Release 0.9.10 (May 10, 2006)</h3>

<div class="p"><!----></div>
<b>Build Environment&nbsp;&nbsp;</b>
  
<ul>
<li> The compiler can be used without installing it (see Sects.&nbsp;<a href="#sec:binary">2.1</a> and&nbsp;<a href="#sec:source">2.2</a>).<br /><br /></li>

<li> Build issues with ghc 6.4 have been fixed.<br /><br /></li>

<li> Use <tt>ghc -make</tt> when it is supported.<br /><br /></li>

<li> Source distributions now include an abstract machine code to C compiler.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Compiler&nbsp;&nbsp;</b>
  
<ul>
<li> The compiler now reports all duplicate or undefined identifiers in a scope before giving up.<br /><br /></li>

<li> The compiler can optionally report warnings for case mode violations, unused identifiers, shadowing definitions, and equations with overlapping left hand side patterns (see Sect.&nbsp;<a href="#sec:compiling">3.2</a>).<br /><br /></li>

<li> Existentially quantified types finally enabled again (see Sect.&nbsp;<a href="#sec:ext-exist">8.1.3</a>).<br /><br /></li>

<li> Trust annotations introduced (see Sect.&nbsp;<a href="#sec:trusted">4.1</a>).<br /><br /></li>

<li> Evaluation annotations removed.<br /><br /></li>

<li> The compiler generates better code for case expressions in some cases.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Interactive Environment&nbsp;&nbsp;</b>
  
<ul>
<li> On systems where GNU Bash or a Korn shell (but not the public domain version) are installed, the interpreter now supports command line editing. In addition, a history of previously entered goals and commands is maintained in file <tt>~/.cyi_history</tt>.<br /><br /></li>

<li> Initialization file <tt>.cyirc</tt> or <tt>~/.cyirc</tt> is read at startup.<br /><br /></li>

<li> The <tt>:cd</tt> command now works for directories whose name contains embedded blanks.<br /><br /></li>

<li> The value <tt>Success</tt> is shown in the answer to a constraint expression only when there are no constraints.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Curry Library and Runtime System&nbsp;&nbsp;</b>
  
<ul>
<li> Module <tt>prelude</tt> renamed into <tt>Prelude</tt>.<br /><br /></li>

<li> Additional prelude type: <tt>ShowS</tt> (see Sect.&nbsp;<a href="#sec:lib-Prelude">7.1</a>).<br /><br /></li>

<li> New prelude functions: <tt>shows</tt>, <tt>showChar</tt>, <tt>showString</tt>, <tt>showList</tt>, <tt>showParen</tt>, <tt>($!!)</tt>, <tt>($#)</tt>, <tt>($##)</tt>, <tt>unknown</tt>, and <tt>ensureGround</tt> (see Sect.&nbsp;<a href="#sec:lib-Prelude">7.1</a>).<br /><br /></li>

<li> New functions <tt>Char.minChar</tt>, <tt>Char.maxChar</tt>, <tt>Integer.minInt</tt>, and <tt>Integer.maxInt</tt> that report the smallest and largest elements of types <tt>Char</tt> and <tt>Int</tt>, respectively.<br /><br /></li>

<li> Implementation of <tt>AllSolutions.getSearchTree</tt> (see Sect.&nbsp;<a href="#sec:lib-AllSolutions">7.4.1</a>) changed to use strong encapsulation for logical variables, too. In addition, the search tree now properly reflects the state of the goal at the time when the <tt>getSearchTree</tt> action is evaluated rather than fixing the state when the first solution is computed.<br /><br /></li>

<li> New function <tt>IOExts.openFd</tt> (see Sect.&nbsp;<a href="#sec:lib-IOExts">7.5.2</a>).<br /><br /></li>

<li> New library modules <tt>Lexing</tt> (see Sect.&nbsp;<a href="#sec:lib-Lexing">7.5.4</a>), <tt>NameSupply</tt> (see Sect.&nbsp;<a href="#sec:lib-NameSupply">7.5.5</a>), and <tt>Socket</tt> (see Sect.&nbsp;<a href="#sec:lib-Socket">7.4.8</a>).<br /><br /></li>

<li> An alternative implementation of encapsulated search is available, which can be enabled with <tt>-enable-copying</tt> during configuration (see Sect.&nbsp;<a href="#sec:source">2.2</a>).<br /><br /></li>

<li> The full Unicode character set range is now supported.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Noteworthy Bug Fixes&nbsp;&nbsp;</b>
  
<ul>
<li> A long standing issue where builds would fail when using the vendor supplied make command on Solaris systems has been fixed.<br /><br /></li>

<li> Gnu C specific features are now enabled only when using the Gnu C compiler.<br /><br /></li>

<li> The import and export specifications <tt>T()</tt> and <tt>T(..)</tt> are now also accepted when T is a type synonym.<br /><br /></li>

<li> A potential stack overflow problem for functions returning a variable has been eliminated.<br /><br /></li>

<li> A problem where programs using encapsulated search could crash in certain situations has been fixed.<br /><br /></li>

<li> A problem where a program could fail when <tt>show</tt> was applied to an infix constructor application other than the list constructor <tt>(:)</tt> has been fixed.<br /><br /></li>

<li> A space leak has been closed where file handles opened with one of the functions <tt>IOExts.openProcess</tt> and <tt>IOExts.openTcpSocket</tt> were not closed automatically. Note that these functions are used by the <tt>Ports</tt> module, too.<br /><br /></li>

<li> The functions <tt>Integer.ilog</tt>, <tt>Integer.isqrt</tt>, and <tt>Integer.pow</tt> now fail for negative arguments.<br /><br /></li>

<li> The string <tt>['x','y','\200','2','3']</tt> is now printed <tt>"xy\200\&amp;23"</tt>.<br /><br /></li>
</ul>

<div class="p"><!----></div>

<h3>Release 0.9.9 (May 14, 2005)</h3>

<div class="p"><!----></div>
<b>Build Environment&nbsp;&nbsp;</b>
  
<ul>
<li> The runtime system protects the inactive semi-space of the heap with <tt>mprotect</tt>(2) on systems which support it. This can be turned off with the new configuration option <tt>--disable-mprotect</tt> (see Sect.&nbsp;<a href="#sec:source">2.2</a>).<br /><br /></li>

<li> The source distribution's Makefile includes rules to build the internal documentation (see Sect.&nbsp;<a href="#sec:source-documentation">2.2.2</a>).<br /><br /></li>

<li> On Mac OS X, <tt>-mdynamic-no-pic</tt> is used unless the compiler does not accept this option.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Compiler&nbsp;&nbsp;</b>
  
<ul>
<li> <tt>cymake</tt> passes archive files (<tt>*.a</tt>, <tt>*.so</tt>, <tt>*.dylib</tt>, <tt>*.dll</tt>) to the linker instead of complaining about a missing source file.<br /><br /></li>

<li> The <tt>:set</tt> and <tt>:unset</tt> commands in the interpreter accumulate and remove individual options.<br /><br /></li>

<li> The <tt>:debug</tt> and <tt>:type</tt> commands of the interpreter as well as the new command <tt>:^</tt> use the previous goal if the goal was omitted on the command line.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Debugger&nbsp;&nbsp;</b>
  
<ul>
<li> The debugger is no longer restricted to the first solution of a goal.<br /><br /></li>

<li> User interface improved.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Curry Library and Runtime System&nbsp;&nbsp;</b>
  
<ul>
<li> The compiler and runtime system should now work on 64-bit architectures using the LP64 programming model, most notably the AMD x86-64. Many thanks to Adam Peacock for his help in tracking down the problems on this architecture.<br /><br /></li>

<li> Functions <tt>rigid</tt> and <tt>rigidSpine</tt> introduced in release 0.9.8 have been renamed into <tt>ensureNotFree</tt> and <tt>ensureSpine</tt>, respectively, following a consensus on the Curry mailing list about the names of these functions.<br /><br /></li>

<li> The range of <tt>Int</tt> numbers is now always equal to that of C <tt>long</tt> values on the target system.<br /><br /></li>

<li> The functions <tt>div</tt> and <tt>mod</tt> now use the semantics mandated by the Haskell report, i.e. the quotient is rounded toward negative infinity. Use the new functions <tt>quot</tt> and <tt>rem</tt> when the quotient shall be truncated toward zero.<br /><br /></li>

<li> Floating-point numbers are now printed with maximum precision.<br /><br /></li>

<li> Function <tt>readFloat</tt> for converting strings into floating-point numbers implemented (see Sects.&nbsp;<a href="#sec:lib-Numeric">7.2.3</a> and <a href="#sec:lib-Read">7.4.7</a>).<br /><br /></li>

<li> A more efficient representation is used for lazy applications.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Foreign Function Interface&nbsp;&nbsp;</b>
  
<ul>
<li> Foreign function declarations using the <tt>ccall</tt> calling convention have been extended to support the import of static addresses and dynamic function wrappers. In addition, the basic marshalable types now include pointers (see Sect.&nbsp;<a href="#sec:ext-ffi">8.1.16</a>).<br /><br /></li>

<li> Most libraries from the Haskell 98 Foreign Function Interface addendum have been implemented as far as they do not require type classes (see Sect.&nbsp;<a href="#sec:lib-ffi">7.3</a>).<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Documentation&nbsp;&nbsp;</b>
  
<ul>
<li> Sections about porting to a new architecture (Sect.&nbsp;<a href="#sec:source-porting">2.2.1</a>) and building the internal documentation (Sect.&nbsp;<a href="#sec:source-documentation">2.2.2</a>) added.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Noteworthy Bug Fixes&nbsp;&nbsp;</b>
  
<ul>
<li> It is now possible to use Gnu C version 3.4 and optimization level <tt>-O3</tt> with the default configuration.<br /><br /></li>

<li> In some rare cases the compiler would print too general types for an expression.<br /><br /></li>

<li> In a misguided attempt to avoid duplicate solutions, the <tt>(=/=)</tt> operator was using equality constraints for some arguments. This is no longer the case as it is a source of incompleteness. The new implementation correctly reports the solution <tt>y/=0</tt> for the goal <tt>let x,y free in (x,y) =/= (undefined,0)</tt>, which was lost before.<br /><br /></li>

<li> File handles opened with one of the functions <tt>IO.openFile</tt>, <tt>IOExts.openProcess</tt>, and <tt>IOExts.connectTcpSocket</tt> are no longer closed automatically at end of file or when an error occurs.<br /><br /></li>

<li> It is no longer possible to write to a handle opened in <tt>ReadWriteMode</tt> after <tt>IO.hGetContents</tt> has been applied to it.<br /><br /></li>

<li> Rounding errors for large floating-point numbers in source text are now avoided.<br /><br /></li>

<li> Better algorithm used for <tt>(Float.^)</tt>.<br /><br /></li>

<li> A bug was introduced in release 0.9.7 that caused partial applications of tuple constructors to be printed incorrectly. This has been fixed.<br /><br /></li>
</ul>

<div class="p"><!----></div>

<h3>Release 0.9.8 (Nov 8, 2004)</h3>

<div class="p"><!----></div>
<b>Build Environment&nbsp;&nbsp;</b>
  
<ul>
<li> The compiler can now be built on Microsoft Windows with CygWin without special configuration options.<a href="#tthFtNtABE" name="tthFrefABE"><sup>14</sup></a><br /><br /></li>

<li> It is now possible to use g++ as backend C compiler.<br /><br /></li>

<li> Configure scripts upgraded to autoconf  <font face="symbol">³</font
>  2.50.<br /><br /></li>

<li> Unix man pages for <tt>cyc</tt>, <tt>cymake</tt>, and <tt>cyi</tt>.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Compiler&nbsp;&nbsp;</b>
  
<ul>
<li> Let expressions with free variable declarations are no longer restricted to type <tt>Success</tt>.<br /><br /></li>

<li> All functions use flexible evaluation by default.<br /><br /></li>

<li> <tt>choice</tt> and <tt>rigid</tt> are no longer keywords.<br /><br /></li>

<li> Syntax of external declarations now uses <tt>foreign import</tt> instead of <tt>external</tt>.<br /><br /></li>

<li> Partial support for <tt>ccall</tt> calling convention in foreign function declarations (see Sect.&nbsp;<a href="#sec:ext-ffi">8.1.16</a>).<br /><br /></li>

<li> Faster code for lazy applications of nullary and unary functions.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Curry Library and Runtime System&nbsp;&nbsp;</b>
  
<ul>
<li> The copying garbage collector now uses a segment order preserving algorithm. The compacting collector has been removed as the new copying collector is both faster and more accurate than it. The command line arguments <tt>-gc-2space</tt> and <tt>-gc-compact</tt> are deprecated and will be removed in the next release.<br /><br /></li>

<li> Type of <tt>(&amp;&gt;)</tt> generalized to <tt>Success -&gt; a -&gt; a</tt>.<br /><br /></li>

<li> Non-deterministic choice operator <tt>(?)</tt> added to the prelude (see Sect.&nbsp;<a href="#sec:lib-Prelude">7.1</a>).<br /><br /></li>

<li> <tt>seq</tt> and <tt>($!)</tt> are no longer rigid, new functions <tt>rigid</tt> and <tt>rigidSpine</tt> added to the prelude (see Sect.&nbsp;<a href="#sec:lib-Prelude">7.1</a>).<br /><br /></li>

<li> Equality constraints x<tt>=:=</tt>e, where x is an unbound variable and e is in normal form are evaluated more efficiently.<br /><br /></li>

<li> Equality and disequality constraints between two partial applications are now restricted to ground terms (see Sect.&nbsp;<a href="#sec:ext-partial">8.1.4</a> for a rationale).<br /><br /></li>

<li> <tt>(==)</tt> and <tt>(!=)</tt> can now be used for comparing partial applications and terms with abstract types (e.g. file handles) for (in)equality.<br /><br /></li>

<li> <tt>compare</tt> and the operators <tt>(&lt;)</tt>, <tt>(&gt;)</tt>, <tt>(&lt;=)</tt>, <tt>(&gt;=)</tt> raise a runtime error when applied to partial applications and terms with abstract types.<br /><br /></li>

<li> <tt>undefined</tt> is equivalent to <tt>failed</tt> again.<br /><br /></li>

<li> Fix minor incompatibilities with the Haskell report in the <tt>Numeric</tt> module. In particular, <tt>readSigned</tt> now recognizes parenthesized numbers, and <tt>readDec</tt>, <tt>readOct</tt>, and <tt>readHex</tt> no longer accept leading blanks.<br /><br /></li>

<li> <tt>trace</tt> function now writes its message to the standard error channel and appends a newline to the message.<br /><br /></li>

<li> New modules compatible with PAKCS: <tt>AllSolutions</tt> (Sect.&nbsp;<a href="#sec:lib-AllSolutions">7.4.1</a>), <tt>Combinatorial</tt> (Sect.&nbsp;<a href="#sec:lib-Combinatorial">7.4.2</a>), <tt>Float</tt> (Sect.&nbsp;<a href="#sec:lib-Float">7.4.3</a>), <tt>Integer</tt> (Sect.&nbsp;<a href="#sec:lib-Integer">7.4.4</a>), <tt>Parser</tt> (Sect.&nbsp;<a href="#sec:lib-Parser">7.4.5</a>), and <tt>Ports</tt> (only internal and stream ports; see Sect.&nbsp;<a href="#sec:lib-Ports">7.4.6</a>).<br /><br /></li>

<li> The <tt>Read</tt> module (Sect.&nbsp;<a href="#sec:lib-Read">7.4.7</a>) has been replaced by a (mostly) PAKCS compatible one.<br /><br /></li>

<li> <tt>Unsafe</tt> module (Sect.&nbsp;<a href="#sec:lib-Unsafe">7.4.9</a>) is now compatible with PAKCS.<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Documentation&nbsp;&nbsp;</b>
  
<ul>
<li> Section about limitations of encapsulated search added to the user's guide (Sect.&nbsp;<a href="#sec:limitations">8.2</a>).<br /><br /></li>
</ul>

<div class="p"><!----></div>
<b>Noteworthy Bug Fixes&nbsp;&nbsp;</b>
  
<ul>
<li> The C compiler backend no longer reports an error for out of range floating-point numbers. In addition, infinite values and NaNs are now shown as <tt>Infinite</tt>, <tt>-Infinite</tt>, and <tt>NaN</tt>, respectively.<br /><br /></li>

<li> <tt>show</tt> no longer encloses the names of abstract data types (e.g., files) in parentheses.<br /><br /></li>

<li> Correct implementation of equality and disequality constraints between partial applications of tuple constructors computed in different modules.<br /><br /></li>

<li> A few rare bugs with nested encapsulated searches have been fixed.<br /><br /></li>

<li> Two problems with the debugger have been fixed, where computation trees related to local bindings could be lost in the presence of guards or case expressions, and programs using if-then-else or case expressions in arguments could crash.<br /><br /></li>
</ul>

<div class="p"><!----></div>

<h3>Release 0.9.7 (May 4, 2004)</h3>

<ul>
<li> Support for building and using the compiler on Microsoft Windows using the CygWin environment (cf. Sect.&nbsp;<a href="#sec:ins-windows">2.3</a>).<a href="#tthFtNtABF" name="tthFrefABF"><sup>15</sup></a><br /><br /></li>

<li> <tt>cyc</tt>'s option <tt>-y</tt> renamed into <tt>-T</tt>. cymake now supports <tt>-T</tt>, too.<br /><br /></li>

<li> Integer literals can now be used as floating-point numbers (cf. Sect.&nbsp;<a href="#sec:ext-polyliterals">8.1.1</a>).<br /><br /></li>

<li> The unary negation operator <tt>-</tt> works for integer and floating-point numbers. Use of <tt>-.</tt> for negating floating-point numbers is deprecated.<br /><br /></li>

<li> The compiler no longer allows mixing import and other declarations. This change is in conformance with the Curry report and makes <tt>cymake</tt>'s dependency analysis more fault tolerant.<br /><br /></li>

<li> It is now possible to define and use (infix) constructor operators (cf. Sect.&nbsp;<a href="#sec:ext-infix">8.1.10</a>).<br /><br /></li>

<li> Operator fixities must be declared in the same declaration group as the operator. To this end, fixity declarations are allowed in local declaration groups (cf. Sect.&nbsp;<a href="#sec:ext-fixity">8.1.5</a>). Fixity declarations can still be mixed freely with other declarations.<br /><br /></li>

<li> Curried syntax is supported on the left-hand side of declarations (cf. Sect.&nbsp;<a href="#sec:ext-curried-lhs">8.1.12</a>).<br /><br /></li>

<li> Support constraint guards in case expressions. Actually, they have been supported since the introduction of guarded case alternatives in release 0.9.6, but the documentation did say otherwise.<br /><br /></li>

<li> <tt>Array</tt> module (Sect.&nbsp;<a href="#sec:lib-Array">7.2.5</a>) reimplemented. This fixes, in particular, the broken <tt>accum</tt> and <tt>accumArray</tt> functions.<br /><br /></li>

<li> Finite maps (Sect.&nbsp;<a href="#sec:lib-FiniteMap">7.5.1</a>) and sets (Sect.&nbsp;<a href="#sec:lib-Set">7.5.6</a>) added to the library.<br /><br /></li>

<li> Add module <tt>IOExts</tt> which implements a subset of the Hugs/ghc module with the same name. At present, this includes the monadic fixpoint function <tt>fixIO</tt>, mutable references, and mutable arrays (cf. Sect.&nbsp;<a href="#sec:lib-IOExts">7.5.2</a>).<br /><br /></li>

<li> <tt>Random</tt> module added (cf. Sect.&nbsp;<a href="#sec:lib-Random">7.2.16</a>).<br /><br /></li>

<li> Add new primitive function <tt>ground</tt> to module <tt>Success</tt> (cf. Sect.&nbsp;<a href="#sec:lib-Success">7.5.7</a>).<br /><br /></li>

<li> The generated code has become slightly faster, again.<br /><br /></li>

<li> Bug fixes.<br /><br /></li>
</ul>

<div class="p"><!----></div>

<h3>Release 0.9.6 (Nov 5, 2003)</h3>

<ul>
<li> <b>The compiler has been renamed</b>. The compiler proper must now be invoked with the name <tt>cyc</tt> (instead of <tt>cycc</tt>).<br /><br /></li>

<li> Hierachical modules mapped onto the filesystem, i.e., module <tt>SubProj.Lib.Mod</tt> is now expected in one of the files <tt>Mod.curry</tt> and <tt>Mod.lcurry</tt> in the subdirectory <tt>SubProj/Lib</tt> of the current directory or of one of the directories in the import search path. (cf. Sect.&nbsp;<a href="#sec:hierarchical">5.3</a>)<br /><br /></li>

<li> Interface files are no longer created in the current directory but in the same directory as the source file.<br /><br /></li>

<li> The compiler now uses the source file name for computing the name of the interface file instead of the module name. This should make a difference only for the main file of a program.<br /><br /></li>

<li> The module system finally conforms to the Haskell 98 module system. In particular, it is now possible to define an entity with the same name as an imported entity. However, such entities can be accessed only with their qualified name.<br /><br /></li>

<li> <tt>cyc</tt>'s <tt>-m</tt> option renamed into <tt>-M</tt> because it conflicts with a Gnu C option.<br /><br /></li>

<li> <tt>cymake</tt> can now search for imported modules in other directories.<br /><br /></li>

<li> Make output of the debugger a little bit more readable when higher-order functions are used.<br /><br /></li>

<li> <tt>as</tt>, <tt>hiding</tt>, and <tt>qualified</tt> can be used as identifiers in programs. They are given special treatment only in import declarations.<br /><br /></li>

<li> Syntax extensions:
  
<ul>
<li> newtype declarations (Sect.&nbsp;<a href="#sec:ext-newtype">8.1.7</a>),<br /><br /></li>

<li> @-patterns,<br /><br /></li>

<li> lazy patterns (Sect.&nbsp;<a href="#sec:ext-lazy-pattern">8.1.6</a>),<br /><br /></li>

<li> guarded right hand sides for pattern declarations and case alternatives (Sect.&nbsp;<a href="#sec:ext-case">8.1.9</a>), and<br /><br /></li>

<li> expression type signatures (Sect.&nbsp;<a href="#sec:ext-type-sigs">8.1.8</a>).<br /><br /></li>
</ul><br /><br /></li>

<li> Prelude changes
  
<ul>
<li> Make <tt>if_then_else</tt> rigid.<br /><br /></li>

<li> Fix handling of negative arguments in <tt>take</tt>, <tt>drop</tt>, and <tt>splitAt</tt>.<br /><br /></li>
</ul><br /><br /></li>

<li> Additional modules from the Haskell library (partially) implemented:
  
<ul>
<li> <tt>Directory</tt> (Sect.&nbsp;<a href="#sec:lib-Directory">7.2.11</a>),<br /><br /></li>

<li> <tt>IO</tt> (Sect.&nbsp;<a href="#sec:lib-IO">7.2.10</a>),<br /><br /></li>

<li> <tt>Numeric</tt> (Sect.&nbsp;<a href="#sec:lib-Numeric">7.2.3</a>), and<br /><br /></li>

<li> <tt>Time</tt> (Sect.&nbsp;<a href="#sec:lib-Time">7.2.13</a>).<br /><br /></li>
</ul><br /><br /></li>

<li> The notorious space leak for lazy pattern bindings has been fixed.<br /><br /></li>

<li> Performance of the compiler improved, in particular for large files and files with many constants.<br /><br /></li>

<li> Bug fixes and minor performance enhancements in the compiled code.<br /><br /></li>
</ul>

<div class="p"><!----></div>

<h3>Release 0.9.5 (May 1, 2003)</h3>

<ul>
<li> Changed to match version 0.8 of the Curry report.<br /><br /></li>

<li> Faster implementation.<br /><br /></li>

<li> Characters and strings are no longer displayed using integer numbers.<br /><br /></li>

<li> Occurs check in unification.<br /><br /></li>

<li> Restrictions on (partially) solved goals returned from <tt>try</tt> have been removed.<br /><br /></li>

<li> Handle partial applications as data constructors in equality and disequality constraints (Sect.&nbsp;<a href="#sec:ext-partial">8.1.4</a>).<br /><br /></li>

<li> IO Exceptions implemented. Use <tt>ioError</tt> for throwing I/O exceptions, and <tt>catch</tt> for catching I/O exceptions (cf. Sect.&nbsp;<a href="#sec:lib-Prelude">7.1</a>).<br /><br /></li>

<li> Existentially quantified data types disabled because the current implementation was unsound regarding equality constraints. They will be included in a future release after fixing the problem.<br /><br /></li>

<li> New option <tt>--clean</tt> to <tt>cymake</tt>. This removes all compiled files for the target modules and its imported modules.<br /><br /></li>

<li> New commands <tt>:freshen</tt> and <tt>:clean</tt> in interactive environment.<br /><br /></li>

<li> The function <tt>undefined</tt> now aborts the running program with an error message. Use <tt>failed</tt> for failing only the current solution.<br /><br /></li>

<li> More functions from the Haskell prelude: <tt>getContents</tt>, <tt>interact</tt> (cf. Sect.&nbsp;<a href="#sec:lib-Prelude">7.1</a>).<br /><br /></li>

<li> It is now possible to change the buffer mode used for standard input and output with a runtime system option (Sect.&nbsp;<a href="#sec:running">3.7</a>).<br /><br /></li>

<li> Module <tt>Monad</tt> from the Haskell library is now included. This module also implements the functions <tt>sequence</tt>, <tt>sequence_</tt>, <tt>mapM</tt>, and <tt>mapM_</tt> from the Haskell prelude (Sect.&nbsp;<a href="#sec:lib-Monad">7.2.9</a>).<br /><br /></li>

<li> New syntax for external declarations which is closer to the proposed FFI for Haskell (Sect&nbsp;<a href="#sec:ext-ffi">8.1.16</a>).<br /><br /></li>

<li> Bug fixes...<br /><br /></li>
</ul>

<div class="p"><!----></div>

<h3>Release 0.9.1 (Nov 12, 2002)</h3>
This is mostly a bug-fix release.

<ul>
<li> <tt>cyi</tt> and <tt>cymake</tt> now work on Solaris 2.7 and other OS'es with <tt>test</tt> commands that do not support the <tt>-nt</tt> operator.<br /><br /></li>

<li> Runtime option for changing the stack size renamed into <tt>-k</tt>.<br /><br /></li>

<li> Defaults for all runtime options can now be passed to the compiler during linking. Thus, all runtime options are now available under the interactive environment.<br /><br /></li>
</ul>

<div class="p"><!----></div>

<h3>Release 0.9 (Nov 4, 2002)</h3>

<ul>
<li> Interactive environment <tt>cyi</tt>.<br /><br /></li>

<li> Make-like build tool <tt>cymake</tt>.<br /><br /></li>

<li> Declarative Debugger.<br /><br /></li>

<li> More library modules.<br /><br /></li>

<li> Programs can evaluate arbitrary goals, no additional flags needed for distinguishing IO and non-IO goals.<br /><br /></li>

<li> Lots of bug fixes.<br /><br /></li>
</ul>

<div class="p"><!----></div>

<h2>References</h2>

<dl compact="compact">
 <dt><a href="#CITEAugustssonRittriSynek94:Unique" name="AugustssonRittriSynek94:Unique">[ARS94]</a></dt><dd>
L.&nbsp;Augustsson, M.&nbsp;Rittri, D.&nbsp;Synek.
<i>On generating unique names</i>.
Journal of Functional Programming 4(1), 1994. pp.&nbsp;117-123.

<div class="p"><!----></div>
</dd>
 <dt><a href="#CITEBrasselHanusHuch04:Encapsulating" name="BrasselHanusHuch04:Encapsulating">[BBH04]</a></dt><dd>
B.&nbsp;Braßel, M.&nbsp;Hanus, F.&nbsp;Huch.
<i>Encapsulating Non-Determinism in Functional Logic Computations</i>.
Proc.&nbsp;WFLP '04, pp.&nbsp;74-90.
Aachener Informatik Berichte AIB-2004-05.

<div class="p"><!----></div>
</dd>
 <dt><a href="#CITEChakravarty99:Lexing" name="Chakravarty99:Lexing">[Cha99]</a></dt><dd>
M.&nbsp;Chakravarty.
<i>Lazy Lexing is Fast</i>.
Proc.&nbsp;FLOPS&nbsp;'99, pp.&nbsp;68-84. Springer LNCS 1772.

<div class="p"><!----></div>
</dd>
 <dt><a href="#CITEChakravarty03:FFI" name="Chakravarty03:FFI">[Cha03]</a></dt><dd>
M.&nbsp;Chakravarty (ed.).
<i>The Haskell 98 Foreign Function Interface 1.0</i>. <br />
Available at:
<a href="http://www.cse.unsw.edu.au/~chak/haskell/ffi/"><tt>http://www.cse.unsw.edu.au/~chak/haskell/ffi/</tt></a>

<div class="p"><!----></div>
</dd>
 <dt><a href="#CITECL99:Parsing" name="CL99:Parsing">[CL99]</a></dt><dd>
R.&nbsp;Caballero, F.J.&nbsp;López-Fraguas.
<i>A Functional-Logic Perspective on Parsing</i>.
Proc.&nbsp;FLOPS&nbsp;'99, pp.&nbsp;85-99. Springer LNCS 1772.

<div class="p"><!----></div>
</dd>
 <dt><a href="#CITECL02:ENTCS76" name="CL02:ENTCS76">[CL02]</a></dt><dd>
R.&nbsp;Caballero, W.&nbsp;Lux.
<i>Declarative Debugging for Encapsulated Search</i>.
WFLP'02 - Selected Papers.
Electronic Notes in Theoretical Computer Science, Vol. 76. <br />
<a href="http://www.elsevier.com/locate/entcs/volume76.html"><tt>http://www.elsevier.com/locate/entcs/volume76.html</tt></a>

<div class="p"><!----></div>
</dd>
 <dt><a href="#CITEEL00:Recursive" name="EL00:Recursive">[EL00]</a></dt><dd>
L.&nbsp;Erkök, J.&nbsp;Launchbury.
<i>Recursive Monadic Bindings</i>.
Proc.&nbsp;ICFP&nbsp;'00, pp.&nbsp;174-185. ACM Press.
Also available at: <br /><a href="http://www.cse.ogi.edu/pacsoft/projects/rmb"><tt>http://www.cse.ogi.edu/pacsoft/projects/rmb</tt></a>

<div class="p"><!----></div>
</dd>
 <dt><a href="#CITEHanus99:Ports" name="Hanus99:Ports">[Han99]</a></dt><dd>
M.&nbsp;Hanus.
<i>Distributed Programming in a Multi-Paradigm Declarative Language</i>.
Proc.&nbsp;PPDP&nbsp;'99, pp.&nbsp;188-205. Springer LNCS 1702.
Also available at: <br /><a href="http://www.informatik.uni-kiel.de/~mh/publications/papers/"><tt>http://www.informatik.uni-kiel.de/~mh/publications/papers/</tt></a>

<div class="p"><!----></div>
</dd>
 <dt><a href="#CITEHanus06:Report" name="Hanus06:Report">[Han06]</a></dt><dd>
M.&nbsp;Hanus (ed.).
<i>Curry: An Integrated Functional Logic Language. (Version 0.8.2)</i>.
Available at: <br />
<a href="http://www.informatik.uni-kiel.de/~mh/curry/report.html"><tt>http://www.informatik.uni-kiel.de/~mh/curry/report.html</tt></a>

<div class="p"><!----></div>
</dd>
 <dt><a href="#CITELO94:TOPLAS" name="LO94:TOPLAS">[LO94]</a></dt><dd>
K.&nbsp;L&#228;ufer, M.&nbsp;Odersky.
<i>Polymorphic Type Inference and Abstract Data Types</i>.
ACM TOPLAS 16(5), 1994. pp&nbsp;1411-1430.

<div class="p"><!----></div>
</dd>
 <dt><a href="#CITELux04:Compare" name="Lux04:Compare">[Lux04]</a></dt><dd>
Wolfgang Lux.
<i>Comparing Copying and Trailing Implementations for Encapsulated Search</i>
Proc.&nbsp;WFLP&nbsp;'04. Aachener Informatik Berichte AIB-2004-05. pp.&nbsp;91-103.
Also available at: <br />
<a href="http://danae.uni-muenster.de/~lux/pubs/wflp04.html"><tt>http://danae.uni-muenster.de/~lux/pubs/wflp04.html</tt></a>

<div class="p"><!----></div>
</dd>
 <dt><a href="#CITEPeytonJones03:Haskell98" name="PeytonJones03:Haskell98">[Pey03]</a></dt><dd>
S.&nbsp;Peyton Jones (ed.).
<i>Haskell 98 Language and Libraries. The Revised Report.</i>
Cambridge University Press. April 2003. <br />
Also available at: <a href="http://haskell.org/definition/"><tt>http://haskell.org/definition/</tt></a></dd>
</dl>

<div class="p"><!----></div>
<hr /><h3>Footnotes:</h3>

<div class="p"><!----></div>
<a name="tthFtNtAAB"></a><a href="#tthFrefAAB"><sup>1</sup></a>Type classes and the record syntax may be supported in future releases.
<div class="p"><!----></div>
<a name="tthFtNtAAC"></a><a href="#tthFrefAAC"><sup>2</sup></a>The scripts <tt>cyc</tt>, <tt>cymake</tt>, and <tt>cyi</tt> are in fact soft links to <tt>cyc-0.9.11</tt>, <tt>cymake-0.9.11</tt>, and <tt>cyi-0.9.11</tt>, respectively, allowing multiple versions of the Münster Curry compiler to coexist on a single machine.
<div class="p"><!----></div>
<a name="tthFtNtAAD"></a><a href="#tthFrefAAD"><sup>3</sup></a>The scripts <tt>cyc</tt>, <tt>cymake</tt>, and <tt>cyi</tt> are in fact soft links to <tt>cyc-0.9.11</tt>, <tt>cymake-0.9.11</tt>, and <tt>cyi-0.9.11</tt>, respectively, allowing multiple versions of the Münster Curry compiler to coexist on a single machine.
<div class="p"><!----></div>
<a name="tthFtNtAAE"></a><a href="#tthFrefAAE"><sup>4</sup></a>In fact, this option is already the default on Mac OS X systems.
<div class="p"><!----></div>
<a name="tthFtNtAAF"></a><a href="#tthFrefAAF"><sup>5</sup></a><a href="http://www.eecs.harvard.edu/~nr/noweb/"><tt>http://www.eecs.harvard.edu/~nr/noweb/</tt></a>
<div class="p"><!----></div>
<a name="tthFtNtAAG"></a><a href="#tthFrefAAG"><sup>6</sup></a><a href="http://darkwing.uoregon.edu/~koch/texshop/texshop.html"><tt>http://darkwing.uoregon.edu/~koch/texshop/texshop.html</tt></a>
<div class="p"><!----></div>
<a name="tthFtNtAAH"></a><a href="#tthFrefAAH"><sup>7</sup></a>This is deliberately modeled after Haskell's pragma notation.
<div class="p"><!----></div>
<a name="tthFtNtAAI"></a><a href="#tthFrefAAI"><sup>8</sup></a><a href="http://toy.sourceforge.net"><tt>http://toy.sourceforge.net</tt></a>
<div class="p"><!----></div>
<a name="tthFtNtAAJ"></a><a href="#tthFrefAAJ"><sup>9</sup></a>Thanks to Rafael Caballero for making me aware of this issue.
<div class="p"><!----></div>
<a name="tthFtNtABA"></a><a href="#tthFrefABA"><sup>10</sup></a>The <tt>forall</tt> syntax can also be used for infix data constructors, see Sect.&nbsp;<a href="#sec:ext-infix">8.1.10</a> below.
<div class="p"><!----></div>
<a name="tthFtNtABB"></a><a href="#tthFrefABB"><sup>11</sup></a>The identifiers <span class="roman"><tt>primitive</tt></span>, <span class="roman"><tt>ccall</tt></span>, <span class="roman"><tt>rawcall</tt></span>, <span class="roman"><tt>safe</tt></span>, and <span class="roman"><tt>unsafe</tt></span> are not keywords, but given a special meaning only in foreign function declarations. For instance, the declaration <span class="roman"><tt>foreign import primitive ccall :: IO ()</tt></span> is accepted by the compiler.
<div class="p"><!----></div>
<a name="tthFtNtABC"></a><a href="#tthFrefABC"><sup>12</sup></a>Incidentally, Haskell has the same problem with enumerations for data types, e.g., <tt>[False..True]</tt>
<div class="p"><!----></div>
<a name="tthFtNtABD"></a><a href="#tthFrefABD"><sup>13</sup></a>The compiler emits a warning for such functions when it is invoked with options <tt>-Woverlap</tt> or <tt>-Wall</tt> (see Sect.&nbsp;<a href="#sec:compiling">3.2</a>).
<div class="p"><!----></div>
<a name="tthFtNtABE"></a><a href="#tthFrefABE"><sup>14</sup></a>Thanks again to Diego Berrueta.
<div class="p"><!----></div>
<a name="tthFtNtABF"></a><a href="#tthFrefABF"><sup>15</sup></a>The necessary changes were kindly contributed by Diego Berrueta.
<br /><br /><hr /><small>File translated from
T<sub><font size="-1">E</font></sub>X
by <a href="http://hutchinson.belmont.ma.us/tth/">
T<sub><font size="-1">T</font></sub>H</a>,
version 3.38.<br />On 10 Jun 2007, 19:35.</small>
</html>
